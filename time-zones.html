<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta charset="UTF-8">
<meta name="generator" content="quarto-1.8.27">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>12&nbsp; 시간대: sf를 사용한 공간 데이터 및 매핑 – The Art of Data Visualization with ggplot2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./us-elections.html" rel="next">
<link href="./doctors.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-795e9e8eca1e12b12abcb09a27409631.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8fdef79e5307f93f1ac50f4e683e47eb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1SWN5BH1PZ"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-1SWN5BH1PZ', { 'anonymize_ip': true});
</script>
<meta property="og:title" content="12&nbsp; 시간대: sf를 사용한 공간 데이터 및 매핑 – The Art of Data Visualization with ggplot2">
<meta property="og:description" content="">
<meta property="og:image" content="https://nrennie.rbind.io/art-of-viz/time-zones_files/figure-html/fig-timezones-barplot-na-1.png">
<meta property="og:site_name" content="The Art of Data Visualization with ggplot2">
<meta property="og:image:alt" content="`comments` 열의 결측값 수에 대한 막대 차트(`TRUE`는 결측을 나타냄).">
<meta property="og:image:height" content="1050">
<meta property="og:image:width" content="1500">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./spatial.html">공간 데이터 시각화</a></li><li class="breadcrumb-item"><a href="./time-zones.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">시간대: <strong><code>sf</code></strong>를 사용한 공간 데이터 및 매핑</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The Art of Data Visualization with ggplot2</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서문</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./author.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">저자</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">소개</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./common-charts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">일반적인 차트도 지루할 필요는 없습니다!</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programming-languages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">프로그래밍 언어: <strong><code>ggplot2</code></strong>를 이용한 덤벨 차트</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./museums.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">영국 박물관: <strong><code>gghighlight</code></strong>로 선형 차트 강조하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bee-colonies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">꿀벌 군집 손실:푸아송 디스크 샘플링으로 수량 시각화</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./animal-intakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">동물 보호소 입소: <strong><code>ggforce</code></strong>를 사용한 게이지 차트 만들기</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">아이콘, 글꼴 및 텍스트 활용</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wind-turbines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">캐나다 풍력 터빈: 와플 차트와 픽토그램</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">고양이: <strong><code>ggtext</code></strong>를 사용한 데이터 기반 주석</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nobel-laureates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">노벨상 수상자: 텍스트 배치 및 플롯 매개변수화</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./images.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">이미지 작업</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lemurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">여우원숭이: R에서 이미지 조작하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">R 패키지: 사용자 지정 패면 레이블에 이미지 사용하기</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공간 데이터 시각화</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./doctors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">전 세계 의사 분포: <strong><code>ggplot2</code></strong>로 지도 만들기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-zones.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">시간대: <strong><code>sf</code></strong>를 사용한 공간 데이터 및 매핑</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./us-elections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">미국 하원 선거: <strong><code>geofacet</code></strong>을 이용한 그리드 위의 지리</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-tricks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">기타 팁과 요령</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliography</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">부록</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0" id="toc-데이터" class="nav-link active" data-scroll-target="#%EB%8D%B0%EC%9D%B4%ED%84%B0"><span class="header-section-number">12.1</span> 데이터</a></li>
  <li>
<a href="#%ED%83%90%EC%83%89-%EC%9E%91%EC%97%85" id="toc-탐색-작업" class="nav-link" data-scroll-target="#%ED%83%90%EC%83%89-%EC%9E%91%EC%97%85"><span class="header-section-number">12.2</span> 탐색 작업</a>
  <ul class="collapse">
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%90%EC%83%89" id="toc-데이터-탐색" class="nav-link" data-scroll-target="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%90%EC%83%89"><span class="header-section-number">12.2.1</span> 데이터 탐색</a></li>
  <li><a href="#%ED%83%90%EC%83%89%EC%A0%81-%EC%8A%A4%EC%BC%80%EC%B9%98" id="toc-탐색적-스케치" class="nav-link" data-scroll-target="#%ED%83%90%EC%83%89%EC%A0%81-%EC%8A%A4%EC%BC%80%EC%B9%98"><span class="header-section-number">12.2.2</span> 탐색적 스케치</a></li>
  </ul>
</li>
  <li>
<a href="#%ED%94%8C%EB%A1%AF-%EC%A4%80%EB%B9%84%ED%95%98%EA%B8%B0" id="toc-플롯-준비하기" class="nav-link" data-scroll-target="#%ED%94%8C%EB%A1%AF-%EC%A4%80%EB%B9%84%ED%95%98%EA%B8%B0"><span class="header-section-number">12.3</span> 플롯 준비하기</a>
  <ul class="collapse">
<li><a href="#rnaturalearth%EB%A1%9C-%EB%A7%8C%EB%93%A0-%EC%A7%80%EB%8F%84" id="toc-rnaturalearth로-만든-지도" class="nav-link" data-scroll-target="#rnaturalearth%EB%A1%9C-%EB%A7%8C%EB%93%A0-%EC%A7%80%EB%8F%84"><span class="header-section-number">12.3.1</span> <strong><code>rnaturalearth</code></strong>로 만든 지도</a></li>
  <li><a href="#sf%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-%EA%B3%B5%EA%B0%84-%EA%B0%9D%EC%B2%B4" id="toc-sf를-사용한-공간-객체" class="nav-link" data-scroll-target="#sf%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-%EA%B3%B5%EA%B0%84-%EA%B0%9D%EC%B2%B4"><span class="header-section-number">12.3.2</span> <strong><code>sf</code></strong>를 사용한 공간 객체</a></li>
  <li><a href="#%EC%B2%AB-%EB%B2%88%EC%A7%B8-%ED%94%8C%EB%A1%AF" id="toc-첫-번째-플롯" class="nav-link" data-scroll-target="#%EC%B2%AB-%EB%B2%88%EC%A7%B8-%ED%94%8C%EB%A1%AF"><span class="header-section-number">12.3.3</span> 첫 번째 플롯</a></li>
  <li><a href="#%EC%83%89%EC%83%81" id="toc-색상" class="nav-link" data-scroll-target="#%EC%83%89%EC%83%81"><span class="header-section-number">12.3.4</span> 색상</a></li>
  <li><a href="#%EA%B8%80%EA%BC%B4" id="toc-글꼴" class="nav-link" data-scroll-target="#%EA%B8%80%EA%BC%B4"><span class="header-section-number">12.3.5</span> 글꼴</a></li>
  <li><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%A0%95%EC%9D%98-%EB%A7%89%EB%8C%80-%EC%B0%A8%ED%8A%B8-%EB%B2%94%EB%A1%80-%EB%A7%8C%EB%93%A4%EA%B8%B0" id="toc-사용자-정의-막대-차트-범례-만들기" class="nav-link" data-scroll-target="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%A0%95%EC%9D%98-%EB%A7%89%EB%8C%80-%EC%B0%A8%ED%8A%B8-%EB%B2%94%EB%A1%80-%EB%A7%8C%EB%93%A4%EA%B8%B0"><span class="header-section-number">12.3.6</span> 사용자 정의 막대 차트 범례 만들기</a></li>
  </ul>
</li>
  <li>
<a href="#%EA%B3%A0%EA%B8%89-%EC%8A%A4%ED%83%80%EC%9D%BC%EB%A7%81" id="toc-고급-스타일링" class="nav-link" data-scroll-target="#%EA%B3%A0%EA%B8%89-%EC%8A%A4%ED%83%80%EC%9D%BC%EB%A7%81"><span class="header-section-number">12.4</span> 고급 스타일링</a>
  <ul class="collapse">
<li><a href="#%EC%83%89%EC%83%81-%EC%A0%81%EC%9A%A9" id="toc-색상-적용" class="nav-link" data-scroll-target="#%EC%83%89%EC%83%81-%EC%A0%81%EC%9A%A9"><span class="header-section-number">12.4.1</span> 색상 적용</a></li>
  <li><a href="#%EC%B6%95-%ED%8E%B8%EC%A7%91" id="toc-축-편집" class="nav-link" data-scroll-target="#%EC%B6%95-%ED%8E%B8%EC%A7%91"><span class="header-section-number">12.4.2</span> 축 편집</a></li>
  <li><a href="#%ED%85%8D%EC%8A%A4%ED%8A%B8-%EC%B6%94%EA%B0%80" id="toc-텍스트-추가" class="nav-link" data-scroll-target="#%ED%85%8D%EC%8A%A4%ED%8A%B8-%EC%B6%94%EA%B0%80"><span class="header-section-number">12.4.3</span> 텍스트 추가</a></li>
  <li><a href="#%ED%85%8C%EB%A7%88-%EC%A1%B0%EC%A0%95" id="toc-테마-조정" class="nav-link" data-scroll-target="#%ED%85%8C%EB%A7%88-%EC%A1%B0%EC%A0%95"><span class="header-section-number">12.4.4</span> 테마 조정</a></li>
  <li><a href="#patchwork%EB%A1%9C-%ED%94%8C%EB%A1%AF-%EA%B2%B0%ED%95%A9%ED%95%98%EA%B8%B0" id="toc-patchwork로-플롯-결합하기" class="nav-link" data-scroll-target="#patchwork%EB%A1%9C-%ED%94%8C%EB%A1%AF-%EA%B2%B0%ED%95%A9%ED%95%98%EA%B8%B0"><span class="header-section-number">12.4.5</span> <strong><code>patchwork</code></strong>로 플롯 결합하기</a></li>
  </ul>
</li>
  <li><a href="#%ED%9A%8C%EA%B3%A0" id="toc-회고" class="nav-link" data-scroll-target="#%ED%9A%8C%EA%B3%A0"><span class="header-section-number">12.5</span> 회고</a></li>
  <li><a href="#%EC%97%B0%EC%8A%B5-%EB%AC%B8%EC%A0%9C" id="toc-연습-문제" class="nav-link" data-scroll-target="#%EC%97%B0%EC%8A%B5-%EB%AC%B8%EC%A0%9C"><span class="header-section-number">12.6</span> 연습 문제</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./spatial.html">공간 데이터 시각화</a></li><li class="breadcrumb-item"><a href="./time-zones.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">시간대: <strong><code>sf</code></strong>를 사용한 공간 데이터 및 매핑</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-time-zones" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">시간대: <strong><code>sf</code></strong>를 사용한 공간 데이터 및 매핑</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>이 장에서는 <strong><code>rnaturalearth</code></strong>를 사용하여 지도 데이터를 얻고, <strong><code>sf</code></strong>를 사용하여 공간 데이터를 조작하고 <strong><code>ggplot2</code></strong>로 플롯하며, 세계 지도에 사용자 정의 막대 차트 범례를 추가하는 방법을 배웁니다. </p>
<p>이 장을 마치면 다음을 할 수 있습니다:</p>
<ul>
<li>공간 데이터를 조작하고 사용된 좌표 참조 시스템을 변경합니다;</li>
<li>다른 소스의 데이터를 결합하고 국가 이름 철자가 일치하지 않는 문제를 해결합니다; 그리고</li>
<li>하나를 다른 하나 위에 겹쳐서 여러 플롯을 결합합니다.</li>
</ul>
<p>이 장에 필요한 패키지를 로드하는 것으로 시작합니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggtext/">ggtext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/">glue</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearth/">rnaturalearth</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yixuan/showtext">showtext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yixuan/sysfonts">sysfonts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dslc-io.github.io/tidytuesdayR/">tidytuesdayR</a></span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이 장에서는 몇 가지 새로운 패키지가 사용됩니다:</p>
<ul>
<li>
<strong><code>patchwork</code></strong>: 여러 플롯(및 테이블)을 그리드 레이아웃이나 삽입 요소로 정렬하고 결합합니다.</li>
<li>
<strong><code>rnaturalearth</code></strong>: 다양한 해상도와 형식으로 다양한 국가 및 지역에 대한 지리적 데이터를 다운로드할 수 있습니다.</li>
<li>
<strong><code>sf</code></strong>: 공간 데이터를 표현하는 표준화된 방법을 제공하고 이를 조작하는 함수를 가지고 있습니다. <strong><code>ggplot2</code></strong>를 포함한 다른 <strong><code>tidyverse</code></strong> 패키지와 쉽게 통합됩니다.</li>
</ul>
<p> </p>
<section id="데이터" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="데이터">
<span class="header-section-number">12.1</span> 데이터</h2>
<p><a href="https://data.iana.org/time-zones/tz-link.html">IANA(Internet Assigned Numbers Authority) tz 데이터베이스</a>에는 전 세계 여러 지역의 현지 시간 역사에 대한 데이터가 포함되어 있습니다 <span class="citation" data-cites="zones_data">(<a href="references.html#ref-zones_data" role="doc-biblioref">Internet Assigned Numbers Authority 2023</a>)</span>. 웹사이트에는 <em>“데이터베이스의 각 기본 항목은 1970년 이후 모두 합의된 일련의 시민용 시간 시계에 대한 시간대를 나타냅니다.”</em>라고 명시되어 있습니다. 많은 웹사이트가 IANA tz 데이터베이스의 데이터를 사용하여 운영됩니다.</p>
<p>시간대 데이터는 <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-03-28/readme.md">2023년 3월 TidyTuesday 데이터 세트</a>로 사용되었으며, 여기서 데이터 랭글링 코드는 <a href="https://gist.github.com/DavisVaughan">Davis Vaughan</a>의 코드에서 수정되었습니다. 실제로는 4개의 데이터 세트가 포함되어 있지만 지금은 <code>timezones</code> 데이터에 초점을 맞출 것입니다. <strong><code>tidytuesdayR</code></strong> 패키지 <span class="citation" data-cites="tidytuesdayR">(<a href="references.html#ref-tidytuesdayR" role="doc-biblioref">Hughes 2022b</a>)</span>의 <code><a href="https://dslc-io.github.io/tidytuesdayR/reference/tt_load.html">tt_load()</a></code> 함수를 사용하여 데이터를 R로 로드할 수 있습니다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tuesdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dslc-io.github.io/tidytuesdayR/reference/tt_load.html">tt_load</a></span><span class="op">(</span><span class="st">"2023-03-28"</span><span class="op">)</span></span>
<span><span class="va">timezones</span> <span class="op">&lt;-</span> <span class="va">tuesdata</span><span class="op">$</span><span class="va">timezones</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>데이터에는 337개의 시간대에 대한 4개의 다른 변수에 대한 정보가 포함되어 있습니다. <code>zone</code> 열에는 시간대 이름이 포함되어 있습니다. <code>latitude</code> 및 <code>longitude</code> 열에는 시간대의 <em>주요 위치</em>(예: 가장 큰 도시)에 대한 좌표가 포함되어 있습니다. <code>comments</code> 열에는 원래 시간대 정의 파일의 주석이 포함되어 있습니다.</p>
</section><section id="탐색-작업" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="탐색-작업">
<span class="header-section-number">12.2</span> 탐색 작업</h2>
<p><code>timezones</code> 데이터가 어떻게 생겼는지 살펴보는 것으로 시작하겠습니다!</p>
<section id="데이터-탐색" class="level3" data-number="12.2.1"><h3 data-number="12.2.1" class="anchored" data-anchor-id="데이터-탐색">
<span class="header-section-number">12.2.1</span> 데이터 탐색</h3>
<p><code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>를 사용하여 데이터의 처음 몇 행을 검사해 봅시다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">timezones</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 6 × 4
  zone              latitude longitude comments      
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;         
1 Africa/Abidjan        5.32     -4.03 &lt;NA&gt;          
2 Africa/Algiers       36.8       3.05 &lt;NA&gt;          
3 Africa/Bissau        11.8     -15.6  &lt;NA&gt;          
4 Africa/Cairo         30.0      31.2  &lt;NA&gt;          
5 Africa/Casablanca    33.6      -7.58 &lt;NA&gt;          
6 Africa/Ceuta         35.9      -5.32 Ceuta, Melilla</code></pre>
</div>
</div>
<p>가장 먼저 눈에 띄는 것은 누락된 데이터가 많은 것으로 보이는 <code>comments</code> 열입니다. <code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> 함수를 사용하여 누락된 데이터와 누락되지 않은 데이터의 수만 플롯하여 확인해 봅시다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">timezones</span><span class="op">$</span><span class="va">comments</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-barplot-na" class="quarto-float quarto-figure quarto-figure-center anchored" alt="`comments` 열의 결측값 수에 대한 막대 차트(`TRUE`는 결측을 나타냄).">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-barplot-na-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-barplot-na-1.png" class="img-fluid figure-img" alt="`comments` 열의 결측값 수에 대한 막대 차트(`TRUE`는 결측을 나타냄).">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-barplot-na-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.1: <code>comments</code> 열의 결측값 수에 대한 막대 차트(<code>TRUE</code>는 결측을 나타냄).
</figcaption></figure>
</div>
</div>
</div>
<p>시간대의 거의 40%에는 관련된 주석이 없습니다. 데이터를 더 자세히 조사하면 이러한 주석이 일반적으로 시간대 이름에 대한 설명이나 대안을 제공한다는 것을 알 수 있습니다. 이러한 주석의 존재 여부가 전 세계적으로 어떻게 달라지는지 탐구할 수도 있지만, 데이터에서 플롯하기에 가장 흥미로운 것은 아니므로 <strong><code>dplyr</code></strong>의 <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>를 사용하여 당분간 <code>comments</code> 열을 삭제하겠습니다.</p>
<p>첫 번째 열인 <code>zone</code>에는 시간대 이름에 대한 정보가 포함되어 있으며 일반적으로 <code>"대륙/도시"</code> 형식입니다. 대륙별 시간대 분포를 탐색하려면 이 변수를 두 개로 분할해야 합니다(또는 시간대 이름에서 대륙 이름만 추출). <strong><code>tidyr</code></strong>의 <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim()</a></code>을 사용하여 <code>/</code> 문자로 분항하여 <code>zone</code> 열에서 두 개의 새 열을 만들 수 있습니다. 일부 시간대 이름에는 이름에 두 개의 <code>/</code>가 있습니다(예: <code>"America/North_Dakota/New_Salem"</code>). 즉, 두 열에 대해 <em>너무 많은</em> 조각이 있습니다. 위치를 고유하게 지정하므로 <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim()</a></code>에 마지막 조각을 병합하도록 지시할 수 있습니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">timezones_data</span> <span class="op">&lt;-</span> <span class="va">timezones</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">comments</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="va">zone</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"/"</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"continent"</span>, <span class="st">"place"</span><span class="op">)</span>,</span>
<span>    too_many <span class="op">=</span> <span class="st">"merge"</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이제 <code><a href="https://rdrr.io/r/graphics/barplot.html">barplot()</a></code> 함수를 다시 사용하여 대륙당 시간대가 얼마나 많은지 탐색할 수 있습니다. <a href="#fig-timezones-barplot-loc" class="quarto-xref">Figure&nbsp;<span>12.2</span></a> 에서 시간대 이름의 첫 부분이 대륙과 정확히 일치하지 않는데 9개의 값이 있기 때문입니다. 하지만 넓은 지리적 지역으로 매핑됩니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">timezones_data</span><span class="op">$</span><span class="va">continent</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-barplot-loc" class="quarto-float quarto-figure quarto-figure-center anchored" alt="9개 지리적 지역 각각에 정의된 시간대 수에 대한 막대 차트.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-barplot-loc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-barplot-loc-1.png" class="img-fluid figure-img" alt="9개 지리적 지역 각각에 정의된 시간대 수에 대한 막대 차트.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-barplot-loc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.2: 9개 지리적 지역 각각에 정의된 시간대 수에 대한 막대 차트.
</figcaption></figure>
</div>
</div>
</div>
<p>물론 좌표 데이터가 있을 때 할 수 있는 가장 분명한 일은 지도에 좌표를 그리는 것입니다!</p>
</section><section id="탐색적-스케치" class="level3" data-number="12.2.2"><h3 data-number="12.2.2" class="anchored" data-anchor-id="탐색적-스케치">
<span class="header-section-number">12.2.2</span> 탐색적 스케치</h3>
<p>각 시간대 내의 주요 위치(보통 가장 큰 도시)에 대한 위도 및 경도 데이터가 있다는 점을 감안할 때 가장 먼저 떠오르는 지도 아이디어는 시간대 위치가 점으로 표시된 세계 지도입니다.</p>
<div id="fig-time-zones-sketch" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="세계 지도에 점으로 표시된 시간대 위치의 초기 스케치.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-time-zones-sketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/sketch-time-zones.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="세계 지도에 점으로 표시된 시간대 위치의 초기 스케치.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-time-zones-sketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.3: 세계 지도에 점으로 표시된 시간대 위치의 초기 스케치.
</figcaption></figure>
</div>
<p>점이 속한 지리적 지역(대륙)에 따라 점의 색상을 지정할 수 있습니다. 이미 보았듯이 <strong><code>ggplot2</code></strong>에서 변수를 기반으로 색상을 지정하면 차트에 범례가 자동으로 추가됩니다. 범주 레이블 옆에 색상 사각형을 사용하는 기존 범례 대신 막대 차트를 사용하여 사용자 정의 범례를 추가할 수 있습니다. 막대는 지역별 시간대 수를 표시하고 지도의 점과 동일한 방식으로 색상이 지정됩니다. 지도 아래에 있는 이 막대 차트 범례는 기존 범례보다 더 많은 공간을 차지하지 않지만 정보를 추가합니다(또는 최소한 기존 정보를 더 빠르고 쉽게 처리할 수 있도록 합니다).</p>
<div id="fig-time-zones-sketch" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="왼쪽 하단 모서리에 텍스트가 있고 오른쪽 하단에 범례로 막대 차트가 있는 세계 지도의 점에 대한 초기 스케치.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-time-zones-sketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/sketch-time-zones-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="왼쪽 하단 모서리에 텍스트가 있고 오른쪽 하단에 범례로 막대 차트가 있는 세계 지도의 점에 대한 초기 스케치.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-time-zones-sketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.4: 왼쪽 하단 모서리에 텍스트가 있고 오른쪽 하단에 범례로 막대 차트가 있는 세계 지도의 점에 대한 초기 스케치.
</figcaption></figure>
</div>
<p>지도 아래, 막대 차트 옆에 제목과 부제목을 추가할 수 있습니다. 텍스트를 (차트 상단에 긴 텍스트 문자열이 아닌) 더 정사각형 레이아웃으로 배치하면 읽기 쉽고 시각화가 매우 넓고 짧아지는 것을 방지할 수 있습니다.</p>
</section></section><section id="플롯-준비하기" class="level2" data-number="12.3"><h2 data-number="12.3" class="anchored" data-anchor-id="플롯-준비하기">
<span class="header-section-number">12.3</span> 플롯 준비하기</h2>
<p>플롯을 만들려면 배경 지도 데이터를 얻고 한 번에 여러 공간 데이터 파일을 사용하는 방법을 이해해야 합니다.</p>
<section id="rnaturalearth로-만든-지도" class="level3" data-number="12.3.1"><h3 data-number="12.3.1" class="anchored" data-anchor-id="rnaturalearth로-만든-지도">
<span class="header-section-number">12.3.1</span> <strong><code>rnaturalearth</code></strong>로 만든 지도</h3>
<p>지도에 점을 그리기 시작하기 전에 기본 국가를 표시하는 배경으로 사용할 수 있는 세계 지도가 필요합니다. <a href="doctors.html" class="quarto-xref"><span>Chapter 11</span></a> 에서는 <strong><code>ggplot2</code></strong>의 <code>map_data</code>를 사용했습니다. 여기서는 <strong><code>rnaturalearth</code></strong> 패키지 <span class="citation" data-cites="rnaturalearth">(<a href="references.html#ref-rnaturalearth" role="doc-biblioref">Massicotte and South 2023</a>)</span>를 사용하는 대안을 살펴보겠습니다.</p>
<p><strong><code>rnaturalearth</code></strong> 패키지를 사용하면 <a href="https://www.naturalearthdata.com/">Natural Earth</a> 지도 데이터와 상호 작용할 수 있습니다. <code><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html">ne_countries()</a></code> 함수를 사용하여 다양한 지리적 지역에 대한 다각형을 다운로드할 수 있습니다. 기본값은 모든 국가에 대한 데이터를 다운로드하는 것입니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html">ne_countries</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tip-timezones-rnatearth" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;12.1: <strong><code>rnaturalearth</code></strong>로 특정 국가의 다각형 가져오기
</div>
</div>
<div class="callout-body-container callout-body">
<p>특정 국가나 지역에 대한 다각형만 원하는 경우 <code>country</code> 인수를 지정할 수 있습니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">uk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html">ne_countries</a></span><span class="op">(</span></span>
<span>  country <span class="op">=</span> <span class="st">"united kingdom"</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>지정된 국가의 경우 <code><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_states.html">ne_states()</a></code> 함수는 행정 레벨 1 다각형(예: 주(state)와 같은 주요 국가 내 지역)을 제공합니다.</p>
</div>
</div>
<p><code><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html">ne_countries()</a></code> 함수의 기본 출력은 <code>sf</code> 객체입니다. 여기서 <code>sf</code>는 <em>Simple Features</em>를 나타냅니다. Simple Features는 공간 데이터베이스 및 지리 정보 시스템(GIS)에서 점, 선 및 다각형과 같은 기하학적 객체를 표현하기 위한 표준화된 모델입니다. <strong><code>sf</code></strong> 패키지 <span class="citation" data-cites="sf">(<a href="references.html#ref-sf" role="doc-biblioref">Pebesma 2018</a>)</span>는 R에서 simple features를 구현하여 <code>data.frame</code>(또는 <code>tibble</code>)으로 표현할 수 있도록 합니다. </p>
<p>R의 <code>sf</code> 객체는 화려한 data.frame으로 생각할 수 있으므로 <strong><code>ggplot2</code></strong>를 사용하여 플롯할 수 있습니다. 사실 <strong><code>ggplot2</code></strong>에는 <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code> 함수를 통해 <code>sf</code> 객체를 플로팅하는 기능이 내장되어 있습니다. 즉, 다른 유형의 차트를 만드는 것과 같은 방식으로 <code>sf</code> 객체에서 지도를 만들 수 있습니다. <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> 함수로 시작한 다음 <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code> 지오메트리를 레이어링합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bg_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">world</span><span class="op">)</span></span>
<span><span class="va">bg_map</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-bg-map" class="quarto-float quarto-figure quarto-figure-center anchored" alt="기본 회색 배경으로 국가 윤곽선을 보여주는 세계 지도.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-bg-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-bg-map-1.png" class="img-fluid figure-img" alt="기본 회색 배경으로 국가 윤곽선을 보여주는 세계 지도.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-bg-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.5: 기본 회색 배경으로 국가 윤곽선을 보여주는 세계 지도.
</figcaption></figure>
</div>
</div>
</div>
<p>한 가지 주요 차이점이 있음을 알 수 있습니다. <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> 함수를 사용하는 미적 매핑이 없습니다. 공간 좌표는 <code>sf</code> 객체 내에 포함되어 있으므로 <code>x</code> 및 <code>y</code> 변수를 명시적으로 매핑할 필요가 없습니다. <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code> 함수는 플로팅을 위해 포함된 좌표를 직접 추출하고 사용할 수 있습니다.</p>
</section><section id="sf를-사용한-공간-객체" class="level3" data-number="12.3.2"><h3 data-number="12.3.2" class="anchored" data-anchor-id="sf를-사용한-공간-객체">
<span class="header-section-number">12.3.2</span> <strong><code>sf</code></strong>를 사용한 공간 객체</h3>
<p><code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code>를 <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>와 같은 다른 함수 및 비 <code>sf</code> 데이터와 결합할 수 있지만, 먼저 다른 데이터를 <code>sf</code> 객체로 변환하는 것이 더 쉬운 경우가 많습니다. 주된 이유는 <em>좌표 참조 시스템(CRS)</em>이 두 지오메트리에 대해 동일하도록 하기 위해서입니다. 좌표 참조 시스템은 지구의 3차원 표면이 3차원 좌표계(예: 위도 및 경도) 또는 2차원 투영 지도로 표현되는 방식을 정의합니다. 전 세계의 다양한 지역에 일반적으로 사용되는 다양한 좌표 참조 시스템이 있습니다. 여러 공간 객체를 결합하는 경우 서로 다른 좌표 참조 시스템을 가질 수 있습니다. 예를 들어, 영국 국립 그리드(BNG) CRS를 사용하면 런던의 좌표는 <code>X = 492983</code> 및 <code>Y = 188837</code>입니다. 세계 측지 시스템 1984(WGS84) CRS에서 런던의 좌표는 <code>경도 (X) = 1.200235W</code> 및 <code>위도 (Y) = 53.870659N</code>입니다. 이 두 좌표를 먼저 변환하지 않고는 같은 지도에 그릴 수 없다는 것을 상상할 수 있을 것입니다.</p>
<p>R에서는 <strong><code>sf</code></strong> 패키지를 사용하여 서로 다른 좌표 참조 시스템 간에 설정하거나 변환할 수 있습니다. 가장 쉬운 방법은 특정 좌표 참조 시스템에 할당된 숫자 식별자인 EPSG 코드를 사용하는 것입니다. WGS84는 EPSG 코드 <code>4326</code>을 사용합니다. 이것은 배경 지도에 사용하고 있는 <code>world</code> 데이터에 사용된 좌표 참조 시스템입니다. 객체에서 CRS를 검색하는 <strong><code>sf</code></strong>의 <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs()</a></code> 함수를 사용하여 확인할 수 있습니다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
</div>
<p><code>timezones</code> 데이터의 CRS가 <code>world</code> 데이터의 CRS와 일치하는지 확인하기 위해 <code>timezones</code> 데이터의 CRS를 <code>4326</code>으로 설정할 수 있습니다. 현재 <code>timezones</code> 데이터는 공간 객체가 아닙니다. 위도 및 경도 정보가 포함된 두 개의 열이 있는 단순한 <code>data.frame</code>일 뿐입니다. 먼저 좌표 데이터와 관련된 열 이름도 지정하여 <strong><code>sf</code></strong>의 <code><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf()</a></code> 함수를 사용하여 <code>sf</code> 객체로 변환해야 합니다. </p>
<p><code>timezones</code> 데이터에 제공된 위도 및 경도 좌표는 <code>EPSG:4326</code> CRS에 있으므로 CRS를 변환할 필요가 없고 설정하기만 하면 됩니다. 데이터와 함께 이 정보가 제공되었으므로 <code>EPSG:4326</code>에 있다는 것을 알고 있으며 <code><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf()</a></code>의 <code>crs</code> 인수를 사용하여 설정할 수 있습니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">timezones_sf</span> <span class="op">&lt;-</span> <span class="va">timezones_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span></span>
<span>    coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>,</span>
<span>    crs <span class="op">=</span> <span class="fl">4326</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tip-timezones-crs" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;12.2: 알 수 없는 CRS 처리
</div>
</div>
<div class="callout-body-container callout-body">
<p>좌표가 어떤 CRS에 있는지 모르는 경우 가장 좋은 방법은 데이터 소스로 돌아가서 해당 정보를 찾을 수 있는지 확인하는 것입니다. 그렇지 않으면 CRS가 정의되지 않은 시스템에 대한 잠재적 좌표 참조 시스템을 <em>추측</em>하는 <strong><code>crsuggest</code></strong> <span class="citation" data-cites="crsuggest">(<a href="references.html#ref-crsuggest" role="doc-biblioref">Walker 2022</a>)</span>의 <code>guess_crs()</code> 함수를 사용해 볼 수 있습니다. </p>
<p>그런 다음 <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_set_crs()</a></code> 함수를 사용하여 좌표 참조 시스템을 설정할 수 있습니다. .</p>
</div>
</div>
</section><section id="첫-번째-플롯" class="level3" data-number="12.3.3"><h3 data-number="12.3.3" class="anchored" data-anchor-id="첫-번째-플롯">
<span class="header-section-number">12.3.3</span> 첫 번째 플롯</h3>
<p>시간대 좌표가 이제 <code>sf</code> 객체로 저장되었으므로 <code>world</code> 데이터와 같은 방식으로 플롯할 수 있습니다. <code>timezones_sf</code> 객체를 <code>data</code> 인수에 전달하고 <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> 함수 내부의 <code>color</code> 인수에 전달하여 <code>continent</code> 열을 기반으로 점의 색상을 지정하도록 지정합니다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">basic_map</span> <span class="op">&lt;-</span> <span class="va">bg_map</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">timezones_sf</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">continent</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">basic_map</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-basic-map" class="quarto-float quarto-figure quarto-figure-center anchored" alt="세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 대륙별로 색상이 지정되어 있고 지도 오른쪽에 색상 매핑을 나타내는 범례가 있습니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-basic-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-basic-map-1.png" class="img-fluid figure-img" alt="세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 대륙별로 색상이 지정되어 있고 지도 오른쪽에 색상 매핑을 나타내는 범례가 있습니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-basic-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.6: 세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 대륙별로 색상이 지정되어 있고 지도 오른쪽에 색상 매핑을 나타내는 범례가 있습니다.
</figcaption></figure>
</div>
</div>
</div>
<p>이제 지역별로 색상이 지정된 점이 있는 기본 지도와 오른쪽에 추가된 기본 범례가 있습니다. 더 나은 사용자 정의 범례를 만들어 봅시다.</p>
<p>지도의 새로운 범례를 만들기 전에 범례(및 플롯의 나머지 부분)에서 사용할 색상을 정의해야 합니다.</p>
</section><section id="색상" class="level3" data-number="12.3.4"><h3 data-number="12.3.4" class="anchored" data-anchor-id="색상">
<span class="header-section-number">12.3.4</span> 색상</h3>
<p>이전 장에서 했던 것처럼 텍스트 색상, 강조 색상 및 배경색을 변수로 정의하는 것으로 시작합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">text_col</span> <span class="op">&lt;-</span> <span class="st">"#2F4F4F"</span></span>
<span><span class="va">highlight_col</span> <span class="op">&lt;-</span> <span class="st">"#508080"</span></span>
<span><span class="va">bg_col</span> <span class="op">&lt;-</span> <span class="st">"#F0F5F5"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>그런 다음 지역 이름을 다른 16진수 코드로 매핑하여 명명된 색상 벡터를 정의합니다. 각 9개 지역에 대해 하나씩 충분한 색상이 있으면서도 색맹에 안전한 정성적 색상 팔레트를 찾기는 어려울 수 있습니다. Paul Tol은 그의 <a href="https://personal.sron.nl/~pault/"><em>Colour schemes and templates</em> 블로그 게시물</a> <span class="citation" data-cites="Tol2021">(<a href="references.html#ref-Tol2021" role="doc-biblioref">Tol 2021</a>)</span>에서 정성적 팔레트에 대한 몇 가지 옵션을 논의합니다. 여기서는 10가지 색상(누락된 데이터에 대한 옅은 회색 포함)이 있고 색맹에 안전한 <em>음소거된 정성적 색상 구성표(muted qualitative color scheme)</em> 팔레트 <span class="citation" data-cites="Tol2021">(<a href="references.html#ref-Tol2021" role="doc-biblioref">Tol 2021</a>)</span>를 사용합니다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">col_palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"#CC6677"</span>, <span class="st">"#332288"</span>, <span class="st">"#DDCC77"</span>,</span>
<span>  <span class="st">"#117733"</span>, <span class="st">"#88CCEE"</span>, <span class="st">"#882255"</span>,</span>
<span>  <span class="st">"#44AA99"</span>, <span class="st">"#999933"</span>, <span class="st">"#AA4499"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">col_palette</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">timezones_sf</span><span class="op">$</span><span class="va">continent</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="글꼴" class="level3" data-number="12.3.5"><h3 data-number="12.3.5" class="anchored" data-anchor-id="글꼴">
<span class="header-section-number">12.3.5</span> 글꼴</h3>
<p>마찬가지로 사용하려는 서체도 로드합니다. 다시 말하지만, 이 시각화를 위해 Google Fonts를 사용하므로 <strong><code>sysfonts</code></strong>의 <code><a href="https://rdrr.io/pkg/sysfonts/man/font_add_google.html">font_add_google()</a></code> 함수를 사용할 수 있습니다. 제목에는 20세기 서체에서 영감을 받은 구식 세리프 서체인 <em>Fraunces</em>를 사용합니다. 본문 텍스트에는 산세리프 서체인 <em>Commissioner</em>를 사용합니다. 이전 장에서 했던 것처럼 <code><a href="https://rdrr.io/pkg/showtext/man/showtext_auto.html">showtext_auto()</a></code>를 사용하여 플로팅 글꼴에 <strong><code>showtext</code></strong>를 자동으로 사용하고 <code><a href="https://rdrr.io/pkg/showtext/man/showtext_opts.html">showtext_opts()</a></code>를 사용하여 dpi를 설정하여 원하는 해상도를 설정합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add_google.html">font_add_google</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Commissioner"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add_google.html">font_add_google</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Fraunces"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/showtext/man/showtext_auto.html">showtext_auto</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/showtext/man/showtext_opts.html">showtext_opts</a></span><span class="op">(</span>dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">body_font</span> <span class="op">&lt;-</span> <span class="st">"Commissioner"</span></span>
<span><span class="va">title_font</span> <span class="op">&lt;-</span> <span class="st">"Fraunces"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="사용자-정의-막대-차트-범례-만들기" class="level3" data-number="12.3.6"><h3 data-number="12.3.6" class="anchored" data-anchor-id="사용자-정의-막대-차트-범례-만들기">
<span class="header-section-number">12.3.6</span> 사용자 정의 막대 차트 범례 만들기</h3>
<p><strong><code>ggplot2</code></strong>에서 막대 차트를 만드는 방법은 여러 가지가 있습니다. 가장 자주 사용되는 두 가지는 <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>와 <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code>입니다. 차이점은 무엇일까요? <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>는 기본적으로 각 범주의 관측치 수를 계산해 주는 <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code>의 특수 버전입니다. 이 시각화에서는 막대의 높이를 정의하는 것 외에 다른 목적으로 범주 수를 사용할 것이므로 직접 계산하고 대신 <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code>을 사용합니다. </p>
<p><strong><code>dplyr</code></strong>의 <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> 함수를 사용하여 <code>continent</code> 열에 각 지리적 지역의 관측치가 얼마나 있는지 계산합니다. 여기서 <code>timezones_sf</code> 데이터 또는 <code>timezones_data</code>를 입력 데이터로 사용할 수 있습니다. 두 가지를 모두 시도하면 예상대로 개수 열(<code>n</code>)은 두 경우 모두 동일하지만 두 출력이 동일하지 않다는 것을 알 수 있습니다! <code>count(timezones_data, continent)</code>를 실행하면 2열 <code>data.frame</code>을 얻습니다. <code>count(timezones_sf, continent)</code>를 실행하면 <code>sf</code> 객체로 유지되는 3열 <code>data.frame</code>을 얻습니다. 이는 <code>sf</code>의 <code>geometry</code> 열이 <em>끈적한(sticky)</em> 것으로 설명될 수 있기 때문입니다. 종종(항상 그런 것은 아니지만) 작업 후에도 <code>sf</code> 클래스가 보존되기를 원합니다. <strong><code>sf</code></strong>의 <code><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry()</a></code> 함수를 사용하여 제거할 수 있습니다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bar_data</span> <span class="op">&lt;-</span> <span class="va">timezones_sf</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">continent</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>새 <code>bar_data</code> 객체를 <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> 함수에 전달하여(항상 그렇듯이) 기본 막대 차트를 플롯해 봅시다. 또한 <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> 함수를 통해 미적 매핑을 추가하고 x축에 <code>continent</code>를, y축에 개수(<code>n</code>)를 배치합니다. 그런 다음 <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code>을 사용하여 막대 차트의 열을 그립니다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">bar_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">continent</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-bar-plot-0" class="quarto-float quarto-figure quarto-figure-center anchored" alt="각 대륙의 시간대 위치 수를 보여주는 막대 차트.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-bar-plot-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-bar-plot-0-1.png" class="img-fluid figure-img" alt="각 대륙의 시간대 위치 수를 보여주는 막대 차트.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-bar-plot-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.7: 각 대륙의 시간대 위치 수를 보여주는 막대 차트.
</figcaption></figure>
</div>
</div>
</div>
<p>전설(범례)로 효과적으로 작동하게 하려면 두 가지 작업을 수행해야 합니다:</p>
<ul>
<li>
<code>continent</code> 열을 기준으로 막대 색상을 지정합니다.</li>
<li>대신 막대에 직접 레이블을 추가하고 x축 레이블과 범례를 제거합니다.</li>
</ul>
<div id="tip-timezones-bar-colors" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;12.3: 막대 차트에 색상 추가
</div>
</div>
<div class="callout-body-container callout-body">
<p>일반 막대 차트(범례로 사용되지 않음)를 만드는 경우 막대에 색상을 추가하면 플롯이 더 밝게 보일 수 있지만 추가 정보는 추가되지 않습니다. 범주는 x축의 레이블로 이미 구별할 수 있습니다.</p>
</div>
</div>
<p>이번에는 미적 매핑에서 <code>fill</code>과 <code>label</code>을 <code>continent</code> 열에 매핑하여 막대 차트를 다시 만들어 봅시다. <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>의 미적 매핑에 <code>label</code>을 추가해도 <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>를 (아직) 추가하지 않기 때문에 막대 차트에는 아무런 영향을 미치지 않지만 어쨌든 전역 미적 매핑으로 추가해도 해가 되지는 않습니다. 또한 <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual()</a></code>을 사용하여 이전에 만든 <code>col_palette</code> 벡터에 정의된 색상으로 설정합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bar_plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">bar_data</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">continent</span>, y <span class="op">=</span> <span class="va">n</span>,</span>
<span>      fill <span class="op">=</span> <span class="va">continent</span>, label <span class="op">=</span> <span class="va">continent</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="va">col_palette</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">bar_plot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-bar-plot-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="각 지리적 지역의 시간대 위치 수를 보여주는 막대 차트로, 각 지역마다 다른 색상이 사용됩니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-bar-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-bar-plot-1-1.png" class="img-fluid figure-img" alt="각 지리적 지역의 시간대 위치 수를 보여주는 막대 차트로, 각 지역마다 다른 색상이 사용됩니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-bar-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.8: 각 지리적 지역의 시간대 위치 수를 보여주는 막대 차트로, 각 지역마다 다른 색상이 사용됩니다.
</figcaption></figure>
</div>
</div>
</div>
<p>이제 막대에 텍스트 레이블을 직접 추가할 수 있습니다. 하지만 어디에 넣어야 할까요? 막대 끝에 맞춰 범주 레이블을 추가하는 것이 꽤 일반적이지만 여기서는 잘 작동하지 않을 수 있습니다. 막대 안에 레이블을 추가하면 막대가 짧은 시간대가 적은 지역의 경우 텍스트가 매우 찌그러집니다. 막대 바깥에 레이블을 추가하면 막대가 긴 시간대가 많은 지역의 경우 텍스트가 그래프 밖으로 나가거나 시각화의 높이가 늘어납니다. 어느 것도 이상적이지 않습니다. 하지만 두 가지 장점을 모두 누릴 수도 있습니다. 다음 조건에서 레이블을 추가하려고 합니다:</p>
<p>막대가 길 때 텍스트는:</p>
<ul>
<li>막대 안에 나타나고 오른쪽 정렬되어야 합니다;</li>
<li>어두운 막대 배경과 대조되도록 밝은 색상이어야 합니다;</li>
</ul>
<p>반대로 막대가 짧을 때 텍스트는:</p>
<ul>
<li>막대 바깥에 나타나고 왼쪽 정렬되어야 합니다;</li>
<li>밝은 플롯 배경과 대조되도록 어두운 색상이어야 합니다;</li>
</ul>
<p>막대를 <em>짧거나</em> <em>긴</em> 것으로 정의하는 값을 찾는 데 약간의 시행착오가 필요할 수 있습니다. 여기서는 <code>45</code>를 사용합니다. 지역에 <code>45</code>개 이상의 시간대가 있으면 <em>긴</em> 막대로 분류됩니다. 그렇지 않으면 <em>짧습니다</em>.</p>
<p>텍스트의 정렬과 색상을 데이터 세트의 <code>n</code> 열(의 변환)에 매핑하려고 합니다. 이것은 <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> 함수의 미적 매핑에 들어가야 할 것 같습니다. 우리는 이미 <code>color</code> 인수를 사용하여 텍스트 색상을 매핑할 수 있다는 것을 알고 있습니다. <code>hjust</code> 및 <code>vjust</code> 인수는 텍스트의 수평 및 수직 위치 지정에 사용됩니다. 불행히도 <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> 함수 내에서는 <code>hjust</code>나 <code>vjust</code> 모두 <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> 함수 내에서 사용할 수 없습니다. </p>
<p>다행히 <strong><code>ggtext</code></strong> 패키지가 다시 구조해 줍니다! <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> 대신 <strong><code>ggtext</code></strong>의 <code><a href="https://wilkelab.org/ggtext/reference/geom_textbox.html">geom_textbox()</a></code> 함수를 사용할 수 있습니다. <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>와 매우 유사하게 작동하지만 변수를 <code>hjust</code> 및 <code>vjust</code>에 매핑할 수 있습니다. </p>
<p><strong><code>dplyr</code></strong>의 <code><a href="https://dplyr.tidyverse.org/reference/case-and-replace-when.html">case_when()</a></code>을 사용하여 <code>n</code> 값에 따라 <code>hjust</code> 인수에 대한 설정을 지정합니다. <code>n</code>이 <code>45</code>보다 크면 <code>hjust</code>는 오른쪽 정렬을 사용하려면 <code>1</code>이어야 하고 그렇지 않으면 왼쪽 정렬을 사용하려면 <code>0</code>이어야 합니다. 원하는 경우 <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> 함수 내에서 직접 <code><a href="https://dplyr.tidyverse.org/reference/case-and-replace-when.html">case_when()</a></code>을 사용하는 대신 데이터에 새 열을 만들 수 있습니다. </p>
<p><code><a href="https://wilkelab.org/ggtext/reference/geom_textbox.html">geom_textbox()</a></code>는 상자를 그리기 때문에 <code>hjust</code>를 사용하여 좌표에 대한 상자 정렬과 <code>halign</code>을 사용하여 상자 내 텍스트 정렬을 모두 제어해야 합니다. <code><a href="https://wilkelab.org/ggtext/reference/geom_textbox.html">geom_textbox()</a></code> 내에서도 <code>orientation = "left-rotated"</code>를 사용하여 텍스트를 시계 반대 방향으로 90도 회전합니다(<code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>에서 <code>angle = 90</code>을 사용하는 것과 유사). <code>fill = NA</code> 및 <code>box.color = NA</code>로 설정하여 배경 채우기 색상과 상자 윤곽선을 제거하고 <code>size</code> 및 <code>family</code> 인수를 사용하여 크기 및 글꼴 모음 옵션을 설정할 수 있습니다(여기서는 이전에 정의한 <code>body_font</code> 변수를 전달).</p>
<div id="tip-timezones-text-align" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;12.4: 텍스트 정렬
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><code>ggplot2</code></strong>에서 <code>hjust</code>(및 <code>halign</code>)는 수평 정렬을 제어하고 <code>vjust</code>(및 <code>valign</code>)는 수직 정렬을 제어합니다. 텍스트가 회전되면 회전되지 않은 정렬 인수를 사용해야 합니다. 예를 들어 텍스트를 위아래로 이동하더라도 <code>hjust</code>를 사용하여 텍스트를 정렬합니다.</p>
</div>
</div>
<p>텍스트 색상을 설정하는 데에도 비슷한 프로세스를 사용합니다. <code><a href="https://dplyr.tidyverse.org/reference/case-and-replace-when.html">case_when()</a></code>을 사용하여 45보다 큰지 여부에 따라 텍스트가 <code>bg_col</code> 또는 <code>text_col</code> 색상을 사용해야 하는지 지정합니다. 매핑할 변수로 처리하는 대신 이러한 변수를 <em>있는 그대로</em> 사용하기 위해 <code><a href="https://rdrr.io/r/base/AsIs.html">I()</a></code> 함수 내에 <code>bg_col</code> 및 <code>text_col</code> 변수를 래핑합니다. </p>
<p>마지막으로 <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void()</a></code>를 사용하여 모든 기존 테마 요소를 제거하고 <code>theme(legend.position = "none")</code>를 사용하여 범례를 제거할 수 있습니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">legend_plot</span> <span class="op">&lt;-</span> <span class="va">bar_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/ggtext/reference/geom_textbox.html">geom_textbox</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      hjust <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case-and-replace-when.html">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">n</span> <span class="op">&gt;</span> <span class="fl">45</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>        <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span></span>
<span>      <span class="op">)</span>,</span>
<span>      halign <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case-and-replace-when.html">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">n</span> <span class="op">&gt;</span> <span class="fl">45</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>        <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span></span>
<span>      <span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case-and-replace-when.html">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">n</span> <span class="op">&gt;</span> <span class="fl">45</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">bg_col</span><span class="op">)</span>,</span>
<span>        <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">text_col</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    family <span class="op">=</span> <span class="va">body_font</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    box.color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    orientation <span class="op">=</span> <span class="st">"left-rotated"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">legend_plot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-bar-plot-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="각 대륙의 시간대 위치 수를 보여주는 최소한의 막대 차트로, 각 막대에 대륙 이름을 지정하는 레이블이 있습니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-bar-plot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-bar-plot-2-1.png" class="img-fluid figure-img" alt="각 대륙의 시간대 위치 수를 보여주는 최소한의 막대 차트로, 각 막대에 대륙 이름을 지정하는 레이블이 있습니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-bar-plot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.9: 각 대륙의 시간대 위치 수를 보여주는 최소한의 막대 차트로, 각 막대에 대륙 이름을 지정하는 레이블이 있습니다.
</figcaption></figure>
</div>
</div>
</div>
<p>이제 훨씬 더 멋진 사용자 정의 범례가 생겼습니다. 두 가지를 결합하기 전에 기본 지도에 더 멋진 스타일을 적용할 수 있습니다!</p>
</section></section><section id="고급-스타일링" class="level2" data-number="12.4"><h2 data-number="12.4" class="anchored" data-anchor-id="고급-스타일링">
<span class="header-section-number">12.4</span> 고급 스타일링</h2>
<p>개선해야 할 플롯의 여러 요소가 있습니다:</p>
<ul>
<li>배경 지도는 기본값 대신 정의된 색상을 사용해야 합니다;</li>
<li>점도 정의된 색상을 사용해야 합니다;</li>
<li>정의된 서체를 사용하여 제목과 부제목을 추가해야 합니다;</li>
</ul>
<section id="색상-적용" class="level3" data-number="12.4.1"><h3 data-number="12.4.1" class="anchored" data-anchor-id="색상-적용">
<span class="header-section-number">12.4.1</span> 색상 적용</h3>
<p>테두리 색상으로 <code>text_col</code>을 사용하고 채우기 색상으로 <code>highlight_col</code>의 반투명 버전을 사용하여 배경 지도를 다시 그리는 것부터 시작하겠습니다. <strong><code>ggplot2</code></strong>의 <code><a href="https://scales.r-lib.org/reference/alpha.html">alpha()</a></code> 함수를 사용하여 투명도를 30%(0.3)로 설정할 수 있습니다. </p>
<p>약간의 조정을 통해 점도 다시 그립니다. 점에 사용되는 모양을 변경해 보겠습니다. <code>pch</code>(또는 <code>shape</code>) 인수를 사용하여 모양을 설정할 수 있습니다. <code>pch</code>에 사용할 수 있는 25가지 옵션이 있으며 숫자 1에서 25를 사용하여 지정할 수 있습니다. 여기서 사용할 모양은 가운데에 점이 있는 원입니다. 불행히도 25가지 옵션 중 하나가 아니므로 직접 만들어야 합니다. 기본 모양을 사용하되 조금 더 작게 만들어 가운데에 점을 그릴 수 있습니다. <code>pch = 21</code>(모양의 <code>fill</code>과 <code>color</code>를 모두 제어할 수 있음)을 선택하고 투명한 채우기로 조금 더 크게 만들어 원을 추가할 수 있습니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">basic_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># 배경 지도에 색상 적용</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">world</span>,</span>
<span>    color <span class="op">=</span> <span class="va">text_col</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="va">highlight_col</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Draw points for time zone locations</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">timezones_sf</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">continent</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Draw outer circle</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">timezones_sf</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">continent</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.6</span>,</span>
<span>    pch <span class="op">=</span> <span class="fl">21</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"transparent"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">basic_map</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-basic-map-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 기본 범례는 오른쪽에 표시됩니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-basic-map-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-basic-map-2-1.png" class="img-fluid figure-img" alt="세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 기본 범례는 오른쪽에 표시됩니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-basic-map-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.10: 세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 기본 범례는 오른쪽에 표시됩니다.
</figcaption></figure>
</div>
</div>
</div>
<p>막대 차트에했던 것과 동일한 색상을 (두) 점 모두에 적용합니다 (<code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual()</a></code> 대신 점의 경우 <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual()</a></code>을 사용해야 함). </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">col_map</span> <span class="op">&lt;-</span> <span class="va">basic_map</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">col_palette</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="축-편집" class="level3" data-number="12.4.2"><h3 data-number="12.4.2" class="anchored" data-anchor-id="축-편집">
<span class="header-section-number">12.4.2</span> 축 편집</h3>
<p>제목과 부제목 텍스트를 추가하기 전에 공간(및 나중에 추가할 범례)을 만들어야 합니다. <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous()</a></code> 및 <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous()</a></code>를 사용하여 x축과 y축의 제한을 설정해 봅시다. y축의 하한을 데이터 범위를 넘어 확장하여 텍스트를 겹쳐 놓을 수 있는 아래쪽 빈 공간을 남겨 둡니다. 또한 x축 스케일의 <code>breaks</code>를 조정하여 그리드 선을 더 가깝게 만듭니다. <code>15</code> x 값마다 그리드 선을 선택한 것이 이상해 보일 수 있지만 경도(x축)의 15도 차이는 약 1시간의 시차입니다(지구는 24시간 동안 360도, 즉 시간당 15도 회전하기 때문입니다)! </p>
<p>y축을 얼마나 확장해야 하는지 정확히 알아내려면 약간의(아마도 많은) 시행착오가 필요할 것입니다. 여기서는 빈 공간의 높이가 지도 영역 높이의 약 절반 정도가 되기를 원합니다. <code>st_bbox(world)</code>를 사용하여 <code>world</code> 지도 데이터의 경계 상자를 반환하면 세계 지도의 y축 범위가 -90에서 +83.6 사이임을 알 수 있습니다. 즉, y축을 약 80 또는 90 정도 확장하는 것이 좋은 시작점입니다. 또한 <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf()</a></code> 내부에서 <code>expand = FALSE</code>를 설정하여 측면 주변의 여분의 패딩을 제거합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">axes_map</span> <span class="op">&lt;-</span> <span class="va">col_map</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span>, by <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">190</span>, <span class="fl">190</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">170</span>, <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">axes_map</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-style-map-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 기본 범례는 오른쪽에 표시되며 세계 지도 아래에 큰 빈 공간이 있습니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-style-map-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-style-map-2-1.png" class="img-fluid figure-img" alt="세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 기본 범례는 오른쪽에 표시되며 세계 지도 아래에 큰 빈 공간이 있습니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-style-map-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.11: 세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 기본 범례는 오른쪽에 표시되며 세계 지도 아래에 큰 빈 공간이 있습니다.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="텍스트-추가" class="level3" data-number="12.4.3"><h3 data-number="12.4.3" class="anchored" data-anchor-id="텍스트-추가">
<span class="header-section-number">12.4.3</span> 텍스트 추가</h3>
<p><a href="cats.html" class="quarto-xref"><span>Chapter 7</span></a> 에서 설명한 대로 사용자 정의 Font Awesome 아이콘 캡션을 만들어 나중에 시각화 상단에 추가할 수 있습니다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">social</span> <span class="op">&lt;-</span> <span class="fu">social_caption</span><span class="op">(</span></span>
<span>  icon_color <span class="op">=</span> <span class="va">highlight_col</span>,</span>
<span>  font_color <span class="op">=</span> <span class="va">text_col</span>,</span>
<span>  font_family <span class="op">=</span> <span class="va">body_font</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><a href="wind-turbines.html" class="quarto-xref"><span>Chapter 6</span></a> 및 <a href="cats.html" class="quarto-xref"><span>Chapter 7</span></a> 에서 했던 것처럼 범주를 나타내기 위해 부제목 내에 색상이 있는 텍스트를 추가할 수도 있습니다. 사용자 정의 막대 차트 범례가 있으므로 이 시각화에는 불필요할 수 있지만 색상 매핑을 강화하는 것은 나쁘지 않습니다. 여기서는 <a href="cats.html" class="quarto-xref"><span>Chapter 7</span></a> 에서 했던 것처럼 <strong><code>ggtext</code></strong>를 사용합니다(원하는 경우 <a href="wind-turbines.html" class="quarto-xref"><span>Chapter 6</span></a> 에서 했던 것처럼 <strong><code>marquee</code></strong>를 사용할 수도 있음). 즉, HTML <code>&lt;span&gt;&lt;/span&gt;</code> 태그를 작성하고 <code><a href="https://glue.tidyverse.org/reference/glue.html">glue()</a></code>를 사용하여 <code>col_palette</code> 벡터의 색상을 전달합니다. 여기서는 인덱스 대신 각 벡터 요소 이름을 사용하여 변수를 호출하는 약간 다른 접근 방식을 취합니다. 이 접근 방식은 조금 더 수동적이지만 작성된 텍스트가 범주 이름과 약간 다르게 하려는 경우 유용할 수 있습니다. 코드도 종종 읽기가 조금 더 명확합니다! 이전 장에서 했던 것처럼 <code>source_caption()</code> 함수를 사용하는 대신 소스에 대한 정보를 부제목 텍스트에 직접 추가합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">subtitle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"Time zones tend to follow the boundaries between countries and their subdivisions instead of strictly following longitude. For every one-hour time, a point on the earth moves through 15 degrees of longitude. Each point relates to one of 337 time zones listed in the IANA time zone database. The colors show which time zones are in</span></span>
<span><span class="st">&lt;span style='color:{col_palette[\"Africa\"]};'&gt;Africa &lt;/span&gt;,</span></span>
<span><span class="st">&lt;span style='color:{col_palette[\"America\"]};'&gt;America &lt;/span&gt;,</span></span>
<span><span class="st">&lt;span style='color:{col_palette[\"Antarctica\"]};'&gt;Antarctica &lt;/span&gt;,</span></span>
<span><span class="st">&lt;span style='color:{col_palette[\"Asia\"]};'&gt;Asia &lt;/span&gt;,</span></span>
<span><span class="st">&lt;span style='color:{col_palette[\"Atlantic\"]};'&gt;Atlantic &lt;/span&gt;,</span></span>
<span><span class="st">&lt;span style='color:{col_palette[\"Australia\"]};'&gt;Australia &lt;/span&gt;,</span></span>
<span><span class="st">&lt;span style='color:{col_palette[\"Europe\"]};'&gt;Europe &lt;/span&gt;,</span></span>
<span><span class="st">&lt;span style='color:{col_palette[\"Indian\"]};'&gt;Indian &lt;/span&gt;, and</span></span>
<span><span class="st">&lt;span style='color:{col_palette[\"Pacific\"]};'&gt;Pacific &lt;/span&gt; zones.&lt;br&gt;**Data**: IANA tz database&lt;br&gt;"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>시각화 제목에 대한 텍스트도 지정합니다. 제목과 부제목을 결합하여 하나의 텍스트 객체로 플롯할 것이므로 HTML <code>&lt;span&gt;&lt;/span&gt;</code> 태그를 사용하여 제목의 글꼴 크기, 패밀리 및 색상을 설정합니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"&lt;span style='font-size:12pt; font-family:{title_font}; color:{text_col};'&gt;Time Zones of the World&lt;/span&gt;&lt;br&gt;"</span><span class="op">)</span></span>
<span><span class="va">title_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{title}{subtitle}"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><a href="doctors.html" class="quarto-xref"><span>Chapter 11</span></a> 에서 했던 것처럼 <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> 함수의 <code>tag</code> 옵션을 사용하여 지도에 <code>social</code> 캡션을 추가합니다. 마지막 단계에서 <code>theme</code> 요소를 편집할 때 태그의 위치를 지정합니다. </p>
<p>불행히도 두 개의 <code>tag</code>를 가질 수 없으며 제목/부제목 텍스트 객체에 대해서도 비표준 위치를 원하므로 대신 <code><a href="https://wilkelab.org/ggtext/reference/geom_textbox.html">geom_textbox()</a></code>를 사용하여 추가합니다. 텍스트 상자가 갈 위치의 x 및 y 좌표를 지정하고(다시 말하지만 많은 시행착오가 필요함!) 레이블에 <code>social</code> 객체를 전달합니다. 또한 <code><a href="https://wilkelab.org/ggtext/reference/geom_textbox.html">geom_textbox()</a></code>의 다른 인수를 사용하여 글꼴 <code>size</code> 및 <code>family</code>를 설정하고 텍스트 및 상자의 정렬을 지정합니다(앞서 막대 차트를 만들 때 했던 것과 마찬가지로). 상자 채우기 및 윤곽선 색상은 인수를 <code>NA</code>로 설정하여 제거합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">text_map</span> <span class="op">&lt;-</span> <span class="va">axes_map</span> <span class="op">+</span></span>
<span>  <span class="co"># add social icons</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/ggtext/reference/geom_textbox.html">geom_textbox</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">93</span>, label <span class="op">=</span> <span class="va">social</span><span class="op">)</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>    family <span class="op">=</span> <span class="va">body_font</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2.3</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    box.color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    halign <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    valign <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add title and subtitle</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>tag <span class="op">=</span> <span class="va">title_text</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="테마-조정" class="level3" data-number="12.4.4"><h3 data-number="12.4.4" class="anchored" data-anchor-id="테마-조정">
<span class="header-section-number">12.4.4</span> 테마 조정</h3>
<p>마지막 단계는 <strong><code>ggplot2</code></strong> 테마를 몇 가지 작게 변경하는 것입니다. <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void()</a></code>를 사용하여 모든 테마 요소를 제거하고 텍스트에 대해 <code>base_family</code> 및 <code>base_size</code>를 설정하는 것으로 시작합니다. <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code> 함수로 제어되는 시각화에 텍스트 요소가 많지는 않지만 <code>tag</code> 텍스트에는 여전히 영향을 미칩니다. </p>
<p><code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code> 함수를 사용하여 기본 범례를 제거하고, 배경색을 <code>bg_col</code> 변수로 변경하고, 거의 투명한 <code>text_col</code> 색상으로 그리드 선을 다시 추가하기 위해 몇 가지 추가 편집을 수행합니다. <code>tag</code> 텍스트의 위치는 <code>plot.tag.position</code> 인수를 사용하여 플롯의 왼쪽 하단에 배치하도록 설정할 수 있습니다. 또한 <code>tag</code>에 HTML <code>&lt;span&gt;&lt;/span&gt;</code> 태그가 포함되어 있으므로 <strong><code>ggtext</code></strong>의 <code><a href="https://wilkelab.org/ggtext/reference/element_textbox.html">element_textbox_simple()</a></code>을 사용하여 텍스트 서식을 지정합니다. <code><a href="https://wilkelab.org/ggtext/reference/element_textbox.html">element_textbox_simple()</a></code> 내에서 <code>maxwidth</code> 인수는 텍스트 상자의 너비를 설정하는 데 사용되어 하단 빈 공간의 왼쪽만 차지하도록 합니다. 막대 차트 범례는 반대쪽에 들어갑니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">styled_map</span> <span class="op">&lt;-</span> <span class="va">text_map</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">6</span>, base_family <span class="op">=</span> <span class="va">body_font</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span></span>
<span>      fill <span class="op">=</span> <span class="va">bg_col</span>,</span>
<span>      color <span class="op">=</span> <span class="va">bg_col</span>,</span>
<span>    <span class="op">)</span>,</span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span></span>
<span>      color <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="va">text_col</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># add and position text</span></span>
<span>    plot.tag.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.01</span>, <span class="fl">0.12</span><span class="op">)</span>,</span>
<span>    plot.tag <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_textbox.html">element_textbox_simple</a></span><span class="op">(</span></span>
<span>      color <span class="op">=</span> <span class="va">text_col</span>,</span>
<span>      hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      maxwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">200</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>      margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span></span>
<span>        l <span class="op">=</span> <span class="fl">15</span>, t <span class="op">=</span> <span class="fl">5</span>, b <span class="op">=</span> <span class="fl">10</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">styled_map</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-style-map-4" class="quarto-float quarto-figure quarto-figure-center anchored" alt="세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 제목과 부제목은 왼쪽 하단에 표시됩니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-style-map-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-style-map-4-1.png" class="img-fluid figure-img" alt="세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 제목과 부제목은 왼쪽 하단에 표시됩니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-style-map-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.12: 세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 제목과 부제목은 왼쪽 하단에 표시됩니다.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="patchwork로-플롯-결합하기" class="level3" data-number="12.4.5"><h3 data-number="12.4.5" class="anchored" data-anchor-id="patchwork로-플롯-결합하기">
<span class="header-section-number">12.4.5</span> <strong><code>patchwork</code></strong>로 플롯 결합하기</h3>
<p>마지막으로 범례 막대 차트를 메인 플롯에 결합해야 합니다. 이를 위해 <strong><code>patchwork</code></strong> <span class="citation" data-cites="patchwork">(<a href="references.html#ref-patchwork" role="doc-biblioref">Pedersen 2024</a>)</span>를 사용합니다. <strong><code>patchwork</code></strong> 패키지를 사용하면 여러 시각화(<strong><code>ggplot2</code></strong> 그래픽, 기본 R 플롯 또는 <strong><code>gt</code></strong> 테이블 포함)를 단일 레이아웃으로 결합할 수 있습니다. 매우 유연하며 플롯을 간단한 행이나 열로 쉽게 정렬하거나 중첩된 플롯이 많은 매우 복잡한 레이아웃을 만들 수 있습니다. <strong><code>patchwork</code></strong> 패키지를 사용하면 삽입 플롯(inset plot), 즉 더 큰 플롯 내에 배치된 더 작은 플롯을 추가하여 추가 세부 정보를 제공할 수도 있습니다.</p>
<div id="tip-timezones-patchwork" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;12.5: <strong><code>patchwork</code></strong>로 플롯 정렬하기
</div>
</div>
<div class="callout-body-container callout-body">
<p>이 책에는 여러 플롯을 나란히 배열하는 예제는 포함되어 있지 않지만 <strong><code>patchwork</code></strong>를 사용하면 매우 쉽게 할 수 있습니다. 두 개의 플롯 <code>g1</code>과 <code>g2</code>가 있는 경우 <code>g1 + g2</code>를 실행하기만 하면 나란히 배열할 수 있습니다. 어떤 플롯을 어디에 배치할지 그리드를 지정하여 더 복잡한 레이아웃을 얻을 수 있습니다. <strong><code>patchwork</code></strong> 패키지에는 멀티플롯 주석 또는 제목 추가, 모든 서브플롯에 걸친 일관된 테마, 여러 페이지에 걸친 플롯 정렬 정의를 위한 추가 함수도 포함되어 있습니다. 예제는 패키지 문서 <a href="https://patchwork.data-imaginist.com/index.html">patchwork.data-imaginist.com</a>를 참조하십시오.</p>
</div>
</div>
<p>이 시각화에서는 플롯을 나란히 배열하는 전통적인 접근 방식보다는 한 플롯(막대 차트)을 다른 플롯(메인 지도) 위에 배치하려고 합니다. <code>styled_map</code>으로 시작하여 <code><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element()</a></code> 함수를 사용하여 <code>legend_plot</code>을 위에 추가합니다. <code><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element()</a></code> 함수에 제공된 4개의 위치는 삽입 플롯의 왼쪽, 아래쪽, 오른쪽 및 위쪽 외부 경계입니다. 기본 단위는 <code>npc</code>(정규화된 부모 좌표)입니다. 이 설정에서 왼쪽 하단은 <code>(0, 0)</code>이고 오른쪽 상단은 <code>(1, 1)</code>입니다. 즉, <code>left</code> 외부 경계를 0.55로 지정하면 <strong><code>patchwork</code></strong>가 메인 플롯의 왼쪽에서 55% 들어간 지점에서 삽입 플롯의 왼쪽을 시작하도록 지시합니다. </p>
<p>또한 <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code> 함수를 사용하고 모든 여백을 0으로 설정하여 플롯 가장자리 주변의 추가 여백을 제거합니다. <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code>을 <code>patchwork</code> 객체와 결합할 때는 <code>+</code> 대신 <code>&amp;</code> 연산자를 사용하여 추가된다는 점을 기억하십시오. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">styled_map</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element</a></span><span class="op">(</span><span class="va">legend_plot</span>, <span class="fl">0.55</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.3</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-timezones-final-plot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 제목과 부제목은 왼쪽 하단에 표시되며, 범례로 사용되는 삽입 막대 차트는 오른쪽 하단에 표시됩니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-timezones-final-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="time-zones_files/figure-html/fig-timezones-final-plot-1.png" class="img-fluid figure-img" alt="세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 제목과 부제목은 왼쪽 하단에 표시되며, 범례로 사용되는 삽입 막대 차트는 오른쪽 하단에 표시됩니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timezones-final-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.13: 세계 지도에 다른 시간대 위치를 나타내는 점으로, 점은 지리적 지역별로 색상이 지정되어 있습니다. 제목과 부제목은 왼쪽 하단에 표시되며, 범례로 사용되는 삽입 막대 차트는 오른쪽 하단에 표시됩니다.
</figcaption></figure>
</div>
</div>
</div>
<p>이제 지도가 완성되었으므로 <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>로 저장할 수 있습니다! </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span></span>
<span>  filename <span class="op">=</span> <span class="st">"time-zones.png"</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">0.92</span> <span class="op">*</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section></section><section id="회고" class="level2" data-number="12.5"><h2 data-number="12.5" class="anchored" data-anchor-id="회고">
<span class="header-section-number">12.5</span> 회고</h2>
<p>이 플롯에서 무엇을 더 개선할 수 있을까요?</p>
<p>막대 차트 범례는 지루하고 전통적인 범례보다는 개선되었지만 추가적인 개선이 필요할 수 있습니다. 예를 들어 막대 차트가 무엇을 보여주는지 바로 명확하지 않습니다. 시간이 조금 걸리면 독자들은 아마도 점의 수와 막대의 높이를 연결하겠지만 더 명확할 수 있습니다. 막대 차트에 숫자를 추가하면 가독성도 향상됩니다. 이것은 전통적인 y축을 사용하거나 더 유익한 레이블을 사용할 수 있습니다. 예를 들어 <code>"Africa"</code>라고 읽는 레이블 대신 <code>"Africa (18 time zones)"</code>라고 읽을 수 있습니다.</p>
<p>막대 차트의 가독성을 향상시키는 것에 대해 이야기한다면 쉬운 조치는 막대(및 텍스트)를 수평으로 만드는 것입니다. 올바른 방향으로 된 텍스트를 읽는 것이 훨씬 쉽습니다!</p>
<p>이 시각화의 원본 버전을 개발하는 과정에서 생성된 각 플롯은 <strong><code>camcorder</code></strong>를 사용하여 캡처되었으며 아래 gif에 표시됩니다. 데이터 시각화 프로세스에서 <strong><code>camcorder</code></strong>를 사용하는 방법에 대해 자세히 알아보려면 <a href="other-tricks.html#sec-camcorder" class="quarto-xref"><span>Section 14.1</span></a> 를 참조하십시오.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/time-zones.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="차트 작성 과정의 Gif"></p>
</figure>
</div>
</section><section id="연습-문제" class="level2" data-number="12.6"><h2 data-number="12.6" class="anchored" data-anchor-id="연습-문제">
<span class="header-section-number">12.6</span> 연습 문제</h2>
<ul>
<li><p>각 지리적 지역의 시간대 수에 대한 정보를 포함하도록 막대 차트 범례를 편집하십시오.</p></li>
<li><p>수직 막대 대신 수평 막대를 갖도록 막대 차트를 편집하십시오.</p></li>
<li><p>업데이트된 막대 차트 범례가 어디에 위치할지 고려하십시오. 막대가 수평인 경우 오른쪽 하단 모서리가 여전히 좋은 위치입니까? 다른 곳으로 옮겨 보십시오.</p></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Anscombe1973" class="csl-entry" role="listitem">
Anscombe, F. J. 1973. <span>“Graphs in Statistical Analysis.”</span> <em>The American Statistician</em> 27 (1): 17–21. <a href="https://doi.org/10.1080/00031305.1973.10478966">https://doi.org/10.1080/00031305.1973.10478966</a>.
</div>
<div id="ref-aphalo2024" class="csl-entry" role="listitem">
Aphalo, Pedro J. 2024. <em><span class="nocase">Learn R: As a Language</span></em>. Second Edition. CRC Press. <a href="https://www.learnr-book.info/">https://www.learnr-book.info/</a>.
</div>
<div id="ref-egg" class="csl-entry" role="listitem">
Auguie, Baptiste. 2019. <em><span class="nocase">egg: Extensions for ’ggplot2’: Custom Geom, Custom Themes, Plot Alignment, Labelled Panels, Symmetric Scales, and Fixed Panel Size</span></em>. <a href="https://CRAN.R-project.org/package=egg">https://CRAN.R-project.org/package=egg</a>.
</div>
<div id="ref-imager" class="csl-entry" role="listitem">
Barthelme, Simon. 2024. <em><span class="nocase">imager: Image Processing Library Based on ’CImg’</span></em>. <a href="https://CRAN.R-project.org/package=imager">https://CRAN.R-project.org/package=imager</a>.
</div>
<div id="ref-vandenBrandv4" class="csl-entry" role="listitem">
Brand, Teun van den. 2025. <span>“<span class="nocase">ggplot2 4.0.0</span>.”</span> <a href="https://www.tidyverse.org/blog/2025/09/ggplot2-4-0-0/" class="uri">https://www.tidyverse.org/blog/2025/09/ggplot2-4-0-0/</a>.
</div>
<div id="ref-bridson2007" class="csl-entry" role="listitem">
Bridson, Robert. 2007. <span>“Fast Poisson Disk Sampling in Arbitrary Dimensions.”</span> In <em>ACM SIGGRAPH 2007 Sketches</em>. SIGGRAPH ’07. New York, NY, USA: Association for Computing Machinery. <a href="https://doi.org/10.1145/1278780.1278807">https://doi.org/10.1145/1278780.1278807</a>.
</div>
<div id="ref-Brown2009" class="csl-entry" role="listitem">
Brown, Mark J.F., and Paxton, Robert J. 2009. <span>“The Conservation of Bees: A Global Perspective.”</span> <em>Apidologie</em> 40 (3): 410–16. <a href="https://doi.org/10.1051/apido/2009019">https://doi.org/10.1051/apido/2009019</a>.
</div>
<div id="ref-geomtextpath" class="csl-entry" role="listitem">
Cameron, Allan, and Teun van den Brand. 2024. <em><span class="nocase">geomtextpath: Curved Text in ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=geomtextpath">https://CRAN.R-project.org/package=geomtextpath</a>.
</div>
<div id="ref-cartocolors" class="csl-entry" role="listitem">
CARTO. 2016. <em><span>’CARTOColors’ Palettes</span></em>. <a href="https://carto.com/carto-colors/">https://carto.com/carto-colors/</a>.
</div>
<div id="ref-extrafont" class="csl-entry" role="listitem">
Chang, Winston. 2023. <em><span class="nocase">extrafont</span>: Tools for Using Fonts</em>. <a href="https://CRAN.R-project.org/package=extrafont">https://CRAN.R-project.org/package=extrafont</a>.
</div>
<div id="ref-dumbbell" class="csl-entry" role="listitem">
Cheung, Foo. 2021. <em><span class="nocase">dumbbell</span>: Displaying Changes Between Two Points Using Dumbbell Plots</em>. <a href="https://CRAN.R-project.org/package=dumbbell">https://CRAN.R-project.org/package=dumbbell</a>.
</div>
<div id="ref-ggannotate" class="csl-entry" role="listitem">
Cowgill, Matt, and John Helveston. 2021. <em><span class="nocase">ggannotate: Interactively Annotate ggplot2 Plots</span></em>. <a href="https://github.com/MattCowgill/ggannotate">https://github.com/MattCowgill/ggannotate</a>.
</div>
<div id="ref-pak" class="csl-entry" role="listitem">
Csárdi, Gábor, and Jim Hester. 2024. <em><span class="nocase">pak: Another Approach to Package Installation</span></em>. <a href="https://CRAN.R-project.org/package=pak">https://CRAN.R-project.org/package=pak</a>.
</div>
<div id="ref-remotes" class="csl-entry" role="listitem">
Csárdi, Gábor, Jim Hester, Hadley Wickham, Winston Chang, Martin Morgan, and Dan Tenenbaum. 2024. <em><span class="nocase">remotes: R Package Installation from Remote Repositories, Including ’GitHub’</span></em>. <a href="https://CRAN.R-project.org/package=remotes">https://CRAN.R-project.org/package=remotes</a>.
</div>
<div id="ref-ggview" class="csl-entry" role="listitem">
Domin, Iaroslav. 2024. <em><span class="nocase">ggview: ’ggplot2’ Picture Previewer</span></em>. <a href="https://CRAN.R-project.org/package=ggview">https://CRAN.R-project.org/package=ggview</a>.
</div>
<div id="ref-tidyplots" class="csl-entry" role="listitem">
Engler, Jan Broder. 2024. <span>“Tidyplots Empowers Life Scientists with Easy Code-Based Data Visualization.”</span> <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2024.11.08.621836">https://doi.org/10.1101/2024.11.08.621836</a>.
</div>
<div id="ref-ggpattern" class="csl-entry" role="listitem">
FC, Mike, Trevor L. Davis, and ggplot2 authors. 2024. <em><span class="nocase">ggpattern: ’ggplot2’ Pattern Geoms</span></em>. <a href="https://CRAN.R-project.org/package=ggpattern">https://CRAN.R-project.org/package=ggpattern</a>.
</div>
<div id="ref-flaticon" class="csl-entry" role="listitem">
Flaticon.com. 2024. <span>“<span>Wind Power Flaticon</span>.”</span> <a href="https://www.flaticon.com/free-icon/wind-power_5670189" class="uri">https://www.flaticon.com/free-icon/wind-power_5670189</a>.
</div>
<div id="ref-fontawesome" class="csl-entry" role="listitem">
Font Awesome. 2024. <span>“<span>Font Awesome 6</span>.”</span> <a href="https://fontawesome.com/" class="uri">https://fontawesome.com/</a>.
</div>
<div id="ref-Hullman2021" class="csl-entry" role="listitem">
Franconeri, Steven L., Lace M. Padilla, Priti Shah, Jeffrey M. Zacks, and Jessica Hullman. 2021. <span>“The Science of Visual Data Communication: What Works.”</span> <em>Psychological Science in the Public Interest</em> 22 (3): 110–61. <a href="https://doi.org/10.1177/15291006211051956">https://doi.org/10.1177/15291006211051956</a>.
</div>
<div id="ref-viridis" class="csl-entry" role="listitem">
Garnier, Simon, Ross, Noam, Rudis, Robert, Camargo, et al. 2024. <em><span class="nocase">viridis(Lite)</span> - Colorblind-Friendly Color Maps for <span>R</span></em>. <a href="https://doi.org/10.5281/zenodo.4679423">https://doi.org/10.5281/zenodo.4679423</a>.
</div>
<div id="ref-ggiraph" class="csl-entry" role="listitem">
Gohel, David, and Panagiotis Skintzos. 2024. <em><span class="nocase">ggiraph: Make ’ggplot2’ Graphics Interactive</span></em>. <a href="https://CRAN.R-project.org/package=ggiraph">https://CRAN.R-project.org/package=ggiraph</a>.
</div>
<div id="ref-GAcharts" class="csl-entry" role="listitem">
Government Analysis Function. 2021. <span>“Data Visualisation: Colours.”</span> <a href="https://analysisfunction.civilservice.gov.uk/policy-store/data-visualisation-colours-in-charts/" class="uri">https://analysisfunction.civilservice.gov.uk/policy-store/data-visualisation-colours-in-charts/</a>.
</div>
<div id="ref-geofacet" class="csl-entry" role="listitem">
Hafen, Ryan. 2023. <em><span class="nocase">geofacet</span>: <span class="nocase">’ggplot2’</span> Faceting Utilities for Geographical Data</em>. <a href="https://CRAN.R-project.org/package=geofacet">https://CRAN.R-project.org/package=geofacet</a>.
</div>
<div id="ref-harmon2024" class="csl-entry" role="listitem">
Harmon, Jon. 2024. <em><span class="nocase">Web APIs with R</span></em>. <span>CRC Press</span>. <a href="https://wapir.io/">https://wapir.io/</a>.
</div>
<div id="ref-lintr" class="csl-entry" role="listitem">
Hester, Jim, Florent Angly, Russ Hyde, Michael Chirico, Kun Ren, Alexander Rosenstock, and Indrajeet Patil. 2024. <em><span class="nocase">lintr</span>: A ’Linter’ for <span>R</span> Code</em>. <a href="https://CRAN.R-project.org/package=lintr">https://CRAN.R-project.org/package=lintr</a>.
</div>
<div id="ref-glue" class="csl-entry" role="listitem">
Hester, Jim, and Jennifer Bryan. 2024. <em><span class="nocase">glue</span>: Interpreted String Literals</em>. <a href="https://glue.tidyverse.org/">https://glue.tidyverse.org/</a>.
</div>
<div id="ref-camcorder" class="csl-entry" role="listitem">
Hughes, Ellis. 2022a. <em><span class="nocase">camcorder</span>: Record Your Plot History</em>. <a href="https://CRAN.R-project.org/package=camcorder">https://CRAN.R-project.org/package=camcorder</a>.
</div>
<div id="ref-tidytuesdayR" class="csl-entry" role="listitem">
———. 2022b. <em><span class="nocase">tidytuesdayR</span>: Access the Weekly ’TidyTuesday’ Project Dataset</em>. <a href="https://CRAN.R-project.org/package=tidytuesdayR">https://CRAN.R-project.org/package=tidytuesdayR</a>.
</div>
<div id="ref-paletteer" class="csl-entry" role="listitem">
Hvitfeldt, Emil. 2021. <em><span class="nocase">paletteer</span>: Comprehensive Collection of Color Palettes</em>. <a href="https://github.com/EmilHvitfeldt/paletteer">https://github.com/EmilHvitfeldt/paletteer</a>.
</div>
<div id="ref-animalshelter" class="csl-entry" role="listitem">
———. 2025. <em><span class="nocase">animalshelter</span>: Animal Shelter Data</em>. <a href="https://github.com/EmilHvitfeldt/animalshelter">https://github.com/EmilHvitfeldt/animalshelter</a>.
</div>
<div id="ref-fontawesomeR" class="csl-entry" role="listitem">
Iannone, Richard. 2024. <em><span class="nocase">fontawesome: Easily Work with ’Font Awesome’ Icons</span></em>. <a href="https://CRAN.R-project.org/package=fontawesome">https://CRAN.R-project.org/package=fontawesome</a>.
</div>
<div id="ref-zones_data" class="csl-entry" role="listitem">
Internet Assigned Numbers Authority. 2023. <span>“The <span class="nocase">tz</span> Database: Time Zone and Daylight Saving Time Data.”</span> <span>Internet Assigned Numbers Authority</span>. <a href="https://data.iana.org/time-zones/tz-link.html">https://data.iana.org/time-zones/tz-link.html</a>.
</div>
<div id="ref-img_jax" class="csl-entry" role="listitem">
Jax (@lysrix). 2017. <span>“Lemur.”</span> <a href="https://unsplash.com/photos/red-and-white-rodent-h5xrh3CNT-k">https://unsplash.com/photos/red-and-white-rodent-h5xrh3CNT-k</a>.
</div>
<div id="ref-kays2020" class="csl-entry" role="listitem">
Kays, R., R. R. Dunn, A. W. Parsons, B. Mcdonald, T. Perkins, S. A. Powers, L. Shell, et al. 2020. <span>“The Small Home Ranges and Large Local Ecological Impacts of Pet Cats.”</span> <em>Animal Conservation</em> 23 (5): 516–23. <a href="https://doi.org/10.1111/acv.12563">https://doi.org/10.1111/acv.12563</a>.
</div>
<div id="ref-r4rest" class="csl-entry" role="listitem">
Keyes, David. 2024. <em><span class="nocase">R for the Rest of Us: A Statistics-Free Introduction</span></em>. No Starch Press. <a href="https://book.rfortherestofus.com/">https://book.rfortherestofus.com/</a>.
</div>
<div id="ref-longbeach_data" class="csl-entry" role="listitem">
Long Beach Animal Shelter. 2025. <span>“<span>Animal Shelter Data</span>.”</span> City of Long Beach Animal Care Services. <a href="https://data.longbeach.gov/explore/dataset/animal-shelter-intakes-and-outcomes/information/">https://data.longbeach.gov/explore/dataset/animal-shelter-intakes-and-outcomes/information/</a>.
</div>
<div id="ref-Vizumap" class="csl-entry" role="listitem">
Lucchesi, Lydia, and Petra Kuhnert. 2020. <em><span>Vizumap</span>: Visualizing Uncertainty in Spatial Data</em>. <a href="https://github.com/lydialucchesi/Vizumap">https://github.com/lydialucchesi/Vizumap</a>.
</div>
<div id="ref-museums_data" class="csl-entry" role="listitem">
Mapping Museums. 2021. <span>“Mapping Museums Data.”</span> <a href="https://www.mappingmuseums.org">www.mappingmuseums.org</a>.
</div>
<div id="ref-rnaturalearth" class="csl-entry" role="listitem">
Massicotte, Philippe, and Andy South. 2023. <em><span class="nocase">rnaturalearth</span>: World Map Data from Natural Earth</em>. <a href="https://docs.ropensci.org/rnaturalearth/">https://docs.ropensci.org/rnaturalearth/</a>.
</div>
<div id="ref-Matejka2017" class="csl-entry" role="listitem">
Matejka, Justin, and George Fitzmaurice. 2017. <span>“Same Stats, Different Graphs: Generating Datasets with Varied Appearance and Identical Statistics Through Simulated Annealing.”</span> In, 1290–94. <a href="https://doi.org/10.1145/3025453.3025912">https://doi.org/10.1145/3025453.3025912</a>.
</div>
<div id="ref-cats_data" class="csl-entry" role="listitem">
McDonald, J. L., and H. Cole. 2020. <span>“Data from: The Small Home Ranges and Large Local Ecological Impacts of Pet Cats [United Kingdom].”</span> Movebank data repository. <a href="https://doi.org/doi:10.5441/001/1.pf315732">https://doi.org/doi:10.5441/001/1.pf315732</a>.
</div>
<div id="ref-colorblindr" class="csl-entry" role="listitem">
McWhite, Claire D., and Claus O. Wilke. 2024. <em><span class="nocase">colorblindr: Simulate colorblindness in R figures</span></em>. <a href="https://github.com/clauswilke/colorblindr">https://github.com/clauswilke/colorblindr</a>.
</div>
<div id="ref-Apiculture" class="csl-entry" role="listitem">
Mid-Atlantic Apiculture Research and Extension Consortium. 2024. <span>“Seasonal Cycles of Activities in Colonies.”</span> <a href="https://canr.udel.edu/maarec/honey-bee-biology/seasonal-cycles-of-activities-in-colonies/" class="uri">https://canr.udel.edu/maarec/honey-bee-biology/seasonal-cycles-of-activities-in-colonies/</a>.
</div>
<div id="ref-poissoned" class="csl-entry" role="listitem">
mikefc. 2024. <em><span class="nocase">poissoned: Tileable Poisson Disc Sampling</span></em>. <a href="https://github.com/coolbutuseless/poissoned">https://github.com/coolbutuseless/poissoned</a>.
</div>
<div id="ref-MetBrewer" class="csl-entry" role="listitem">
Mills, Blake Robert. 2022. <em><span>MetBrewer</span>: Color Palettes Inspired by Works at the Metropolitan Museum of Art</em>. <a href="https://CRAN.R-project.org/package=MetBrewer">https://CRAN.R-project.org/package=MetBrewer</a>.
</div>
<div id="ref-elections_data" class="csl-entry" role="listitem">
MIT Election Data and Science Lab. 2017. <span>“<span>U.S. House 1976–2022</span>.”</span> Harvard Dataverse. <a href="https://doi.org/10.7910/DVN/IG0UN2">https://doi.org/10.7910/DVN/IG0UN2</a>.
</div>
<div id="ref-styler" class="csl-entry" role="listitem">
Müller, Kirill, and Lorenz Walthert. 2023. <em><span class="nocase">styler</span>: Non-Invasive Pretty Printing of <span>R</span> Code</em>. <a href="https://CRAN.R-project.org/package=styler">https://CRAN.R-project.org/package=styler</a>.
</div>
<div id="ref-tibble" class="csl-entry" role="listitem">
Müller, Kirill, and Hadley Wickham. 2023. <em><span class="nocase">tibble</span>: Simple Data Frames</em>. <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a>.
</div>
<div id="ref-Muth2018" class="csl-entry" role="listitem">
Muth, Lisa. 2018. <span>“An Alternative to Pink &amp; Blue: Colors for Gender Data.”</span> <a href="https://blog.datawrapper.de/gendercolor/" class="uri">https://blog.datawrapper.de/gendercolor/</a>.
</div>
<div id="ref-turbines_data" class="csl-entry" role="listitem">
Natural Resources Canada. 2021. <span>“Canadian Wind Turbine Database.”</span> Natural Resources Canada (Government of Canada). <a href="https://open.canada.ca/data/en/dataset/79fdad93-9025-49ad-ba16-c26d718cc070">https://open.canada.ca/data/en/dataset/79fdad93-9025-49ad-ba16-c26d718cc070</a>.
</div>
<div id="ref-ggbranding" class="csl-entry" role="listitem">
Noblet, Guillaume. 2025. <em><span class="nocase">ggbranding: Add Personal Branding to ’ggplot2’ Charts</span></em>. <a href="https://github.com/gnoblet/ggbranding">https://github.com/gnoblet/ggbranding</a>.
</div>
<div id="ref-rcartocolor" class="csl-entry" role="listitem">
Nowosad, Jakub. 2018. <em><span>’CARTOColors’ Palettes</span></em>. <a href="https://jakubnowosad.com/rcartocolor/">https://jakubnowosad.com/rcartocolor/</a>.
</div>
<div id="ref-magick" class="csl-entry" role="listitem">
Ooms, Jeroen. 2024. <em><span class="nocase">magick: Advanced Graphics and Image-Processing in R</span></em>. <a href="https://CRAN.R-project.org/package=magick">https://CRAN.R-project.org/package=magick</a>.
</div>
<div id="ref-doctors_data" class="csl-entry" role="listitem">
Our World in Data. 2019. <span>“Medical Doctors Per 1,000 People.”</span> <a href="https://ourworldindata.org/grapher/physicians-per-1000-people">https://ourworldindata.org/grapher/physicians-per-1000-people</a>.
</div>
<div id="ref-sf" class="csl-entry" role="listitem">
Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for R: Standardized Support for Spatial Vector Data</span>.”</span> <em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-ggforce" class="csl-entry" role="listitem">
Pedersen, Thomas Lin. 2022. <em><span class="nocase">ggforce</span>: Accelerating <span class="nocase">’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggforce">https://CRAN.R-project.org/package=ggforce</a>.
</div>
<div id="ref-patchwork" class="csl-entry" role="listitem">
———. 2024. <em><span class="nocase">patchwork</span>: The Composer of Plots</em>. <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>.
</div>
<div id="ref-Pedersen2025" class="csl-entry" role="listitem">
———. 2025. <span>“<span class="nocase">Fonts in R</span>.”</span> <a href="https://www.tidyverse.org/blog/2025/05/fonts-in-r/" class="uri">https://www.tidyverse.org/blog/2025/05/fonts-in-r/</a>.
</div>
<div id="ref-marquee" class="csl-entry" role="listitem">
Pedersen, Thomas Lin, and Martin Mitáš. 2024. <em><span class="nocase">marquee: Markdown Parser and Renderer for R Graphics</span></em>. <a href="https://CRAN.R-project.org/package=marquee">https://CRAN.R-project.org/package=marquee</a>.
</div>
<div id="ref-systemfonts" class="csl-entry" role="listitem">
Pedersen, Thomas Lin, Jeroen Ooms, and Devon Govett. 2024. <em><span class="nocase">systemfonts: System Native Font Finding</span></em>. <a href="https://CRAN.R-project.org/package=systemfonts">https://CRAN.R-project.org/package=systemfonts</a>.
</div>
<div id="ref-ragg" class="csl-entry" role="listitem">
Pedersen, Thomas Lin, and Maxim Shemanarev. 2023. <em><span class="nocase">ragg</span>: Graphic Devices Based on <span>AGG</span></em>. <a href="https://CRAN.R-project.org/package=ragg">https://CRAN.R-project.org/package=ragg</a>.
</div>
<div id="ref-pldb_data" class="csl-entry" role="listitem">
PLDB contributors. 2022. <span>“<span>PLDB</span>: A Programming Language Database.”</span> <em><span>PLDB</span></em>. <a href="https://pldb.com">https://pldb.com</a>.
</div>
<div id="ref-sysfonts" class="csl-entry" role="listitem">
Qiu, Yixuan. 2022. <em><span class="nocase">sysfonts</span>: Loading Fonts into <span>R</span></em>. <a href="https://CRAN.R-project.org/package=sysfonts">https://CRAN.R-project.org/package=sysfonts</a>.
</div>
<div id="ref-showtext" class="csl-entry" role="listitem">
———. 2023. <em><span class="nocase">showtext</span>: Using Fonts More Easily in <span>R</span> Graphs</em>. <a href="https://CRAN.R-project.org/package=showtext">https://CRAN.R-project.org/package=showtext</a>.
</div>
<div id="ref-rproj" class="csl-entry" role="listitem">
R Core Team. 2024. <em><span>R</span>: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-tidytuesday" class="csl-entry" role="listitem">
R4DS Online Learning Community. 2023. <span>“Tidy Tuesday: A Weekly Social Data Project.”</span> <a href="https://github.com/rfordatascience/tidytuesday">https://github.com/rfordatascience/tidytuesday</a>.
</div>
<div id="ref-social_icons" class="csl-entry" role="listitem">
Rennie, Nicola. 2023a. <span>“Adding Social Media Icons to Charts with <span class="nocase">ggplot2</span>.”</span> <a href="https://nrennie.rbind.io/blog/adding-social-media-icons-ggplot2/">https://nrennie.rbind.io/blog/adding-social-media-icons-ggplot2/</a>.
</div>
<div id="ref-template_files" class="csl-entry" role="listitem">
———. 2023b. <span>“Creating Template Files with <span>R</span>.”</span> <a href="https://nrennie.rbind.io/blog/script-templates-r/">https://nrennie.rbind.io/blog/script-templates-r/</a>.
</div>
<div id="ref-streamline" class="csl-entry" role="listitem">
———. 2023c. <span>“Four Ways to Streamline Your <span>R</span> Workflows.”</span> <a href="https://nrennie.rbind.io/blog/four-ways-streamline-r-workflows/">https://nrennie.rbind.io/blog/four-ways-streamline-r-workflows/</a>.
</div>
<div id="ref-ggtextcircle" class="csl-entry" role="listitem">
———. 2024a. <em><span class="nocase">ggtextcircle: Circular Text in ’ggplot2’</span></em>. <a href="https://github.com/nrennie/ggtextcircle">https://github.com/nrennie/ggtextcircle</a>.
</div>
<div id="ref-nobel" class="csl-entry" role="listitem">
———. 2024b. <em><span class="nocase">nobel: Access data from the Nobel Prize API via R</span></em>. <a href="https://github.com/nrennie/nobel">https://github.com/nrennie/nobel</a>.
</div>
<div id="ref-pkgs_data" class="csl-entry" role="listitem">
———. 2024c. <span>“<span class="nocase">tidytuesday</span>.”</span> <em>GitHub Repository</em>. GitHub. <a href="https://github.com/nrennie/tidytuesday">https://github.com/nrennie/tidytuesday</a>.
</div>
<div id="ref-signif2024a" class="csl-entry" role="listitem">
Rennie, Nicola, and Andreas Krause. 2024. <span>“<span class="nocase">Presenting data the Significance way - Part 1</span>.”</span> <em>Significance</em> 21 (3): 36–39. <a href="https://doi.org/10.1093/jrssig/qmae045">https://doi.org/10.1093/jrssig/qmae045</a>.
</div>
<div id="ref-Reynolds2025" class="csl-entry" role="listitem">
Reynolds, Gina. 2025. <span>“<span class="nocase">Everyday ggplot2 extension</span>.”</span> <a href="https://evamaerey.github.io/everyday_ggplot2_extension/" class="uri">https://evamaerey.github.io/everyday_ggplot2_extension/</a>.
</div>
<div id="ref-hex_forcats" class="csl-entry" role="listitem">
RStudio. 2018a. <span>“<span class="nocase">forcats</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/forcats.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/forcats.png</a>.
</div>
<div id="ref-hex_ggplot2" class="csl-entry" role="listitem">
———. 2018b. <span>“<span class="nocase">ggplot2</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/ggplot2.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/ggplot2.png</a>.
</div>
<div id="ref-hex_purrr" class="csl-entry" role="listitem">
———. 2018c. <span>“<span class="nocase">purrr</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/purrr.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/purrr.png</a>.
</div>
<div id="ref-hex_readr" class="csl-entry" role="listitem">
———. 2018d. <span>“<span class="nocase">readr</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/readr.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/readr.png</a>.
</div>
<div id="ref-hex_tibble" class="csl-entry" role="listitem">
———. 2018e. <span>“<span class="nocase">tibble</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/tibble.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/tibble.png</a>.
</div>
<div id="ref-hex_dplyr" class="csl-entry" role="listitem">
———. 2020a. <span>“<span class="nocase">dplyr</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/dplyr.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/dplyr.png</a>.
</div>
<div id="ref-hex_stringr" class="csl-entry" role="listitem">
———. 2020b. <span>“<span class="nocase">stringr</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/stringr.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/stringr.png</a>.
</div>
<div id="ref-hex_tidyr" class="csl-entry" role="listitem">
———. 2020c. <span>“<span class="nocase">tidyr</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/tidyr.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/tidyr.png</a>.
</div>
<div id="ref-ggalt" class="csl-entry" role="listitem">
Rudis, Bob, Ben Bolker, and Jan Schulz. 2017. <em><span class="nocase">ggalt: Extra Coordinate Systems, ’Geoms’, Statistical Transformations, Scales and Fonts for ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggalt">https://CRAN.R-project.org/package=ggalt</a>.
</div>
<div id="ref-waffle" class="csl-entry" role="listitem">
Rudis, Bob, and Dave Gandy. 2023. <em><span class="nocase">waffle</span>: Create Waffle Chart Visualizations</em>. <a href="https://CRAN.R-project.org/package=waffle">https://CRAN.R-project.org/package=waffle</a>.
</div>
<div id="ref-lattice" class="csl-entry" role="listitem">
Sarkar, Deepayan. 2008. <em>Lattice: Multivariate Data Visualization with r</em>. New York: Springer. <a href="http://lmdvr.r-forge.r-project.org">http://lmdvr.r-forge.r-project.org</a>.
</div>
<div id="ref-openxlsx" class="csl-entry" role="listitem">
Schauberger, Philipp, and Alexander Walker. 2023. <em><span class="nocase">openxlsx: Read, Write and Edit xlsx Files</span></em>. <a href="https://CRAN.R-project.org/package=openxlsx">https://CRAN.R-project.org/package=openxlsx</a>.
</div>
<div id="ref-owidapi" class="csl-entry" role="listitem">
Scheuch, Christoph. 2025. <em><span class="nocase">owidapi</span>: Access the Our World in Data Chart API</em>. <a href="https://doi.org/10.32614/CRAN.package.owidapi">https://doi.org/10.32614/CRAN.package.owidapi</a>.
</div>
<div id="ref-GGally" class="csl-entry" role="listitem">
Schloerke, Barret, Di Cook, Joseph Larmarange, Francois Briatte, Moritz Marbach, Edwin Thoen, Amos Elberg, and Jason Crowley. 2024. <em><span class="nocase">GGally: Extension to ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=GGally">https://CRAN.R-project.org/package=GGally</a>.
</div>
<div id="ref-Schloss" class="csl-entry" role="listitem">
Schloss, Karen B., Connor C. Gramazio, Allison T. Silverman, Madeline L. Parker, and Audrey S. Wang. 2019. <span>“Mapping Color to Meaning in Colormap Data Visualizations.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 25 (1): 810–19. <a href="https://doi.org/10.1109/TVCG.2018.2865147">https://doi.org/10.1109/TVCG.2018.2865147</a>.
</div>
<div id="ref-funspotr" class="csl-entry" role="listitem">
Shalloway, Bryan. 2023. <em><span class="nocase">funspotr: Spot R Functions &amp; Packages</span></em>. <a href="https://CRAN.R-project.org/package=funspotr">https://CRAN.R-project.org/package=funspotr</a>.
</div>
<div id="ref-plotly" class="csl-entry" role="listitem">
Sievert, Carson. 2020. <em>Interactive Web-Based Data Visualization with r, Plotly, and Shiny</em>. Chapman; Hall/CRC. <a href="https://plotly-r.com">https://plotly-r.com</a>.
</div>
<div id="ref-ggrepel" class="csl-entry" role="listitem">
Slowikowski, Kamil. 2024. <em><span class="nocase">ggrepel: Automatically Position Non-Overlapping Text Labels with ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggrepel">https://CRAN.R-project.org/package=ggrepel</a>.
</div>
<div id="ref-visdat" class="csl-entry" role="listitem">
Tierney, Nicholas. 2017. <span>“<span class="nocase">visdat: Visualising Whole Data Frames</span>.”</span> <em>JOSS</em> 2 (16): 355. <a href="https://doi.org/10.21105/joss.00355">https://doi.org/10.21105/joss.00355</a>.
</div>
<div id="ref-naniar" class="csl-entry" role="listitem">
Tierney, Nicholas, and Dianne Cook. 2023. <span>“Expanding Tidy Data Principles to Facilitate Missing Data Exploration, Visualization and Assessment of Imputations.”</span> <em>Journal of Statistical Software</em> 105 (7): 1–31. <a href="https://doi.org/10.18637/jss.v105.i07">https://doi.org/10.18637/jss.v105.i07</a>.
</div>
<div id="ref-Tol2021" class="csl-entry" role="listitem">
Tol, Paul. 2021. <span>“<span class="nocase">Paul Tol’s Notes: Colour schemes and templates</span>.”</span> <a href="https://sronpersonalpages.nl/~pault/" class="uri">https://sronpersonalpages.nl/~pault/</a>.
</div>
<div id="ref-UScensuspop" class="csl-entry" role="listitem">
United States Census Bureau. 2021a. <span>“Historical Population Change Data (1910-2020).”</span> <a href="https://www.census.gov/data/tables/time-series/dec/popchange-data-text.html" class="uri">https://www.census.gov/data/tables/time-series/dec/popchange-data-text.html</a>.
</div>
<div id="ref-UScensus" class="csl-entry" role="listitem">
———. 2021b. <span>“State Area Measurements and Internal Point Coordinates.”</span> <a href="https://www.census.gov/geographies/reference-files/2010/geo/state-area.html" class="uri">https://www.census.gov/geographies/reference-files/2010/geo/state-area.html</a>.
</div>
<div id="ref-bees_data" class="csl-entry" role="listitem">
United States Department of Agriculture: Economics, Statistics and Market Information System. 2022. <span>“Honey Bee Colonies.”</span> <span>USDA Economics, Statistics and Market Information System</span>. <a href="https://usda.library.cornell.edu/concern/publications/rn301137d">https://usda.library.cornell.edu/concern/publications/rn301137d</a>.
</div>
<div id="ref-crsuggest" class="csl-entry" role="listitem">
Walker, Kyle. 2022. <em><span class="nocase">crsuggest: Obtain Suggested Coordinate Reference System Information for Spatial Data</span></em>. <a href="https://CRAN.R-project.org/package=crsuggest">https://CRAN.R-project.org/package=crsuggest</a>.
</div>
<div id="ref-Wanzer2021" class="csl-entry" role="listitem">
Wanzer, Dana Linnell, Tarek Azzam, Natalie D. Jones, and Darrel Skousen. 2021. <span>“The Role of Titles in Enhancing Data Visualization.”</span> <em>Evaluation and Program Planning</em> 84: 101896. <a href="https://doi.org/10.1016/j.evalprogplan.2020.101896">https://doi.org/10.1016/j.evalprogplan.2020.101896</a>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <em><span class="nocase">ggplot2</span>: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-forcats" class="csl-entry" role="listitem">
———. 2023a. <em><span class="nocase">forcats</span>: Tools for Working with Categorical Variables (Factors)</em>. <a href="https://doi.org/10.32614/CRAN.package.forcats">https://doi.org/10.32614/CRAN.package.forcats</a>.
</div>
<div id="ref-stringr" class="csl-entry" role="listitem">
———. 2023b. <em><span class="nocase">stringr: Simple, Consistent Wrappers for Common String Operations</span></em>. <a href="https://CRAN.R-project.org/package=stringr">https://CRAN.R-project.org/package=stringr</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-readxl" class="csl-entry" role="listitem">
Wickham, Hadley, and Jennifer Bryan. 2023. <em><span class="nocase">readxl: Read Excel Files</span></em>. <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a>.
</div>
<div id="ref-r4ds" class="csl-entry" role="listitem">
Wickham, Hadley, Mine Çetinkaya-Rundel, and Garrett Grolemund. 2023. <em><span>R</span> for Data Science</em>. Second Edition. O-Reilly. <a href="https://r4ds.hadley.nz">https://r4ds.hadley.nz</a>.
</div>
<div id="ref-dplyr" class="csl-entry" role="listitem">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis Vaughan. 2023. <em><span class="nocase">dplyr</span>: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-purrr" class="csl-entry" role="listitem">
Wickham, Hadley, and Lionel Henry. 2023. <em><span class="nocase">purrr</span>: Functional Programming Tools</em>. <a href="https://CRAN.R-project.org/package=purrr">https://CRAN.R-project.org/package=purrr</a>.
</div>
<div id="ref-readr" class="csl-entry" role="listitem">
Wickham, Hadley, Jim Hester, and Jennifer Bryan. 2024. <em><span class="nocase">readr</span>: Read Rectangular Text Data</em>. <a href="https://CRAN.R-project.org/package=readr">https://CRAN.R-project.org/package=readr</a>.
</div>
<div id="ref-scales" class="csl-entry" role="listitem">
Wickham, Hadley, Thomas Lin Pedersen, and Dana Seidel. 2023. <em><span class="nocase">scales</span>: Scale Functions for Visualization</em>. <a href="https://CRAN.R-project.org/package=scales">https://CRAN.R-project.org/package=scales</a>.
</div>
<div id="ref-tidyr" class="csl-entry" role="listitem">
Wickham, Hadley, Davis Vaughan, and Maximilian Girlich. 2024. <em><span class="nocase">tidyr</span>: Tidy Messy Data</em>. <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
<div id="ref-ggtextures" class="csl-entry" role="listitem">
Wilke, Claus. 2022. <em><span class="nocase">ggtextures: Drawing Textured Rectangles and Bars with grid and ggplot2</span></em>. <a href="https://github.com/clauswilke/ggtextures">https://github.com/clauswilke/ggtextures</a>.
</div>
<div id="ref-cowplot" class="csl-entry" role="listitem">
Wilke, Claus O. 2024. <em><span class="nocase">cowplot</span>: Streamlined Plot Theme and Plot Annotations for <span class="nocase">’ggplot2’</span></em>. <a href="https://wilkelab.org/cowplot/">https://wilkelab.org/cowplot/</a>.
</div>
<div id="ref-ggtext" class="csl-entry" role="listitem">
Wilke, Claus O., and Brenton M. Wiernik. 2022. <em><span class="nocase">ggtext</span>: Improved Text Rendering Support for <span class="nocase">’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggtext">https://CRAN.R-project.org/package=ggtext</a>.
</div>
<div id="ref-nobel_data" class="csl-entry" role="listitem">
www.nobelprize.org. 2024. <span>“<span>Nobel Prize API Version 2.1</span>.”</span> <a href="https://api.nobelprize.org/2.1/laureates">https://api.nobelprize.org/2.1/laureates</a>.
</div>
<div id="ref-owidR" class="csl-entry" role="listitem">
York, Piers. 2023. <em><span class="nocase">owidR</span>: Import Data from Our World in Data</em>. <a href="https://github.com/piersyork/owidR">https://github.com/piersyork/owidR</a>.
</div>
<div id="ref-ggimage" class="csl-entry" role="listitem">
Yu, Guangchuang. 2023. <em><span class="nocase">ggimage: Use Image in ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggimage">https://CRAN.R-project.org/package=ggimage</a>.
</div>
<div id="ref-gghighlight" class="csl-entry" role="listitem">
Yutani, Hiroaki. 2023. <em><span class="nocase">gghighlight</span>: Highlight Lines and Points in <span class="nocase">’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=gghighlight">https://CRAN.R-project.org/package=gghighlight</a>.
</div>
<div id="ref-lemurs_data" class="csl-entry" role="listitem">
Zehr, Sarah M., Richard G. Roach, David Haring, Julie Taylor, Freda H. Cameron, and Anne D. Yoder. 2014. <span>“<span class="nocase">Life history profiles for 27 strepsirrhine primate taxa generated using captive data from the Duke Lemur Center</span>.”</span> <em>Scientific Data</em> 1 (1). <a href="https://doi.org/10.1038/sdata.2014.19">https://doi.org/10.1038/sdata.2014.19</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/nrennie\.rbind\.io\/art-of-viz\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./doctors.html" class="pagination-link" aria-label="전 세계 의사 분포: **`ggplot2`**로 지도 만들기">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">전 세계 의사 분포: <strong><code>ggplot2</code></strong>로 지도 만들기</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./us-elections.html" class="pagination-link" aria-label="미국 하원 선거: **`geofacet`**을 이용한 그리드 위의 지리">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">미국 하원 선거: <strong><code>geofacet</code></strong>을 이용한 그리드 위의 지리</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>