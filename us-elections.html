<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta charset="UTF-8">
<meta name="generator" content="quarto-1.8.27">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>13&nbsp; 미국 하원 선거: geofacet을 이용한 그리드 위의 지리 – The Art of Data Visualization with ggplot2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./other-tricks.html" rel="next">
<link href="./time-zones.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-795e9e8eca1e12b12abcb09a27409631.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8fdef79e5307f93f1ac50f4e683e47eb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1SWN5BH1PZ"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-1SWN5BH1PZ', { 'anonymize_ip': true});
</script>
<meta property="og:title" content="13&nbsp; 미국 하원 선거: geofacet을 이용한 그리드 위의 지리 – The Art of Data Visualization with ggplot2">
<meta property="og:description" content="">
<meta property="og:image" content="https://nrennie.rbind.io/art-of-viz/us-elections_files/figure-html/fig-elections-scatterplot-1.png">
<meta property="og:site_name" content="The Art of Data Visualization with ggplot2">
<meta property="og:image:alt" content="시간에 따른 후보자 득표 수를 보여주는 산점도로, 선거가 2년마다 실시되며 시간이 지나도 큰 변화가 없음을 분명히 알 수 있습니다.">
<meta property="og:image:height" content="1200">
<meta property="og:image:width" content="1500">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./spatial.html">공간 데이터 시각화</a></li><li class="breadcrumb-item"><a href="./us-elections.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">미국 하원 선거: <strong><code>geofacet</code></strong>을 이용한 그리드 위의 지리</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The Art of Data Visualization with ggplot2</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서문</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./author.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">저자</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">소개</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./common-charts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">일반적인 차트도 지루할 필요는 없습니다!</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programming-languages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">프로그래밍 언어: <strong><code>ggplot2</code></strong>를 이용한 덤벨 차트</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./museums.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">영국 박물관: <strong><code>gghighlight</code></strong>로 선형 차트 강조하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bee-colonies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">꿀벌 군집 손실:푸아송 디스크 샘플링으로 수량 시각화</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./animal-intakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">동물 보호소 입소: <strong><code>ggforce</code></strong>를 사용한 게이지 차트 만들기</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">아이콘, 글꼴 및 텍스트 활용</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wind-turbines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">캐나다 풍력 터빈: 와플 차트와 픽토그램</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">고양이: <strong><code>ggtext</code></strong>를 사용한 데이터 기반 주석</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nobel-laureates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">노벨상 수상자: 텍스트 배치 및 플롯 매개변수화</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./images.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">이미지 작업</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lemurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">여우원숭이: R에서 이미지 조작하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">R 패키지: 사용자 지정 패면 레이블에 이미지 사용하기</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">공간 데이터 시각화</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./doctors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">전 세계 의사 분포: <strong><code>ggplot2</code></strong>로 지도 만들기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-zones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">시간대: <strong><code>sf</code></strong>를 사용한 공간 데이터 및 매핑</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./us-elections.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">미국 하원 선거: <strong><code>geofacet</code></strong>을 이용한 그리드 위의 지리</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-tricks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">기타 팁과 요령</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliography</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">부록</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0" id="toc-데이터" class="nav-link active" data-scroll-target="#%EB%8D%B0%EC%9D%B4%ED%84%B0"><span class="header-section-number">13.1</span> 데이터</a></li>
  <li>
<a href="#%ED%83%90%EC%83%89-%EC%9E%91%EC%97%85" id="toc-탐색-작업" class="nav-link" data-scroll-target="#%ED%83%90%EC%83%89-%EC%9E%91%EC%97%85"><span class="header-section-number">13.2</span> 탐색 작업</a>
  <ul class="collapse">
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%90%EC%83%89" id="toc-데이터-탐색" class="nav-link" data-scroll-target="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%90%EC%83%89"><span class="header-section-number">13.2.1</span> 데이터 탐색</a></li>
  <li><a href="#%ED%83%90%EC%83%89%EC%A0%81-%EC%8A%A4%EC%BC%80%EC%B9%98" id="toc-탐색적-스케치" class="nav-link" data-scroll-target="#%ED%83%90%EC%83%89%EC%A0%81-%EC%8A%A4%EC%BC%80%EC%B9%98"><span class="header-section-number">13.2.2</span> 탐색적 스케치</a></li>
  </ul>
</li>
  <li>
<a href="#%ED%94%8C%EB%A1%AF-%EC%A4%80%EB%B9%84" id="toc-플롯-준비" class="nav-link" data-scroll-target="#%ED%94%8C%EB%A1%AF-%EC%A4%80%EB%B9%84"><span class="header-section-number">13.3</span> 플롯 준비</a>
  <ul class="collapse">
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%9E%AD%EA%B8%80%EB%A7%81" id="toc-데이터-랭글링" class="nav-link" data-scroll-target="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%9E%AD%EA%B8%80%EB%A7%81"><span class="header-section-number">13.3.1</span> 데이터 랭글링</a></li>
  <li><a href="#%EC%B2%AB-%EB%B2%88%EC%A7%B8-%ED%94%8C%EB%A1%AF" id="toc-첫-번째-플롯" class="nav-link" data-scroll-target="#%EC%B2%AB-%EB%B2%88%EC%A7%B8-%ED%94%8C%EB%A1%AF"><span class="header-section-number">13.3.2</span> 첫 번째 플롯</a></li>
  <li><a href="#geofacet%EC%9C%BC%EB%A1%9C-%ED%8C%A8%EC%8B%AF%ED%95%98%EA%B8%B0" id="toc-geofacet으로-패싯하기" class="nav-link" data-scroll-target="#geofacet%EC%9C%BC%EB%A1%9C-%ED%8C%A8%EC%8B%AF%ED%95%98%EA%B8%B0"><span class="header-section-number">13.3.3</span> <strong><code>geofacet</code></strong>으로 패싯하기</a></li>
  </ul>
</li>
  <li>
<a href="#%EA%B3%A0%EA%B8%89-%EC%8A%A4%ED%83%80%EC%9D%BC%EB%A7%81" id="toc-고급-스타일링" class="nav-link" data-scroll-target="#%EA%B3%A0%EA%B8%89-%EC%8A%A4%ED%83%80%EC%9D%BC%EB%A7%81"><span class="header-section-number">13.4</span> 고급 스타일링</a>
  <ul class="collapse">
<li><a href="#%EC%83%89%EC%83%81" id="toc-색상" class="nav-link" data-scroll-target="#%EC%83%89%EC%83%81"><span class="header-section-number">13.4.1</span> 색상</a></li>
  <li><a href="#%ED%85%8D%EC%8A%A4%ED%8A%B8-%EB%B0%8F-%EA%B8%80%EA%BC%B4" id="toc-텍스트-및-글꼴" class="nav-link" data-scroll-target="#%ED%85%8D%EC%8A%A4%ED%8A%B8-%EB%B0%8F-%EA%B8%80%EA%BC%B4"><span class="header-section-number">13.4.2</span> 텍스트 및 글꼴</a></li>
  <li><a href="#%ED%85%8C%EB%A7%88-%EC%A1%B0%EC%A0%95" id="toc-테마-조정" class="nav-link" data-scroll-target="#%ED%85%8C%EB%A7%88-%EC%A1%B0%EC%A0%95"><span class="header-section-number">13.4.3</span> 테마 조정</a></li>
  <li><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%A0%95%EC%9D%98-%EB%B2%94%EB%A1%80-%EA%B0%9C%EB%B0%9C" id="toc-사용자-정의-범례-개발" class="nav-link" data-scroll-target="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%A0%95%EC%9D%98-%EB%B2%94%EB%A1%80-%EA%B0%9C%EB%B0%9C"><span class="header-section-number">13.4.4</span> 사용자 정의 범례 개발</a></li>
  <li><a href="#patchwork%EB%A1%9C-%EA%B2%B0%ED%95%A9%ED%95%98%EA%B8%B0" id="toc-patchwork로-결합하기" class="nav-link" data-scroll-target="#patchwork%EB%A1%9C-%EA%B2%B0%ED%95%A9%ED%95%98%EA%B8%B0"><span class="header-section-number">13.4.5</span> <strong><code>patchwork</code></strong>로 결합하기</a></li>
  </ul>
</li>
  <li><a href="#%ED%9A%8C%EA%B3%A0" id="toc-회고" class="nav-link" data-scroll-target="#%ED%9A%8C%EA%B3%A0"><span class="header-section-number">13.5</span> 회고</a></li>
  <li><a href="#%EC%97%B0%EC%8A%B5-%EB%AC%B8%EC%A0%9C" id="toc-연습-문제" class="nav-link" data-scroll-target="#%EC%97%B0%EC%8A%B5-%EB%AC%B8%EC%A0%9C"><span class="header-section-number">13.6</span> 연습 문제</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./spatial.html">공간 데이터 시각화</a></li><li class="breadcrumb-item"><a href="./us-elections.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">미국 하원 선거: <strong><code>geofacet</code></strong>을 이용한 그리드 위의 지리</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-house" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">미국 하원 선거: <strong><code>geofacet</code></strong>을 이용한 그리드 위의 지리</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>이 장에서는 <strong><code>geofacet</code></strong>을 사용하여 지리적 영역과 유사한 그리드에 패싯 플롯을 배열하는 방법을 배우고, 사용자 정의 범례를 만드는 또 다른 접근 방식을 살펴봅니다. </p>
<p>이 장을 마치면 다음을 할 수 있습니다:</p>
<ul>
<li>미국 주 수준 데이터의 작은 다중 플롯(small multiple plots)을 주(state)의 기본 지리를 반영하는 그리드에 배열합니다;</li>
<li>패싯 레이블을 더 크고 반투명한 사용자 정의 주석으로 대체합니다;</li>
<li>더 미니멀한 작은 다중 플롯을 위해 확대된 <em>이 플롯을 읽는 방법</em> 범례를 만듭니다.</li>
</ul>
<p>이 장에서 필요한 패키지를 로드하는 것으로 시작합니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hafen/geofacet">geofacet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggtext/">ggtext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/">glue</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yixuan/showtext">showtext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yixuan/sysfonts">sysfonts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dslc-io.github.io/tidytuesdayR/">tidytuesdayR</a></span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이 장에서는 지리적 영역의 모양으로 플롯 그리드를 배열하는 데 사용되는 <strong><code>geofacet</code></strong>이라는 새로운 패키지를 하나만 소개합니다. 이 패키지에는 다양한 국가 및 지역에 대한 미리 정의된 그리드가 많이 포함되어 있지만 자신만의 사용자 정의 그리드를 만들 수도 있습니다. </p>
<section id="데이터" class="level2" data-number="13.1"><h2 data-number="13.1" class="anchored" data-anchor-id="데이터">
<span class="header-section-number">13.1</span> 데이터</h2>
<p>MIT Election Data and Science Lab은 미국 민주주의를 개선하기 위해 미국 선거에 대한 데이터와 결과를 수집, 분석 및 공유합니다. 여기에는 선거구 수준의 미국 하원 선거에 대한 데이터가 포함됩니다 <span class="citation" data-cites="elections_data">(<a href="references.html#ref-elections_data" role="doc-biblioref">MIT Election Data and Science Lab 2017</a>)</span>. 데이터는 정기적으로 업데이트되며, 1976년부터 2022년까지의 선거 정보가 포함된 이 데이터 세트 버전은 <a href="https://github.com/rfordatascience/tidytuesday/tree/main/data/2023/2023-11-07">2023년 11월 TidyTuesday 데이터 세트</a>로 사용되었습니다. <strong><code>tidytuesdayR</code></strong>의 <code><a href="https://dslc-io.github.io/tidytuesdayR/reference/tt_load.html">tt_load()</a></code> 함수를 사용하여 데이터를 다시 로드할 수 있습니다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tuesdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dslc-io.github.io/tidytuesdayR/reference/tt_load.html">tt_load</a></span><span class="op">(</span><span class="st">"2023-11-07"</span><span class="op">)</span></span>
<span><span class="va">house</span> <span class="op">&lt;-</span> <span class="va">tuesdata</span><span class="op">$</span><span class="va">house</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>데이터에는 32452개의 행과 20개의 열이 있습니다. <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>(또는 선호하는 경우 <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code>)를 사용하여 데이터의 처음 몇 행을 살펴봅시다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">house</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 6 × 20
   year state  state_po state_fips state_cen state_ic office
  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; 
1  1976 ALABA… AL                1        63       41 US HO…
2  1976 ALABA… AL                1        63       41 US HO…
3  1976 ALABA… AL                1        63       41 US HO…
4  1976 ALABA… AL                1        63       41 US HO…
5  1976 ALABA… AL                1        63       41 US HO…
6  1976 ALABA… AL                1        63       41 US HO…
# ℹ 13 more variables: district &lt;chr&gt;, stage &lt;chr&gt;,
#   runoff &lt;lgl&gt;, special &lt;lgl&gt;, candidate &lt;chr&gt;,
#   party &lt;chr&gt;, writein &lt;lgl&gt;, mode &lt;chr&gt;,
#   candidatevotes &lt;dbl&gt;, totalvotes &lt;dbl&gt;,
#   unofficial &lt;lgl&gt;, version &lt;dbl&gt;, fusion_ticket &lt;lgl&gt;</code></pre>
</div>
</div>
<p>많은 <code>state</code> 열이 있으며, 본질적으로 다른 형식으로 유사한 정보를 제공합니다. 예를 들어 <code>state</code> 열은 주 이름을 제공하고 <code>state_po</code> 열은 주의 두 글자 약어를 제공합니다. 또한 주 내의 선거구(지구)를 식별하는 열도 있습니다. 데이터는 후보자에 대한 정보(이름, 소속 정당, 출마한 선거에서 받은 득표 수)를 제공합니다. 다른 열은 총 투표 수, 선거 단계, 재보궐 선거 여부, 결선 투표 여부 등 선거에 대한 정보를 제공합니다. <code>version</code> 열에는 데이터의 릴리스 버전을 식별하는 데이터가 포함되어 있습니다.</p>
</section><section id="탐색-작업" class="level2" data-number="13.2"><h2 data-number="13.2" class="anchored" data-anchor-id="탐색-작업">
<span class="header-section-number">13.2</span> 탐색 작업</h2>
<p><code>house</code> 데이터는 매우 세분화되어 있어 하나의 차트에 모든 정보를 시각화하기는 어렵습니다. 따라서 데이터를 하위 집합화하거나 집계하는 다양한 방법을 생각해 볼 수 있습니다. 다음에 초점을 맞출 수 있습니다:</p>
<ul>
<li><p>주: 특정 주 내의 투표 패턴을 살펴보거나 선거구 수준 대신 주 수준 데이터를 살펴보도록 집계할 수 있습니다.</p></li>
<li><p>정당: 후보자가 여러 정당을 대변하는 퓨전 티켓(fusion tickets)에 대한 데이터를 포함하여 각 후보자가 어느 정당에 출마했는지에 대한 정보가 있습니다.</p></li>
<li><p>시간: 데이터는 1976년부터 2022년까지 제공되며, 시간 경과에 따른 득표율 또는 득표 수 추세를 살펴볼 수 있습니다.</p></li>
</ul>
<section id="데이터-탐색" class="level3" data-number="13.2.1"><h3 data-number="13.2.1" class="anchored" data-anchor-id="데이터-탐색">
<span class="header-section-number">13.2.1</span> 데이터 탐색</h3>
<p>시간이 지남에 따라 투표 수가 변경되었는지 여부를 간략하게 살펴보는 것으로 시작하겠습니다. 데이터는 1976년으로 거슬러 올라가며 미국의 인구는 1970년과 2020년 인구 조사 사이에 150% 이상 증가했으므로 <span class="citation" data-cites="UScensuspop">(<a href="references.html#ref-UScensuspop" role="doc-biblioref">United States Census Bureau 2021a</a>)</span> 투표 수에서도 비슷한 증가를 예상할 수 있을까요? <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>으로 만든 빠른 산점도로 시간 경과에 따른 후보자 투표 수를 살펴보는 것으로 시작하겠습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">house</span><span class="op">$</span><span class="va">year</span>,</span>
<span>  y <span class="op">=</span> <span class="va">house</span><span class="op">$</span><span class="va">candidatevotes</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"후보자 득표 수"</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-elections-scatterplot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="시간에 따른 후보자 득표 수를 보여주는 산점도로, 선거가 2년마다 실시되며 시간이 지나도 큰 변화가 없음을 분명히 알 수 있습니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elections-scatterplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="us-elections_files/figure-html/fig-elections-scatterplot-1.png" class="img-fluid figure-img" alt="시간에 따른 후보자 득표 수를 보여주는 산점도로, 선거가 2년마다 실시되며 시간이 지나도 큰 변화가 없음을 분명히 알 수 있습니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elections-scatterplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.1: 시간에 따른 후보자 득표 수를 보여주는 산점도로, 선거가 2년마다 실시되며 시간이 지나도 큰 변화가 없음을 분명히 알 수 있습니다.
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-elections-scatterplot" class="quarto-xref">Figure&nbsp;<span>13.1</span></a> 의 시간 경과에 따른 투표 수에는 적어도 언뜻 보기에는 특별히 흥미로운 패턴이 없는 것 같습니다. 그러나 잠재적인 데이터 문제를 강조했습니다. 대부분의 연도에서 가장 높은 값은 약 300,000이지만 2022년에는 1,000,000이 넘는 두 개의 관측치가 있습니다. <a href="bee-colonies.html" class="quarto-xref"><span>Chapter 4</span></a> 에서도 비슷한 문제가 있었는데, 일부 관측치가 다른 관측치의 합계였습니다. 여기서는 그런 것 같지 않습니다. 지금은 이들을 제외하고 후보자 투표 수가 600,000 미만인 데이터를 살펴봅시다.</p>
<p>또한 정당별로 후보자 투표 수가 어떻게 다른지 관심이 있을 수 있으며 <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> 함수를 사용하여 큰 차이가 있는지 알아볼 수 있습니다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span></span>
<span>  <span class="va">candidatevotes</span> <span class="op">~</span> <span class="va">party</span>,</span>
<span>  data <span class="op">=</span> <span class="va">house</span><span class="op">[</span><span class="va">house</span><span class="op">$</span><span class="va">candidatevotes</span> <span class="op">&lt;</span> <span class="fl">600000</span>, <span class="op">]</span>,</span>
<span>  horizontal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  las <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"후보자 득표 수"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-elections-boxplot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="각 정당의 후보자 득표 수를 보여주는 상자 그림으로, 고유한 정당 수가 많기 때문에(득표 수가 적음) 많은 정당 레이블이 숨겨져 있습니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elections-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="us-elections_files/figure-html/fig-elections-boxplot-1.png" class="img-fluid figure-img" alt="각 정당의 후보자 득표 수를 보여주는 상자 그림으로, 고유한 정당 수가 많기 때문에(득표 수가 적음) 많은 정당 레이블이 숨겨져 있습니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elections-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.2: 각 정당의 후보자 득표 수를 보여주는 상자 그림으로, 고유한 정당 수가 많기 때문에(득표 수가 적음) 많은 정당 레이블이 숨겨져 있습니다.
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-elections-boxplot" class="quarto-xref">Figure&nbsp;<span>13.2</span></a> 에는 주목할 만한 몇 가지 흥미로운 점이 있습니다. 첫째, 모든 무소속 후보가 다른 정당 이름으로 나열되기 때문에 고유한 <code>party</code> 이름이 매우 많습니다. 즉, 모든 정당 이름을 차트에서 실제로 읽을 수는 없습니다. 둘째, 데이터에 표시된 이상값이 많아 데이터가 매우 치우쳐 있습니다. 마지막으로, 다른 정당보다 득표 수가 훨씬 많은 두 정당이 있습니다. 데이터를 조사하면 짐작할 수 있듯이 민주당과 공화당임을 알 수 있습니다.</p>
</section><section id="탐색적-스케치" class="level3" data-number="13.2.2"><h3 data-number="13.2.2" class="anchored" data-anchor-id="탐색적-스케치">
<span class="header-section-number">13.2.2</span> 탐색적 스케치</h3>
<p>이 기간 동안 민주당과 공화당이 선거를 지배했습니다. 숫자가 너무 적기 때문에 개별 무소속 후보에 대한 신뢰할 수 있는 통찰력을 도출할 수 없을 것이므로 다른 모든 정당 후보를 <em>기타(other)</em> 범주로 묶어 봅시다. <a href="#fig-elections-scatterplot" class="quarto-xref">Figure&nbsp;<span>13.1</span></a> 과 <a href="#fig-elections-boxplot" class="quarto-xref">Figure&nbsp;<span>13.2</span></a> 을 결합하고 각 주에 대한 정보와 함께 시간과 공간에 따른 주요 정당의 득표율 변화 패턴이 있는지 살펴볼 수 있습니다.</p>
<p>민주당, 공화당 및 기타 정당의 득표율을 보여주는 주별로 패싯된 영역 차트(area chart)를 만드는 것을 고려할 수 있습니다. 지리적으로 가까운 주는 유사한 패턴을 보일 가능성이 더 큽니다. 패싯된 영역 차트를 직사각형 그리드에 배열하는 대신 지리적 위치를 기반으로 배열하는 것이 더 합리적일 것입니다. 이렇게 하면 주 간의 패턴을 더 쉽게 비교할 수 있습니다. <a href="#fig-elections-sketch" class="quarto-xref">Figure&nbsp;<span>13.3</span></a> 는 이것이 어떤 모습일지 보여주는 예입니다:</p>
<div id="fig-elections-sketch" class="quarto-float quarto-figure quarto-figure-center anchored" alt="미국 모양의 그리드에 배열된 패싯 영역 차트의 초기 스케치." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elections-sketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/sketch-elections.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="미국 모양의 그리드에 배열된 패싯 영역 차트의 초기 스케치.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elections-sketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.3: 미국 모양의 그리드에 배열된 패싯 영역 차트의 초기 스케치.
</figcaption></figure>
</div>
<p>종종 패싯 차트에서는 x축과 y축이 여러 번 표시됩니다. 이로 인해 차트가 특히 이러한 지리적 레이아웃을 사용할 때 지나치게 <em>복잡해(busy)</em> 보일 수 있습니다. <a href="wind-turbines.html" class="quarto-xref"><span>Chapter 6</span></a> 및 <a href="lemurs.html" class="quarto-xref"><span>Chapter 9</span></a> 에서 했던 것처럼 매우 미니멀한 패싯 차트 세트를 만들고 색상 텍스트를 범례로 사용할 수 있습니다. 미니멀한 접근 방식이 더 깔끔해 보일 수 있지만 차트에 무엇이 표시되어 있는지 명확하지 않을 수도 있습니다. 패싯 플롯 중 하나의 확대 버전으로 만든 <em>이 차트를 읽는 방법</em> 설명자를 범례로 추가해 봅시다: </p>
<div id="fig-elections-sketch-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="미국 모양의 그리드에 배열된 패싯 영역 차트의 초기 스케치. 영역 차트 하나의 확대 버전이 왼쪽의 범례로 사용됩니다." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elections-sketch-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/sketch-elections-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="미국 모양의 그리드에 배열된 패싯 영역 차트의 초기 스케치. 영역 차트 하나의 확대 버전이 왼쪽의 범례로 사용됩니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elections-sketch-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.4: 미국 모양의 그리드에 배열된 패싯 영역 차트의 초기 스케치. 영역 차트 하나의 확대 버전이 왼쪽의 범례로 사용됩니다.
</figcaption></figure>
</div>
</section></section><section id="플롯-준비" class="level2" data-number="13.3"><h2 data-number="13.3" class="anchored" data-anchor-id="플롯-준비">
<span class="header-section-number">13.3</span> 플롯 준비</h2>
<p><a href="#fig-elections-sketch-2" class="quarto-xref">Figure&nbsp;<span>13.4</span></a> 를 구현하려면 <em>기타</em> 정당을 집계하고 정당, 연도 및 주별로 투표 수를 계산하는 것으로 시작해야 합니다.</p>
<section id="데이터-랭글링" class="level3" data-number="13.3.1"><h3 data-number="13.3.1" class="anchored" data-anchor-id="데이터-랭글링">
<span class="header-section-number">13.3.1</span> 데이터 랭글링</h3>
<p><em>기타</em> 정당을 집계하기 위해 <strong><code>dplyr</code></strong>의 <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>를 사용하여 기존 <code>party</code> 열을 업데이트합니다. <code><a href="https://dplyr.tidyverse.org/reference/case-and-replace-when.html">case_when()</a></code>을 사용하여 새로운 정당 범주를 만들고 두 주요 정당에 대해 약간 더 나은 대체 레이블을 제공할 기회를 잡습니다. </p>
<p><code>stage</code> 열에는 선거가 총선(<code>"GEN"</code>)인지 예비 선거(<code>"PRI"</code>)인지에 대한 정보가 포함되어 있습니다. 내용을 단순하게 유지하기 위해 <strong><code>dplyr</code></strong>의 <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>를 사용하여 데이터를 총선으로만 제한합니다. 그런 다음 <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> 및 <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>를 사용하여 각 연도, 주 및 정당 범주의 투표 수를 합산합니다. 마지막에는 데이터의 그룹 해제(<code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code>)를 기억하십시오! </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">house_data</span> <span class="op">&lt;-</span> <span class="va">house</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>party <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case-and-replace-when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">party</span> <span class="op">==</span> <span class="st">"REPUBLICAN"</span> <span class="op">~</span> <span class="st">"공화당"</span>,</span>
<span>    <span class="va">party</span> <span class="op">==</span> <span class="st">"DEMOCRAT"</span> <span class="op">~</span> <span class="st">"민주당"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"기타"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">stage</span> <span class="op">==</span> <span class="st">"GEN"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">state_po</span>, <span class="va">party</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>votes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">candidatevotes</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>일부 주에서는 <code>"other"</code> 후보가 없는 연도가 있으므로 이러한 값에 대한 행이 없습니다. 즉, 암시적으로 누락된 것입니다. <a href="r-packages.html" class="quarto-xref"><span>Chapter 10</span></a> 에서 보았듯이 이로 인해 오해의 소지가 있는 영역 차트가 생성되고 <strong><code>ggplot2</code></strong>에서 경고가 발생할 수 있습니다. <a href="r-packages.html" class="quarto-xref"><span>Chapter 10</span></a> 에서와 같이 이러한 <em>누락된</em> 값은 실제로 누락된 것이 아니라 단순히 0입니다. 이전에 했던 것처럼 <strong><code>tidyr</code></strong>의 <code><a href="https://tidyr.tidyverse.org/reference/complete.html">complete()</a></code>를 사용하여 <code>year</code>, <code>state_po</code> 및 <code>party</code>의 모든 조합이 데이터에 존재하도록 하고 <em>누락된</em> 조합을 명시적으로 0으로 설정합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">house_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html">complete</a></span><span class="op">(</span></span>
<span>    <span class="va">year</span>, <span class="va">state_po</span>, <span class="va">party</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>votes <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="첫-번째-플롯" class="level3" data-number="13.3.2"><h3 data-number="13.3.2" class="anchored" data-anchor-id="첫-번째-플롯">
<span class="header-section-number">13.3.2</span> 첫 번째 플롯</h3>
<p><a href="programming-languages.html" class="quarto-xref"><span>Chapter 2</span></a>, <a href="museums.html" class="quarto-xref"><span>Chapter 3</span></a>, 및 <a href="animal-intakes.html" class="quarto-xref"><span>Chapter 5</span></a> 에서 했던 것처럼 다시 패싯 플롯을 만들 것입니다. 이 플롯에는 두 가지 주요 차이점이 있습니다:</p>
<ul>
<li>플롯을 지정된 수의 행과 열이 있는 직사각형 모양으로 배열하는 대신 기본 지리(geography)와 유사한 방식으로 플롯을 배열하려고 합니다.</li>
<li>이전에 만든 플롯(대부분 10개 미만)에 비해 훨씬 더 많은 패싯(50개 이상)이 있습니다. 때로는 많은 수의 패싯을 만드는 것이 느릴 수 있습니다.</li>
</ul>
<p>두 번째 문제 때문에 패싯 플롯을 개발할 때, 특히 대규모 데이터나 복잡한 시각화를 사용할 때 단일 플롯을 먼저 만드는 것이 유용할 수 있습니다. 즉, 데이터를 필터링하고 패싯 범주의 한 수준에 대해서만 차트를 만듭니다. 이렇게 하면 패싯 레이아웃에 대해 걱정하기 전에 차트의 기본 사항을 올바르게 설정할 수 있습니다.</p>
<p>캘리포니아로만 데이터를 하위 집합화하는 <strong><code>dplyr</code></strong>의 <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> 함수로 감싼 <code>plot_data</code>를 <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>의 <code>data</code> 인수에 전달하는 것으로 시작합니다. 정당별로 나누어 x축에는 연도를, y축에는 득표 수를 플롯하도록 미적 매핑을 설정합니다. </p>
<p><a href="museums.html" class="quarto-xref"><span>Chapter 3</span></a> 및 <a href="r-packages.html" class="quarto-xref"><span>Chapter 10</span></a> 에서 영역 차트를 만드는 예를 이미 보았지만 이 장에서는 약간의 변경을 줄 것입니다. 주(각각 인구 규모가 매우 다르므로 득표 수가 매우 다름)를 비교할 것이므로 득표 수의 영역 차트를 고려하는 대신 각 정당의 비율을 살펴볼 것입니다. 다행히도 <code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area()</a></code> 내부에서 <code>position = "fill"</code>을 설정하면 이 작업이 수행되므로 이러한 백분율을 직접 계산할 필요가 없습니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">basic_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="va">state_po</span> <span class="op">==</span> <span class="st">"CA"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">votes</span>, fill <span class="op">=</span> <span class="va">party</span></span>
<span>    <span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="st">"fill"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">basic_plot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-elections-single-plot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="캘리포니아의 다양한 정당 범주에 대한 득표율을 보여주는 영역 차트. 기본 색상, 스타일 및 범례가 적용되었습니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elections-single-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="us-elections_files/figure-html/fig-elections-single-plot-1.png" class="img-fluid figure-img" alt="캘리포니아의 다양한 정당 범주에 대한 득표율을 보여주는 영역 차트. 기본 색상, 스타일 및 범례가 적용되었습니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elections-single-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.5: 캘리포니아의 다양한 정당 범주에 대한 득표율을 보여주는 영역 차트. 기본 색상, 스타일 및 범례가 적용되었습니다.
</figcaption></figure>
</div>
</div>
</div>
<p>이제 패싯 값 중 하나에 대한 기본 플롯이 생겼습니다.</p>
<div id="tip-elections-piping" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;13.1: 데이터를 <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>으로 파이핑하기
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>ggplot</code>의 첫 번째 인수는 <code>data</code>이므로 데이터를 첫 번째 인수로 명시적으로 명시하는 대신 <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> 함수로 파이핑할 수 있다는 의미입니다. 예를 들어 위의 코드는 다음과 같이 다시 쓸 수 있습니다:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">state_po</span> <span class="op">==</span> <span class="st">"CA"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">votes</span>, fill <span class="op">=</span> <span class="va">party</span></span>
<span>    <span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="st">"fill"</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이것은 <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> 내부에 <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>를 중첩하는 것보다 더 깔끔해 보일 수 있지만, 두 가지 이유로 <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>으로 파이핑하는 다른 예를 볼 가능성은 낮습니다:</p>
<ul>
<li>
<code>+</code>와 <code>|&gt;</code>의 조합은 이상하게 보이며, 파이핑으로 인한 깔끔함보다 더 큽니다(개인적인 의견).</li>
<li>매우 길고 복잡한 코드로 끝나는 것이 더 쉬워집니다. 데이터 랭글링과 플롯 코드를 분리하는 것이 종종 더 합리적입니다.</li>
</ul>
</div>
</div>
<p>이제 전체 데이터를 <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>에 전달(캘리포니아 하위 집합이 아님)하고 <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>을 추가하여 <code>state_po</code>의 각 값에 대한 영역 차트를 만들 수 있습니다. </p>
<div class="cell" data-source-line-numbers="2,11">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11" data-source-line-numbers="2,11" data-code-line-numbers="2,11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">basic_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">plot_data</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">votes</span>, fill <span class="op">=</span> <span class="va">party</span></span>
<span>    <span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="st">"fill"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">basic_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">state_po</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-elections-basic-plot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="직사각형 그리드 모양으로 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 패싯 레이블의 크기로 인해 영역 차트를 볼 수 없습니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elections-basic-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="us-elections_files/figure-html/fig-elections-basic-plot-1.png" class="img-fluid figure-img" alt="직사각형 그리드 모양으로 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 패싯 레이블의 크기로 인해 영역 차트를 볼 수 없습니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elections-basic-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.6: 직사각형 그리드 모양으로 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 패싯 레이블의 크기로 인해 영역 차트를 볼 수 없습니다.
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-elections-basic-plot" class="quarto-xref">Figure&nbsp;<span>13.6</span></a> 에서는 실제로 영역 차트를 볼 수 없고 패싯 레이블만 볼 수 있습니다. 이는 패싯 범주의 수가 많고 차트 크기가 작을 때 매우 일반적인 문제입니다. 플롯 테마를 조정할 때 이 문제를 조금 더 다룰 것입니다.</p>
</section><section id="geofacet으로-패싯하기" class="level3" data-number="13.3.3"><h3 data-number="13.3.3" class="anchored" data-anchor-id="geofacet으로-패싯하기">
<span class="header-section-number">13.3.3</span> <strong><code>geofacet</code></strong>으로 패싯하기</h3>
<p>패싯 플롯을 기본 지리와 유사한 그리드로 배열하기 위해 <strong><code>geofacet</code></strong> 패키 <span class="citation" data-cites="geofacet">(<a href="references.html#ref-geofacet" role="doc-biblioref">Hafen 2023</a>)</span>를 사용합니다. <strong><code>geofacet</code></strong> 패키지를 사용하면 패싯을 지도 모양으로 쉽게 배열할 수 있습니다. 이를 통해 주나 국가와 같은 지역의 데이터를 그리드 형식으로 더 쉽게 비교할 수 있습니다. 미국을 위한 여러 그리드를 포함하여 다양한 지리적 지역에 대한 내장 그리드가 많이 있습니다. 그러나 다른 레이아웃을 선호하거나 플롯하려는 지역에 대한 그리드가 없는 경우 자신만의 사용자 정의 패싯 그리드를 만들 수도 있습니다.</p>
<p><strong><code>geofacet</code></strong>으로 패싯을 수행하려면 <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> 대신 <code><a href="https://hafen.github.io/geofacet/reference/facet_geo.html">facet_geo()</a></code>를 사용합니다. 기본적으로 같은 방식으로 작동하며 <code>~</code>를 사용하여 패싯 컬럼을 지정하는 것으로 시작합니다. 그러나 약간 다른 점이 두 가지 있습니다: </p>
<ul>
<li><p>어떤 그리드 레이아웃을 사용할지 지정해야 합니다. <strong><code>geofacet</code></strong>의 <code><a href="https://hafen.github.io/geofacet/reference/get_grid_names.html">get_grid_names()</a></code> 함수를 사용하여 유효한 모든 그리드 이름 목록을 얻을 수 있습니다. 그리드 이름은 그리드가 어떤 지역에 대한 것인지에 따라 합리적으로 지정됩니다. 예를 들어 <code>"us_state_grid1"</code> 및 <code>"eu_grid1"</code>입니다. 여기서는 <code>"us_state_grid2"</code>를 사용합니다.</p></li>
<li><p>데이터를 그리드의 올바른 패싯 위치에 매핑하려면 데이터의 열 중 하나가 선택한 그리드의 <code>code</code> 열에 있는 값과 일치해야 합니다. <code>"us_state_grid2"</code> 그리드에서 <code>code</code> 열에는 데이터의 <code>state_po</code> 열과 일치하는 두 글자 주 약어가 포함되어 있습니다. 두 글자 약어가 없는 경우 이를 첨부하기 위해 데이터 결합을 수행해야 할 수도 있습니다.</p></li>
</ul>
<p>추가 <em>주</em>(예: 푸에르토리코는 주가 아니더라도 미국 주 열에 나열될 수 있음)가 있거나 일부 주가 누락된 경우에도 <code><a href="https://hafen.github.io/geofacet/reference/facet_geo.html">facet_geo()</a></code>를 사용할 수 있습니다. 그러나 패싯 그리드에 나열된 주만 플롯하고 경고 메시지를 받을 수 있습니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">map_plot</span> <span class="op">&lt;-</span> <span class="va">basic_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://hafen.github.io/geofacet/reference/facet_geo.html">facet_geo</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">state_po</span>,</span>
<span>    grid <span class="op">=</span> <span class="st">"us_state_grid2"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">map_plot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-elections-geofacet-plot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="미국 모양의 그리드에 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 패싯 레이블의 크기로 인해 영역 차트를 볼 수 없습니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elections-geofacet-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="us-elections_files/figure-html/fig-elections-geofacet-plot-1.png" class="img-fluid figure-img" alt="미국 모양의 그리드에 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 패싯 레이블의 크기로 인해 영역 차트를 볼 수 없습니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elections-geofacet-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.7: 미국 모양의 그리드에 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 패싯 레이블의 크기로 인해 영역 차트를 볼 수 없습니다.
</figcaption></figure>
</div>
</div>
</div>
<p>여전히 차트의 세부 정보를 볼 수 없다는 동일한 문제가 있지만 패싯 제목만 봐도 플롯이 이제 미국과 유사한 그리드에 배열되어 있음을 알 수 있습니다.</p>
</section></section><section id="고급-스타일링" class="level2" data-number="13.4"><h2 data-number="13.4" class="anchored" data-anchor-id="고급-스타일링">
<span class="header-section-number">13.4</span> 고급 스타일링</h2>
<p>이제 더 직관적인 색상을 적용하고, 차트를 더 쉽게 볼 수 있도록 패싯 레이블을 조정하고, 이 차트를 읽는 방법을 설명하는 사용자 정의 범례를 만들도록 차트 스타일을 지정합니다.</p>
<section id="색상" class="level3" data-number="13.4.1"><h3 data-number="13.4.1" class="anchored" data-anchor-id="색상">
<span class="header-section-number">13.4.1</span> 색상</h3>
<p>미국에서 공화당은 빨간색으로, 민주당은 파란색으로 표시됩니다. <a href="lemurs.html" class="quarto-xref"><span>Chapter 9</span></a> 에서 논의했듯이 잘 알려진 범주에 사용할 색상을 선택할 때 부정적인 고정 관념(예: 여자는 분홍색)을 재생산하지 않는 것이 중요합니다. 그러나 직관적인 것을 사용하는 것도 중요합니다. 이들은 정당이 자신을 나타내기 위해 선택한 색상이고 매우 잘 알려져 있으므로 빨간색과 파란색을 고수할 것입니다. </p>
<p>시각화가 이미 꽤 복잡하므로 배경색을 매우 단순하게 유지하여 흑백만 사용합니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">blue_col</span> <span class="op">&lt;-</span> <span class="st">"#0015BC"</span></span>
<span><span class="va">red_col</span> <span class="op">&lt;-</span> <span class="st">"#C41E3A"</span></span>
<span><span class="va">other_col</span> <span class="op">&lt;-</span> <span class="st">"#AAAAAA"</span></span>
<span><span class="va">text_col</span> <span class="op">&lt;-</span> <span class="st">"black"</span></span>
<span><span class="va">bg_col</span> <span class="op">&lt;-</span> <span class="st">"white"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>그런 다음 <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual()</a></code>을 사용하여 플롯에 색상을 적용하고 <code>values</code>의 관련 정당 레이블에 각 색상을 할당할 수 있습니다. 나중에 자체 범례를 만들 것이므로 <code>guide = "none"</code>을 설정하여 기본 범례를 제거합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">col_plot</span> <span class="op">&lt;-</span> <span class="va">map_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"민주당"</span> <span class="op">=</span> <span class="va">blue_col</span>,</span>
<span>      <span class="st">"공화당"</span> <span class="op">=</span> <span class="va">red_col</span>,</span>
<span>      <span class="st">"기타"</span> <span class="op">=</span> <span class="va">other_col</span></span>
<span>    <span class="op">)</span>,</span>
<span>    guide <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="텍스트-및-글꼴" class="level3" data-number="13.4.2"><h3 data-number="13.4.2" class="anchored" data-anchor-id="텍스트-및-글꼴">
<span class="header-section-number">13.4.2</span> 텍스트 및 글꼴</h3>
<p>이전 장에서와 같이 <strong><code>sysfonts</code></strong> 및 <strong><code>showtext</code></strong> 패키지를 사용하여 서체를 정의할 수 있습니다. 기본 글꼴의 경우 <a href="doctors.html" class="quarto-xref"><span>Chapter 11</span></a> 에서 했던 것처럼 <em>Roboto</em> 서체를 사용합니다. 제목 텍스트의 경우 20세기 중반 광고에 사용된 서체에서 영감을 받은 <a href="https://fonts.google.com/specimen/Carter+One">Vernon Adams가 디자인한 디스플레이 글꼴</a>인 <em>Carter One</em>을 사용합니다. 시각화 제목에 잘 어울리는 굵은 서체입니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add_google.html">font_add_google</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Roboto"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add_google.html">font_add_google</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Carter One"</span>, family <span class="op">=</span> <span class="st">"Carter"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add_google.html">font_add_google</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Noto Sans KR"</span>, family <span class="op">=</span> <span class="st">"noto_sans_kr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/showtext/man/showtext_auto.html">showtext_auto</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/showtext/man/showtext_opts.html">showtext_opts</a></span><span class="op">(</span>dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">body_font</span> <span class="op">&lt;-</span> <span class="st">"Roboto"</span></span>
<span><span class="va">title_font</span> <span class="op">&lt;-</span> <span class="st">"Carter"</span></span>
<span><span class="va">korean_font</span> <span class="op">&lt;-</span> <span class="st">"noto_sans_kr"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><a href="cats.html" class="quarto-xref"><span>Chapter 7</span></a> 와 <a href="lemurs.html" class="quarto-xref"><span>Chapter 9</span></a> 에서 했던 것처럼 색상 텍스트에 HTML 스타일링을 추가하기 위해 <code><a href="https://glue.tidyverse.org/reference/glue.html">glue()</a></code>를 사용하여 부제목에 대한 텍스트를 작성합니다. 색상 텍스트는 범례 역할을 하며(나중에 우리만의 사용자 정의 범례도 추가할 예정이지만), 부제목 텍스트는 차트가 보여주는 내용에 대한 정보를 제공합니다. 색상 텍스트는 읽기 쉽도록 굵은 텍스트로 서식을 지정합니다. <a href="time-zones.html" class="quarto-xref"><span>Chapter 12</span></a> 에서와 같이 데이터 소스에 대한 정보를 캡션이 아닌 부제목 끝줄에 추가합니다. 또한 <a href="time-zones.html" class="quarto-xref"><span>Chapter 12</span></a> 에서 했던 것처럼 텍스트 배치를 용이하게 하기 위해 제목 텍스트를 부제목 변수에 직접 추가합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"&lt;span style='font-size:10pt; font-family:{title_font}; color:{text_col};'&gt;미국 하원 선거 득표 현황&lt;/span&gt;&lt;br&gt;영역 차트는 1976년부터 2022년까지의 총선에서 &lt;span style='color:{blue_col};'&gt;**민주당**&lt;/span&gt;, &lt;span style='color:{red_col};'&gt;**공화당**&lt;/span&gt;, 및 &lt;span style='color:#aaaaaa;'&gt;**기타**&lt;/span&gt; 정당의 득표율을 나타냅니다.&lt;br&gt;&lt;br&gt;**데이터**: 미국 하원 1976–2022. MIT Election Data and Science Lab."</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><a href="cats.html" class="quarto-xref"><span>Chapter 7</span></a> 에서 정의한 <code>social_caption()</code> 함수도 사용하며, 나중에 플롯 캡션으로 추가할 것입니다: </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">social</span> <span class="op">&lt;-</span> <span class="fu">social_caption</span><span class="op">(</span></span>
<span>  icon_color <span class="op">=</span> <span class="va">blue_col</span>,</span>
<span>  font_color <span class="op">=</span> <span class="va">text_col</span>,</span>
<span>  font_family <span class="op">=</span> <span class="va">body_font</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>그런 다음 부제목과 캡션 텍스트를 <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> 함수에 전달하여 플롯에 추가합니다. 부제목 텍스트를 일반적이지 않은 위치에 배치하려고 하므로 <a href="time-zones.html" class="quarto-xref"><span>Chapter 12</span></a> 에서 했던 것과 유사하게 <code>subtitle</code>보다는 <code>tag</code> 인수를 사용합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">text_plot</span> <span class="op">&lt;-</span> <span class="va">col_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    tag <span class="op">=</span> <span class="va">st</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">social</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="테마-조정" class="level3" data-number="13.4.3"><h3 data-number="13.4.3" class="anchored" data-anchor-id="테마-조정">
<span class="header-section-number">13.4.3</span> 테마 조정</h3>
<p><a href="#fig-elections-geofacet-plot" class="quarto-xref">Figure&nbsp;<span>13.7</span></a> 에서 볼 수 있듯이 패싯 레이블이 너무 크고 현재 시각화를 지배하고 있다는 것을 알고 있습니다. 이에 대한 몇 가지 해결책이 있습니다:</p>
<ul>
<li><p>패싯 레이블을 훨씬 작게 만듭니다. 그러나 이렇게 하면 읽기 어렵고 레이블이 다소 무의미해질 수 있습니다.</p></li>
<li><p>차트의 크기를 늘립니다. 여기서는 플롯의 물리적 너비에 제약을 받으므로 더 넓게 만들 수 없습니다. 플롯을 더 높게 만들 수는 있지만 단순히 레이블을 위해 꽤 많은 추가 공간을 추가하게 됩니다.</p></li>
<li><p>우리만의 사용자 정의 패싯 레이블을 만듭니다.</p></li>
</ul>
<p>여기서는 세 번째 옵션을 선택하겠습니다. 나중에 <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code> 함수를 사용하여 기본 패싯 레이블을 제거할 것입니다. 지금은 어떤 레이블을 추가할지 생각해 봅시다. 플롯의 공간을 절약하는 가장 쉬운 방법은 내부 패싯 레이블을 사용하는 것입니다(주 레이블을 영역 차트 내부에 배치). 이는 데이터의 일부를 숨기는 단점이 있습니다. 그러나 텍스트를 반투명하게 만들어 주 레이블과 뒤에 있는 영역 차트를 모두 볼 수 있도록 할 수 있습니다.</p>
<p><code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>로 텍스트 레이블을 추가합니다. 텍스트의 x 좌표 위치는 차트 중간에 자동으로 배치되도록 전체 <code>plot_data</code> 데이터의 연도 평균으로 설정됩니다. y 좌표 위치는 <code>0.5</code>로 설정됩니다. 즉, <code>position = "fill"</code> 인수가 y축을 <code>0</code>과 <code>1</code> 사이로 조정하므로 역시 차트의 중간입니다. <code><a href="https://scales.r-lib.org/reference/alpha.html">alpha()</a></code> 함수는 텍스트 색상의 투명도를 제어하는 데 사용됩니다. </p>
<p>여기서 <code><a href="https://scales.r-lib.org/reference/alpha.html">alpha()</a></code>에 평소보다 훨씬 작은 값을 사용한다는 점에 유의하십시오. 이는 실제로 각 연도 및 정당 조합에 대해 하나씩, 여러 레이블이 서로 겹쳐서 그려지기 때문입니다. 이것이 반드시 문제는 아니지만 반투명 레이블을 만들려는 경우 동일한 반투명 레이블을 여러 장 겹쳐 놓으면 꽤 불투명한 레이블이 됩니다. 데이터 하나만 필터링하여 한 연도와 정당만 고려할 수도 있지만 <strong><code>geofacet</code></strong> 패키지는 때때로 이 접근 방식으로 레이블을 올바르게 렌더링하는 데 문제가 있습니다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">styled_plot_1</span> <span class="op">&lt;-</span> <span class="va">text_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>      label <span class="op">=</span> <span class="va">state_po</span></span>
<span>    <span class="op">)</span>,</span>
<span>    family <span class="op">=</span> <span class="va">title_font</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="va">bg_col</span>, <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2.5</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>이전 장에서 했던 것처럼 <code><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian()</a></code> 내부에서 <code>expand = FALSE</code>를 설정하여 각 플롯 패널 주변의 추가 공간을 제거합니다. 또한 미니멀한 모양을 목표로 하고 있으며 나중에 독자에게 일반적으로 축 레이블과 제목으로 전달되는 모든 정보를 제공하는 사용자 정의 범례를 디자인할 것이므로 <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void()</a></code>를 사용하여 추가 플롯 요소를 제거합니다. </p>
<p>이전 장에서와 같이 <code><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect()</a></code> 함수를 사용하여 <code>plot.background</code>를 미리 정의된 배경색 변수로 설정합니다. 또한 <code>plot.margin</code>을 사용하여 플롯 여백을 조정합니다. 여기서는 왼쪽 플롯 여백을 매우 크게 만드는데, 여기에 사용자 정의 범례를 배치할 것이기 때문입니다. <a href="lemurs.html" class="quarto-xref"><span>Chapter 9</span></a> 에서 이 접근 방식의 장단점에 대해 논의했습니다. </p>
<p><code>hjust</code>에 음수 값을 선택하여 제목 텍스트를 플롯의 왼쪽, 넓은 여백에 배치할 수 있습니다. <code>0</code>은 왼쪽 정렬을 의미하고 <code>1</code>은 오른쪽 정렬을 의미한다는 것을 기억하십시오. 음수 값은 본질적으로 <em>매우 왼쪽 정렬</em>을 의미합니다! 제목이 한 줄의 텍스트이기 때문에 여기서는 잘 작동하지만 여러 줄의 텍스트의 경우 텍스트 정렬이 이상하게 보일 수 있습니다. 즉, 부제목 텍스트(짧은 단락)의 경우 <code>subtitle</code> 대신 <code>tag</code> 텍스트를 사용합니다. <code>plot.tag.position</code>을 사용하면 텍스트가 표시될 좌표 벡터를 지정할 수 있으며 음수 x 좌표를 사용하여 텍스트를 넓어진 플롯 여백에 배치할 수도 있습니다. <code>title</code>과 <code>tag</code> 텍스트가 서로 정렬되도록 하려면 약간의 시행착오가 필요합니다. 플롯 <code>tag</code> 텍스트에 대한 자동 텍스트 줄 바꿈을 활성화하고 아이콘이 올바르게 렌더링되도록 캡션에 대해 <code><a href="https://wilkelab.org/ggtext/reference/element_textbox.html">element_textbox_simple()</a></code>을 다시 사용합니다. </p>
<p><code>strip.background</code> 및 <code>strip.text</code> 인수를 모두 <code><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank()</a></code>로 설정하여 모든 기본 패싯 레이블을 제거하고 <code>panel.spacing</code>을 사용하여 패싯 사이의 간격을 제어하고 더 가깝게 이동합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">styled_plot_2</span> <span class="op">&lt;-</span> <span class="va">styled_plot_1</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">6</span>, base_family <span class="op">=</span> <span class="va">body_font</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    <span class="co"># Background elements</span></span>
<span>    plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span></span>
<span>      fill <span class="op">=</span> <span class="va">bg_col</span>,</span>
<span>      color <span class="op">=</span> <span class="va">bg_col</span></span>
<span>    <span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">125</span><span class="op">)</span>,</span>
<span>    plot.tag <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_textbox.html">element_textbox_simple</a></span><span class="op">(</span></span>
<span>      family <span class="op">=</span> <span class="va">korean_font</span>,</span>
<span>      hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      color <span class="op">=</span> <span class="va">text_col</span>,</span>
<span>      maxwidth <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>      lineheight <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>      size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_textbox.html">element_textbox_simple</a></span><span class="op">(</span></span>
<span>      family <span class="op">=</span> <span class="va">korean_font</span>,</span>
<span>      hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      halign <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      color <span class="op">=</span> <span class="va">text_col</span>,</span>
<span>      maxwidth <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>      margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">0</span>, t <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    plot.tag.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.50</span>, <span class="fl">0.77</span><span class="op">)</span>,</span>
<span>    <span class="co"># Facet arguments</span></span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">styled_plot_2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-elections-plot-style-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="미국 모양의 그리드에 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 왼쪽에 큰 빈 공간이 나타나며 여기에 나중에 범례가 배치됩니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elections-plot-style-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="us-elections_files/figure-html/fig-elections-plot-style-2-1.png" class="img-fluid figure-img" alt="미국 모양의 그리드에 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 왼쪽에 큰 빈 공간이 나타나며 여기에 나중에 범례가 배치됩니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elections-plot-style-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.8: 미국 모양의 그리드에 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 왼쪽에 큰 빈 공간이 나타나며 여기에 나중에 범례가 배치됩니다.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="사용자-정의-범례-개발" class="level3" data-number="13.4.4"><h3 data-number="13.4.4" class="anchored" data-anchor-id="사용자-정의-범례-개발">
<span class="header-section-number">13.4.4</span> 사용자 정의 범례 개발</h3>
<p><a href="time-zones.html" class="quarto-xref"><span>Chapter 12</span></a> 에서 했던 것처럼 사용자 정의 범례를 디자인할 것입니다. <a href="time-zones.html" class="quarto-xref"><span>Chapter 12</span></a> 에서는 막대 차트를 범례로 사용했는데, 이는 시각화의 또 다른 정보 소스 역할도 했습니다. 이 장에서 사용자 정의 범례는 그 대신 <em>이 차트를 읽는 방법</em> 설명자 역할을 할 것입니다. </p>
<p>패싯 중 하나를 가져와 확대하고 차트에 어떤 데이터가 표시되는지 설명하는 주석을 추가할 수 있습니다. 메인 차트를 깔끔하게 유지하기 위해 현재 축 제목이나 레이블이 없습니다. 예를 들어 데이터가 어떤 연도를 다루는지 바로 알 수 없습니다. 이것을 모든 차트에 추가할 필요는 없지만 범례에는 주석으로 달아야 합니다. <a href="lemurs.html" class="quarto-xref"><span>Chapter 9</span></a> 에서 논의한 것처럼 색상에만 의존하지 않도록 차트의 접근성을 높이기 위해 차트의 <em>민주당(Democratic Party)</em> 및 <em>공화당(Republican Party)</em> 영역을 식별하는 직접 레이블도 추가할 것입니다.</p>
<p>단일 주만 선택하도록 데이터를 필터링하는 것으로 시작하겠습니다. 어느 주를 선택하든 상관없지만 차트에 정당 레이블을 직접 추가할 수 있도록 충분한 공간이 있는 주가 이상적입니다. 여기서는 범례 플롯으로 캘리포니아(<code>"CA"</code>)를 사용합니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ca_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="va">state_po</span> <span class="op">==</span> <span class="st">"CA"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>그런 다음 메인 플롯을 위해 작성된 코드를 재사용하여 <code>ca_data</code>를 <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> 함수에 전달한 다음 미적 매핑과 <code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area()</a></code>로 영역 차트를 추가합니다. 색상과 사용자 정의 주(패싯) 레이블은 이 장의 앞부분에서 설명한 대로 <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual()</a></code> 및 <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>로 추가됩니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ca_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ca_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">year</span>,</span>
<span>      y <span class="op">=</span> <span class="va">votes</span>,</span>
<span>      fill <span class="op">=</span> <span class="va">party</span></span>
<span>    <span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="st">"fill"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># label for state</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>      label <span class="op">=</span> <span class="va">state_po</span></span>
<span>    <span class="op">)</span>,</span>
<span>    family <span class="op">=</span> <span class="va">title_font</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="va">bg_col</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">4</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># colors</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"민주당"</span> <span class="op">=</span> <span class="va">blue_col</span>,</span>
<span>      <span class="st">"공화당"</span> <span class="op">=</span> <span class="va">red_col</span>,</span>
<span>      <span class="st">"기타"</span> <span class="op">=</span> <span class="va">other_col</span></span>
<span>    <span class="op">)</span>,</span>
<span>    guide <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>그런 다음 <code><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate()</a></code> 함수를 사용하여 다음을 추가합니다: </p>
<ul>
<li><p>데이터의 시작 연도와 끝 연도에 대한 두 개의 레이블. 이것들을 플롯의 경계 내에 유지하기 위해 시작 레이블은 왼쪽 정렬하고 끝 레이블은 오른쪽 정렬합니다.</p></li>
<li><p><em>공화당</em>과 <em>민주당</em>에 대한 두 개의 레이블. <em>기타</em> 범주는 매우 작고 남은 유일한 범주임이 분명하므로 레이블을 지정하지 않은 상태로 둡니다.</p></li>
</ul>
<p>메인 플롯에서와 같이 <code><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian()</a></code> 내부에 <code>expand = FALSE</code>를 설정하여 가장자리 주변의 추가 공간을 제거합니다. 또한 주석이 필요한 모든 정보를 전달하므로 <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void()</a></code>를 사용하여 추가 차트 요소를 제거합니다. </p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p_inset</span> <span class="op">&lt;-</span> <span class="va">ca_plot</span> <span class="op">+</span></span>
<span>  <span class="co"># year labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">ca_data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">ca_data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>,</span>
<span>    family <span class="op">=</span> <span class="va">korean_font</span>,</span>
<span>    color <span class="op">=</span> <span class="va">bg_col</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ca_data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ca_data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>,</span>
<span>    family <span class="op">=</span> <span class="va">korean_font</span>,</span>
<span>    color <span class="op">=</span> <span class="va">bg_col</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Party labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">ca_data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"민주당"</span>,</span>
<span>    family <span class="op">=</span> <span class="va">korean_font</span>,</span>
<span>    color <span class="op">=</span> <span class="va">bg_col</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">ca_data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"공화당"</span>,</span>
<span>    family <span class="op">=</span> <span class="va">korean_font</span>,</span>
<span>    color <span class="op">=</span> <span class="va">bg_col</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p_inset</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-elections-inset-plot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="캘리포니아 패싯의 확대 버전으로 구성된 사용자 정의 범례 플롯으로, 기간과 색상으로 표시된 범주를 나타내는 추가 주석이 있습니다." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elections-inset-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="us-elections_files/figure-html/fig-elections-inset-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="캘리포니아 패싯의 확대 버전으로 구성된 사용자 정의 범례 플롯으로, 기간과 색상으로 표시된 범주를 나타내는 추가 주석이 있습니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elections-inset-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.9: 캘리포니아 패싯의 확대 버전으로 구성된 사용자 정의 범례 플롯으로, 기간과 색상으로 표시된 범주를 나타내는 추가 주석이 있습니다.
</figcaption></figure>
</div>
</div>
</div>
<p>이제 사용자 정의 범례를 <a href="#fig-elections-plot-style-2" class="quarto-xref">Figure&nbsp;<span>13.8</span></a> 에 추가할 준비가 되었습니다.</p>
</section><section id="patchwork로-결합하기" class="level3" data-number="13.4.5"><h3 data-number="13.4.5" class="anchored" data-anchor-id="patchwork로-결합하기">
<span class="header-section-number">13.4.5</span> <strong><code>patchwork</code></strong>로 결합하기</h3>
<p>이제 마지막 단계는 사용자 정의 범례를 메인 플롯과 결합하는 것입니다. 이미 메인 플롯에 범례가 들어갈 빈 공간을 남겨 두었으므로 <a href="time-zones.html" class="quarto-xref"><span>Chapter 12</span></a> 에서 했던 것처럼 <strong><code>patchwork</code></strong> <span class="citation" data-cites="patchwork">(<a href="references.html#ref-patchwork" role="doc-biblioref">Pedersen 2024</a>)</span>의 <code><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element()</a></code> 함수를 사용합니다. <code>left</code>, <code>right</code>, <code>top</code>, <code>bottom</code> 인수를 사용하여 메인 플롯과 관련하여 범례의 모서리가 나타날 위치를 선택합니다. 이 값을 올바르게 얻으려면 약간의 시행착오가 필요합니다! <code>align_to = "full"</code>을 설정하면 기본 설정에 따른 패널 영역만이 아니라 전체 차트 영역을 기준으로 좌표를 선택할 수 있습니다. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final_plot</span> <span class="op">&lt;-</span> <span class="va">styled_plot_2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element</a></span><span class="op">(</span></span>
<span>  p <span class="op">=</span> <span class="va">p_inset</span>,</span>
<span>  left <span class="op">=</span> <span class="fl">0.035</span>,</span>
<span>  bottom <span class="op">=</span> <span class="fl">0.087</span>,</span>
<span>  right <span class="op">=</span> <span class="fl">0.295</span>,</span>
<span>  top <span class="op">=</span> <span class="fl">0.55</span>,</span>
<span>  align_to <span class="op">=</span> <span class="st">"full"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">final_plot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-combine-plots" class="quarto-float quarto-figure quarto-figure-center anchored" alt="미국 모양의 그리드에 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 캘리포니아의 영역 차트 확대 버전이 왼쪽의 범례로 사용됩니다.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-combine-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="us-elections_files/figure-html/fig-combine-plots-1.png" class="img-fluid figure-img" alt="미국 모양의 그리드에 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 캘리포니아의 영역 차트 확대 버전이 왼쪽의 범례로 사용됩니다.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-combine-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.10: 미국 모양의 그리드에 배열된 패싯 영역 차트로, 시간 경과에 따른 정당별 득표율을 보여줍니다. 캘리포니아의 영역 차트 확대 버전이 왼쪽의 범례로 사용됩니다.
</figcaption></figure>
</div>
</div>
</div>
<p>그런 다음 <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>로 파일에 저장할 수 있습니다! </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span></span>
<span>  filename <span class="op">=</span> <span class="st">"us-elections.png"</span>,</span>
<span>  plot <span class="op">=</span> <span class="va">final_plot</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section></section><section id="회고" class="level2" data-number="13.5"><h2 data-number="13.5" class="anchored" data-anchor-id="회고">
<span class="header-section-number">13.5</span> 회고</h2>
<p>이 시각화는 방대한 양의 복잡한 정보를 꽤 직관적인 방식으로 요약합니다. 색상은 인식 가능한 정당 색상과 일치하고, 그리드는 즉시 인식 가능한 모양으로 배열되며, 영역 차트는 시간 경과에 따른 득표율을 명확하게 나타냅니다. 그러나 몇 가지 더 개선할 수 있는 부분과 고려해야 할 다른 요소가 있습니다.</p>
<p>주 두 글자 약어를 사용하면 공간을 절약하고 과도한 텍스트를 피할 수 있지만 독자가 특히 미국 지리에 익숙하지 않은 경우 관심 있는 주를 쉽게 찾기가 더 어렵습니다. 약어 아래에 작은 텍스트를 추가하거나 마우스를 갖다 대면 주 이름을 제공하는 대화형 버전을 만들면 더 쉬울 것입니다.</p>
<div id="tip-elections-interactive" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;13.2: {ggplot2}를 이용한 인터랙티브 차트
</div>
</div>
<div class="callout-body-container callout-body">
<p>이 책은 정적 시각화를 만드는 데 중점을 두지만 웹 기반 결과물에 사용할 대화형 차트를 개발하는 데에도 관심이 있을 수 있습니다. R에는 대화형 시각화를 만들 수 있는 많은 패키지가 있으며 <strong><code>ggplot2</code></strong> 사용자에게 특히 유용한 몇 가지 패키지가 있습니다: </p>
<ul>
<li><p><strong><code>plotly</code></strong> <span class="citation" data-cites="plotly">(<a href="references.html#ref-plotly" role="doc-biblioref">Sievert 2020</a>)</span>: <code>plotly.js</code> 자바스크립트 라이브러리를 사용하여 대화형 그래픽을 구축할 수 있습니다. <code>ggplotly()</code> 함수는 <strong><code>ggplot2</code></strong> 플롯을 <strong><code>plotly</code></strong> 플롯으로 변환하여 대화형 그래픽을 만드는 빠른 방법입니다.</p></li>
<li><p><strong><code>ggiraph</code></strong> <span class="citation" data-cites="ggiraph">(<a href="references.html#ref-ggiraph" role="doc-biblioref">Gohel and Skintzos 2024</a>)</span>: <strong><code>ggplot2</code></strong> 그래픽에 툴팁, 확대/축소 및 클릭 가능한 요소를 추가할 수 있습니다.</p></li>
</ul>
</div>
</div>
<p>색상은 직관적이지만 강도가 비슷하기 때문에 가장 접근하기 쉬운 것은 아닙니다. <a href="animal-intakes.html" class="quarto-xref"><span>Chapter 5</span></a> 에서 했던 것처럼 <strong><code>colorblindr</code></strong>의 <code>cvd_grid()</code> 함수를 사용한다면 이 색상들이 훨씬 덜 구별되어 보일 수 있습니다. 밝은 파란색과 밝은 빨간색의 조합을 선택하거나 밝은 빨간색과 밝은 파란색의 조합을 선택하면 색상의 직관성은 유지되지만 접근성은 향상될 것입니다. </p>
<p>득표율은 본질적으로 선거를 결정하는 것이므로 백분율을 표시하기 위해 영역 차트를 사용하는 것은 직관적이고 합리적입니다. 그러나 득표 수의 합계를 보는 것도 흥미로울 것입니다. 특히 주는 인구가 매우 다를 수 있기 때문입니다. 인구가 많은 주에서 백분율이 조금만 변경되어도 득표 수가 크게 변할 수 있지만, 이 시각화 버전에서는 이를 볼 수 없습니다.</p>
<p>이 시각화의 원본 버전을 개발하는 과정에서 생성된 각 플롯은 <strong><code>camcorder</code></strong>를 사용하여 캡처되었으며 아래 gif에 표시됩니다. 데이터 시각화 프로세스에서 <strong><code>camcorder</code></strong>를 사용하는 방법에 대해 자세히 알아보려면 <a href="other-tricks.html#sec-camcorder" class="quarto-xref"><span>Section 14.1</span></a> 를 참조하십시오.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/elections.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="차트 작성 과정의 Gif"></p>
</figure>
</div>
</section><section id="연습-문제" class="level2" data-number="13.6"><h2 data-number="13.6" class="anchored" data-anchor-id="연습-문제">
<span class="header-section-number">13.6</span> 연습 문제</h2>
<ul>
<li><p>사용자 정의 범례 플롯으로 캘리포니아를 사용하는 대신 모든 주의 <em>전체</em> 투표율을 보여주는 플롯을 만드십시오. 차트를 해석하는 방법을 설명하기 위해 텍스트를 업데이트해야 합니까?</p></li>
<li><p>득표율 대신 총 투표 수를 표시하도록 시각화를 편집하십시오. 비슷한 패턴이 보입니까? 자동화된 방식으로 주에 대한 패싯 레이블 위치를 어떻게 선택할 수 있습니까?</p></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Anscombe1973" class="csl-entry" role="listitem">
Anscombe, F. J. 1973. <span>“Graphs in Statistical Analysis.”</span> <em>The American Statistician</em> 27 (1): 17–21. <a href="https://doi.org/10.1080/00031305.1973.10478966">https://doi.org/10.1080/00031305.1973.10478966</a>.
</div>
<div id="ref-aphalo2024" class="csl-entry" role="listitem">
Aphalo, Pedro J. 2024. <em><span class="nocase">Learn R: As a Language</span></em>. Second Edition. CRC Press. <a href="https://www.learnr-book.info/">https://www.learnr-book.info/</a>.
</div>
<div id="ref-egg" class="csl-entry" role="listitem">
Auguie, Baptiste. 2019. <em><span class="nocase">egg: Extensions for ’ggplot2’: Custom Geom, Custom Themes, Plot Alignment, Labelled Panels, Symmetric Scales, and Fixed Panel Size</span></em>. <a href="https://CRAN.R-project.org/package=egg">https://CRAN.R-project.org/package=egg</a>.
</div>
<div id="ref-imager" class="csl-entry" role="listitem">
Barthelme, Simon. 2024. <em><span class="nocase">imager: Image Processing Library Based on ’CImg’</span></em>. <a href="https://CRAN.R-project.org/package=imager">https://CRAN.R-project.org/package=imager</a>.
</div>
<div id="ref-vandenBrandv4" class="csl-entry" role="listitem">
Brand, Teun van den. 2025. <span>“<span class="nocase">ggplot2 4.0.0</span>.”</span> <a href="https://www.tidyverse.org/blog/2025/09/ggplot2-4-0-0/" class="uri">https://www.tidyverse.org/blog/2025/09/ggplot2-4-0-0/</a>.
</div>
<div id="ref-bridson2007" class="csl-entry" role="listitem">
Bridson, Robert. 2007. <span>“Fast Poisson Disk Sampling in Arbitrary Dimensions.”</span> In <em>ACM SIGGRAPH 2007 Sketches</em>. SIGGRAPH ’07. New York, NY, USA: Association for Computing Machinery. <a href="https://doi.org/10.1145/1278780.1278807">https://doi.org/10.1145/1278780.1278807</a>.
</div>
<div id="ref-Brown2009" class="csl-entry" role="listitem">
Brown, Mark J.F., and Paxton, Robert J. 2009. <span>“The Conservation of Bees: A Global Perspective.”</span> <em>Apidologie</em> 40 (3): 410–16. <a href="https://doi.org/10.1051/apido/2009019">https://doi.org/10.1051/apido/2009019</a>.
</div>
<div id="ref-geomtextpath" class="csl-entry" role="listitem">
Cameron, Allan, and Teun van den Brand. 2024. <em><span class="nocase">geomtextpath: Curved Text in ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=geomtextpath">https://CRAN.R-project.org/package=geomtextpath</a>.
</div>
<div id="ref-cartocolors" class="csl-entry" role="listitem">
CARTO. 2016. <em><span>’CARTOColors’ Palettes</span></em>. <a href="https://carto.com/carto-colors/">https://carto.com/carto-colors/</a>.
</div>
<div id="ref-extrafont" class="csl-entry" role="listitem">
Chang, Winston. 2023. <em><span class="nocase">extrafont</span>: Tools for Using Fonts</em>. <a href="https://CRAN.R-project.org/package=extrafont">https://CRAN.R-project.org/package=extrafont</a>.
</div>
<div id="ref-dumbbell" class="csl-entry" role="listitem">
Cheung, Foo. 2021. <em><span class="nocase">dumbbell</span>: Displaying Changes Between Two Points Using Dumbbell Plots</em>. <a href="https://CRAN.R-project.org/package=dumbbell">https://CRAN.R-project.org/package=dumbbell</a>.
</div>
<div id="ref-ggannotate" class="csl-entry" role="listitem">
Cowgill, Matt, and John Helveston. 2021. <em><span class="nocase">ggannotate: Interactively Annotate ggplot2 Plots</span></em>. <a href="https://github.com/MattCowgill/ggannotate">https://github.com/MattCowgill/ggannotate</a>.
</div>
<div id="ref-pak" class="csl-entry" role="listitem">
Csárdi, Gábor, and Jim Hester. 2024. <em><span class="nocase">pak: Another Approach to Package Installation</span></em>. <a href="https://CRAN.R-project.org/package=pak">https://CRAN.R-project.org/package=pak</a>.
</div>
<div id="ref-remotes" class="csl-entry" role="listitem">
Csárdi, Gábor, Jim Hester, Hadley Wickham, Winston Chang, Martin Morgan, and Dan Tenenbaum. 2024. <em><span class="nocase">remotes: R Package Installation from Remote Repositories, Including ’GitHub’</span></em>. <a href="https://CRAN.R-project.org/package=remotes">https://CRAN.R-project.org/package=remotes</a>.
</div>
<div id="ref-ggview" class="csl-entry" role="listitem">
Domin, Iaroslav. 2024. <em><span class="nocase">ggview: ’ggplot2’ Picture Previewer</span></em>. <a href="https://CRAN.R-project.org/package=ggview">https://CRAN.R-project.org/package=ggview</a>.
</div>
<div id="ref-tidyplots" class="csl-entry" role="listitem">
Engler, Jan Broder. 2024. <span>“Tidyplots Empowers Life Scientists with Easy Code-Based Data Visualization.”</span> <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2024.11.08.621836">https://doi.org/10.1101/2024.11.08.621836</a>.
</div>
<div id="ref-ggpattern" class="csl-entry" role="listitem">
FC, Mike, Trevor L. Davis, and ggplot2 authors. 2024. <em><span class="nocase">ggpattern: ’ggplot2’ Pattern Geoms</span></em>. <a href="https://CRAN.R-project.org/package=ggpattern">https://CRAN.R-project.org/package=ggpattern</a>.
</div>
<div id="ref-flaticon" class="csl-entry" role="listitem">
Flaticon.com. 2024. <span>“<span>Wind Power Flaticon</span>.”</span> <a href="https://www.flaticon.com/free-icon/wind-power_5670189" class="uri">https://www.flaticon.com/free-icon/wind-power_5670189</a>.
</div>
<div id="ref-fontawesome" class="csl-entry" role="listitem">
Font Awesome. 2024. <span>“<span>Font Awesome 6</span>.”</span> <a href="https://fontawesome.com/" class="uri">https://fontawesome.com/</a>.
</div>
<div id="ref-Hullman2021" class="csl-entry" role="listitem">
Franconeri, Steven L., Lace M. Padilla, Priti Shah, Jeffrey M. Zacks, and Jessica Hullman. 2021. <span>“The Science of Visual Data Communication: What Works.”</span> <em>Psychological Science in the Public Interest</em> 22 (3): 110–61. <a href="https://doi.org/10.1177/15291006211051956">https://doi.org/10.1177/15291006211051956</a>.
</div>
<div id="ref-viridis" class="csl-entry" role="listitem">
Garnier, Simon, Ross, Noam, Rudis, Robert, Camargo, et al. 2024. <em><span class="nocase">viridis(Lite)</span> - Colorblind-Friendly Color Maps for <span>R</span></em>. <a href="https://doi.org/10.5281/zenodo.4679423">https://doi.org/10.5281/zenodo.4679423</a>.
</div>
<div id="ref-ggiraph" class="csl-entry" role="listitem">
Gohel, David, and Panagiotis Skintzos. 2024. <em><span class="nocase">ggiraph: Make ’ggplot2’ Graphics Interactive</span></em>. <a href="https://CRAN.R-project.org/package=ggiraph">https://CRAN.R-project.org/package=ggiraph</a>.
</div>
<div id="ref-GAcharts" class="csl-entry" role="listitem">
Government Analysis Function. 2021. <span>“Data Visualisation: Colours.”</span> <a href="https://analysisfunction.civilservice.gov.uk/policy-store/data-visualisation-colours-in-charts/" class="uri">https://analysisfunction.civilservice.gov.uk/policy-store/data-visualisation-colours-in-charts/</a>.
</div>
<div id="ref-geofacet" class="csl-entry" role="listitem">
Hafen, Ryan. 2023. <em><span class="nocase">geofacet</span>: <span class="nocase">’ggplot2’</span> Faceting Utilities for Geographical Data</em>. <a href="https://CRAN.R-project.org/package=geofacet">https://CRAN.R-project.org/package=geofacet</a>.
</div>
<div id="ref-harmon2024" class="csl-entry" role="listitem">
Harmon, Jon. 2024. <em><span class="nocase">Web APIs with R</span></em>. <span>CRC Press</span>. <a href="https://wapir.io/">https://wapir.io/</a>.
</div>
<div id="ref-lintr" class="csl-entry" role="listitem">
Hester, Jim, Florent Angly, Russ Hyde, Michael Chirico, Kun Ren, Alexander Rosenstock, and Indrajeet Patil. 2024. <em><span class="nocase">lintr</span>: A ’Linter’ for <span>R</span> Code</em>. <a href="https://CRAN.R-project.org/package=lintr">https://CRAN.R-project.org/package=lintr</a>.
</div>
<div id="ref-glue" class="csl-entry" role="listitem">
Hester, Jim, and Jennifer Bryan. 2024. <em><span class="nocase">glue</span>: Interpreted String Literals</em>. <a href="https://glue.tidyverse.org/">https://glue.tidyverse.org/</a>.
</div>
<div id="ref-camcorder" class="csl-entry" role="listitem">
Hughes, Ellis. 2022a. <em><span class="nocase">camcorder</span>: Record Your Plot History</em>. <a href="https://CRAN.R-project.org/package=camcorder">https://CRAN.R-project.org/package=camcorder</a>.
</div>
<div id="ref-tidytuesdayR" class="csl-entry" role="listitem">
———. 2022b. <em><span class="nocase">tidytuesdayR</span>: Access the Weekly ’TidyTuesday’ Project Dataset</em>. <a href="https://CRAN.R-project.org/package=tidytuesdayR">https://CRAN.R-project.org/package=tidytuesdayR</a>.
</div>
<div id="ref-paletteer" class="csl-entry" role="listitem">
Hvitfeldt, Emil. 2021. <em><span class="nocase">paletteer</span>: Comprehensive Collection of Color Palettes</em>. <a href="https://github.com/EmilHvitfeldt/paletteer">https://github.com/EmilHvitfeldt/paletteer</a>.
</div>
<div id="ref-animalshelter" class="csl-entry" role="listitem">
———. 2025. <em><span class="nocase">animalshelter</span>: Animal Shelter Data</em>. <a href="https://github.com/EmilHvitfeldt/animalshelter">https://github.com/EmilHvitfeldt/animalshelter</a>.
</div>
<div id="ref-fontawesomeR" class="csl-entry" role="listitem">
Iannone, Richard. 2024. <em><span class="nocase">fontawesome: Easily Work with ’Font Awesome’ Icons</span></em>. <a href="https://CRAN.R-project.org/package=fontawesome">https://CRAN.R-project.org/package=fontawesome</a>.
</div>
<div id="ref-zones_data" class="csl-entry" role="listitem">
Internet Assigned Numbers Authority. 2023. <span>“The <span class="nocase">tz</span> Database: Time Zone and Daylight Saving Time Data.”</span> <span>Internet Assigned Numbers Authority</span>. <a href="https://data.iana.org/time-zones/tz-link.html">https://data.iana.org/time-zones/tz-link.html</a>.
</div>
<div id="ref-img_jax" class="csl-entry" role="listitem">
Jax (@lysrix). 2017. <span>“Lemur.”</span> <a href="https://unsplash.com/photos/red-and-white-rodent-h5xrh3CNT-k">https://unsplash.com/photos/red-and-white-rodent-h5xrh3CNT-k</a>.
</div>
<div id="ref-kays2020" class="csl-entry" role="listitem">
Kays, R., R. R. Dunn, A. W. Parsons, B. Mcdonald, T. Perkins, S. A. Powers, L. Shell, et al. 2020. <span>“The Small Home Ranges and Large Local Ecological Impacts of Pet Cats.”</span> <em>Animal Conservation</em> 23 (5): 516–23. <a href="https://doi.org/10.1111/acv.12563">https://doi.org/10.1111/acv.12563</a>.
</div>
<div id="ref-r4rest" class="csl-entry" role="listitem">
Keyes, David. 2024. <em><span class="nocase">R for the Rest of Us: A Statistics-Free Introduction</span></em>. No Starch Press. <a href="https://book.rfortherestofus.com/">https://book.rfortherestofus.com/</a>.
</div>
<div id="ref-longbeach_data" class="csl-entry" role="listitem">
Long Beach Animal Shelter. 2025. <span>“<span>Animal Shelter Data</span>.”</span> City of Long Beach Animal Care Services. <a href="https://data.longbeach.gov/explore/dataset/animal-shelter-intakes-and-outcomes/information/">https://data.longbeach.gov/explore/dataset/animal-shelter-intakes-and-outcomes/information/</a>.
</div>
<div id="ref-Vizumap" class="csl-entry" role="listitem">
Lucchesi, Lydia, and Petra Kuhnert. 2020. <em><span>Vizumap</span>: Visualizing Uncertainty in Spatial Data</em>. <a href="https://github.com/lydialucchesi/Vizumap">https://github.com/lydialucchesi/Vizumap</a>.
</div>
<div id="ref-museums_data" class="csl-entry" role="listitem">
Mapping Museums. 2021. <span>“Mapping Museums Data.”</span> <a href="https://www.mappingmuseums.org">www.mappingmuseums.org</a>.
</div>
<div id="ref-rnaturalearth" class="csl-entry" role="listitem">
Massicotte, Philippe, and Andy South. 2023. <em><span class="nocase">rnaturalearth</span>: World Map Data from Natural Earth</em>. <a href="https://docs.ropensci.org/rnaturalearth/">https://docs.ropensci.org/rnaturalearth/</a>.
</div>
<div id="ref-Matejka2017" class="csl-entry" role="listitem">
Matejka, Justin, and George Fitzmaurice. 2017. <span>“Same Stats, Different Graphs: Generating Datasets with Varied Appearance and Identical Statistics Through Simulated Annealing.”</span> In, 1290–94. <a href="https://doi.org/10.1145/3025453.3025912">https://doi.org/10.1145/3025453.3025912</a>.
</div>
<div id="ref-cats_data" class="csl-entry" role="listitem">
McDonald, J. L., and H. Cole. 2020. <span>“Data from: The Small Home Ranges and Large Local Ecological Impacts of Pet Cats [United Kingdom].”</span> Movebank data repository. <a href="https://doi.org/doi:10.5441/001/1.pf315732">https://doi.org/doi:10.5441/001/1.pf315732</a>.
</div>
<div id="ref-colorblindr" class="csl-entry" role="listitem">
McWhite, Claire D., and Claus O. Wilke. 2024. <em><span class="nocase">colorblindr: Simulate colorblindness in R figures</span></em>. <a href="https://github.com/clauswilke/colorblindr">https://github.com/clauswilke/colorblindr</a>.
</div>
<div id="ref-Apiculture" class="csl-entry" role="listitem">
Mid-Atlantic Apiculture Research and Extension Consortium. 2024. <span>“Seasonal Cycles of Activities in Colonies.”</span> <a href="https://canr.udel.edu/maarec/honey-bee-biology/seasonal-cycles-of-activities-in-colonies/" class="uri">https://canr.udel.edu/maarec/honey-bee-biology/seasonal-cycles-of-activities-in-colonies/</a>.
</div>
<div id="ref-poissoned" class="csl-entry" role="listitem">
mikefc. 2024. <em><span class="nocase">poissoned: Tileable Poisson Disc Sampling</span></em>. <a href="https://github.com/coolbutuseless/poissoned">https://github.com/coolbutuseless/poissoned</a>.
</div>
<div id="ref-MetBrewer" class="csl-entry" role="listitem">
Mills, Blake Robert. 2022. <em><span>MetBrewer</span>: Color Palettes Inspired by Works at the Metropolitan Museum of Art</em>. <a href="https://CRAN.R-project.org/package=MetBrewer">https://CRAN.R-project.org/package=MetBrewer</a>.
</div>
<div id="ref-elections_data" class="csl-entry" role="listitem">
MIT Election Data and Science Lab. 2017. <span>“<span>U.S. House 1976–2022</span>.”</span> Harvard Dataverse. <a href="https://doi.org/10.7910/DVN/IG0UN2">https://doi.org/10.7910/DVN/IG0UN2</a>.
</div>
<div id="ref-styler" class="csl-entry" role="listitem">
Müller, Kirill, and Lorenz Walthert. 2023. <em><span class="nocase">styler</span>: Non-Invasive Pretty Printing of <span>R</span> Code</em>. <a href="https://CRAN.R-project.org/package=styler">https://CRAN.R-project.org/package=styler</a>.
</div>
<div id="ref-tibble" class="csl-entry" role="listitem">
Müller, Kirill, and Hadley Wickham. 2023. <em><span class="nocase">tibble</span>: Simple Data Frames</em>. <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a>.
</div>
<div id="ref-Muth2018" class="csl-entry" role="listitem">
Muth, Lisa. 2018. <span>“An Alternative to Pink &amp; Blue: Colors for Gender Data.”</span> <a href="https://blog.datawrapper.de/gendercolor/" class="uri">https://blog.datawrapper.de/gendercolor/</a>.
</div>
<div id="ref-turbines_data" class="csl-entry" role="listitem">
Natural Resources Canada. 2021. <span>“Canadian Wind Turbine Database.”</span> Natural Resources Canada (Government of Canada). <a href="https://open.canada.ca/data/en/dataset/79fdad93-9025-49ad-ba16-c26d718cc070">https://open.canada.ca/data/en/dataset/79fdad93-9025-49ad-ba16-c26d718cc070</a>.
</div>
<div id="ref-ggbranding" class="csl-entry" role="listitem">
Noblet, Guillaume. 2025. <em><span class="nocase">ggbranding: Add Personal Branding to ’ggplot2’ Charts</span></em>. <a href="https://github.com/gnoblet/ggbranding">https://github.com/gnoblet/ggbranding</a>.
</div>
<div id="ref-rcartocolor" class="csl-entry" role="listitem">
Nowosad, Jakub. 2018. <em><span>’CARTOColors’ Palettes</span></em>. <a href="https://jakubnowosad.com/rcartocolor/">https://jakubnowosad.com/rcartocolor/</a>.
</div>
<div id="ref-magick" class="csl-entry" role="listitem">
Ooms, Jeroen. 2024. <em><span class="nocase">magick: Advanced Graphics and Image-Processing in R</span></em>. <a href="https://CRAN.R-project.org/package=magick">https://CRAN.R-project.org/package=magick</a>.
</div>
<div id="ref-doctors_data" class="csl-entry" role="listitem">
Our World in Data. 2019. <span>“Medical Doctors Per 1,000 People.”</span> <a href="https://ourworldindata.org/grapher/physicians-per-1000-people">https://ourworldindata.org/grapher/physicians-per-1000-people</a>.
</div>
<div id="ref-sf" class="csl-entry" role="listitem">
Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for R: Standardized Support for Spatial Vector Data</span>.”</span> <em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-ggforce" class="csl-entry" role="listitem">
Pedersen, Thomas Lin. 2022. <em><span class="nocase">ggforce</span>: Accelerating <span class="nocase">’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggforce">https://CRAN.R-project.org/package=ggforce</a>.
</div>
<div id="ref-patchwork" class="csl-entry" role="listitem">
———. 2024. <em><span class="nocase">patchwork</span>: The Composer of Plots</em>. <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>.
</div>
<div id="ref-Pedersen2025" class="csl-entry" role="listitem">
———. 2025. <span>“<span class="nocase">Fonts in R</span>.”</span> <a href="https://www.tidyverse.org/blog/2025/05/fonts-in-r/" class="uri">https://www.tidyverse.org/blog/2025/05/fonts-in-r/</a>.
</div>
<div id="ref-marquee" class="csl-entry" role="listitem">
Pedersen, Thomas Lin, and Martin Mitáš. 2024. <em><span class="nocase">marquee: Markdown Parser and Renderer for R Graphics</span></em>. <a href="https://CRAN.R-project.org/package=marquee">https://CRAN.R-project.org/package=marquee</a>.
</div>
<div id="ref-systemfonts" class="csl-entry" role="listitem">
Pedersen, Thomas Lin, Jeroen Ooms, and Devon Govett. 2024. <em><span class="nocase">systemfonts: System Native Font Finding</span></em>. <a href="https://CRAN.R-project.org/package=systemfonts">https://CRAN.R-project.org/package=systemfonts</a>.
</div>
<div id="ref-ragg" class="csl-entry" role="listitem">
Pedersen, Thomas Lin, and Maxim Shemanarev. 2023. <em><span class="nocase">ragg</span>: Graphic Devices Based on <span>AGG</span></em>. <a href="https://CRAN.R-project.org/package=ragg">https://CRAN.R-project.org/package=ragg</a>.
</div>
<div id="ref-pldb_data" class="csl-entry" role="listitem">
PLDB contributors. 2022. <span>“<span>PLDB</span>: A Programming Language Database.”</span> <em><span>PLDB</span></em>. <a href="https://pldb.com">https://pldb.com</a>.
</div>
<div id="ref-sysfonts" class="csl-entry" role="listitem">
Qiu, Yixuan. 2022. <em><span class="nocase">sysfonts</span>: Loading Fonts into <span>R</span></em>. <a href="https://CRAN.R-project.org/package=sysfonts">https://CRAN.R-project.org/package=sysfonts</a>.
</div>
<div id="ref-showtext" class="csl-entry" role="listitem">
———. 2023. <em><span class="nocase">showtext</span>: Using Fonts More Easily in <span>R</span> Graphs</em>. <a href="https://CRAN.R-project.org/package=showtext">https://CRAN.R-project.org/package=showtext</a>.
</div>
<div id="ref-rproj" class="csl-entry" role="listitem">
R Core Team. 2024. <em><span>R</span>: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-tidytuesday" class="csl-entry" role="listitem">
R4DS Online Learning Community. 2023. <span>“Tidy Tuesday: A Weekly Social Data Project.”</span> <a href="https://github.com/rfordatascience/tidytuesday">https://github.com/rfordatascience/tidytuesday</a>.
</div>
<div id="ref-social_icons" class="csl-entry" role="listitem">
Rennie, Nicola. 2023a. <span>“Adding Social Media Icons to Charts with <span class="nocase">ggplot2</span>.”</span> <a href="https://nrennie.rbind.io/blog/adding-social-media-icons-ggplot2/">https://nrennie.rbind.io/blog/adding-social-media-icons-ggplot2/</a>.
</div>
<div id="ref-template_files" class="csl-entry" role="listitem">
———. 2023b. <span>“Creating Template Files with <span>R</span>.”</span> <a href="https://nrennie.rbind.io/blog/script-templates-r/">https://nrennie.rbind.io/blog/script-templates-r/</a>.
</div>
<div id="ref-streamline" class="csl-entry" role="listitem">
———. 2023c. <span>“Four Ways to Streamline Your <span>R</span> Workflows.”</span> <a href="https://nrennie.rbind.io/blog/four-ways-streamline-r-workflows/">https://nrennie.rbind.io/blog/four-ways-streamline-r-workflows/</a>.
</div>
<div id="ref-ggtextcircle" class="csl-entry" role="listitem">
———. 2024a. <em><span class="nocase">ggtextcircle: Circular Text in ’ggplot2’</span></em>. <a href="https://github.com/nrennie/ggtextcircle">https://github.com/nrennie/ggtextcircle</a>.
</div>
<div id="ref-nobel" class="csl-entry" role="listitem">
———. 2024b. <em><span class="nocase">nobel: Access data from the Nobel Prize API via R</span></em>. <a href="https://github.com/nrennie/nobel">https://github.com/nrennie/nobel</a>.
</div>
<div id="ref-pkgs_data" class="csl-entry" role="listitem">
———. 2024c. <span>“<span class="nocase">tidytuesday</span>.”</span> <em>GitHub Repository</em>. GitHub. <a href="https://github.com/nrennie/tidytuesday">https://github.com/nrennie/tidytuesday</a>.
</div>
<div id="ref-signif2024a" class="csl-entry" role="listitem">
Rennie, Nicola, and Andreas Krause. 2024. <span>“<span class="nocase">Presenting data the Significance way - Part 1</span>.”</span> <em>Significance</em> 21 (3): 36–39. <a href="https://doi.org/10.1093/jrssig/qmae045">https://doi.org/10.1093/jrssig/qmae045</a>.
</div>
<div id="ref-Reynolds2025" class="csl-entry" role="listitem">
Reynolds, Gina. 2025. <span>“<span class="nocase">Everyday ggplot2 extension</span>.”</span> <a href="https://evamaerey.github.io/everyday_ggplot2_extension/" class="uri">https://evamaerey.github.io/everyday_ggplot2_extension/</a>.
</div>
<div id="ref-hex_forcats" class="csl-entry" role="listitem">
RStudio. 2018a. <span>“<span class="nocase">forcats</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/forcats.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/forcats.png</a>.
</div>
<div id="ref-hex_ggplot2" class="csl-entry" role="listitem">
———. 2018b. <span>“<span class="nocase">ggplot2</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/ggplot2.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/ggplot2.png</a>.
</div>
<div id="ref-hex_purrr" class="csl-entry" role="listitem">
———. 2018c. <span>“<span class="nocase">purrr</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/purrr.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/purrr.png</a>.
</div>
<div id="ref-hex_readr" class="csl-entry" role="listitem">
———. 2018d. <span>“<span class="nocase">readr</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/readr.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/readr.png</a>.
</div>
<div id="ref-hex_tibble" class="csl-entry" role="listitem">
———. 2018e. <span>“<span class="nocase">tibble</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/tibble.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/tibble.png</a>.
</div>
<div id="ref-hex_dplyr" class="csl-entry" role="listitem">
———. 2020a. <span>“<span class="nocase">dplyr</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/dplyr.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/dplyr.png</a>.
</div>
<div id="ref-hex_stringr" class="csl-entry" role="listitem">
———. 2020b. <span>“<span class="nocase">stringr</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/stringr.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/stringr.png</a>.
</div>
<div id="ref-hex_tidyr" class="csl-entry" role="listitem">
———. 2020c. <span>“<span class="nocase">tidyr</span> Hex Sticker.”</span> <a href="https://github.com/rstudio/hex-stickers/blob/main/PNG/tidyr.png">https://github.com/rstudio/hex-stickers/blob/main/PNG/tidyr.png</a>.
</div>
<div id="ref-ggalt" class="csl-entry" role="listitem">
Rudis, Bob, Ben Bolker, and Jan Schulz. 2017. <em><span class="nocase">ggalt: Extra Coordinate Systems, ’Geoms’, Statistical Transformations, Scales and Fonts for ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggalt">https://CRAN.R-project.org/package=ggalt</a>.
</div>
<div id="ref-waffle" class="csl-entry" role="listitem">
Rudis, Bob, and Dave Gandy. 2023. <em><span class="nocase">waffle</span>: Create Waffle Chart Visualizations</em>. <a href="https://CRAN.R-project.org/package=waffle">https://CRAN.R-project.org/package=waffle</a>.
</div>
<div id="ref-lattice" class="csl-entry" role="listitem">
Sarkar, Deepayan. 2008. <em>Lattice: Multivariate Data Visualization with r</em>. New York: Springer. <a href="http://lmdvr.r-forge.r-project.org">http://lmdvr.r-forge.r-project.org</a>.
</div>
<div id="ref-openxlsx" class="csl-entry" role="listitem">
Schauberger, Philipp, and Alexander Walker. 2023. <em><span class="nocase">openxlsx: Read, Write and Edit xlsx Files</span></em>. <a href="https://CRAN.R-project.org/package=openxlsx">https://CRAN.R-project.org/package=openxlsx</a>.
</div>
<div id="ref-owidapi" class="csl-entry" role="listitem">
Scheuch, Christoph. 2025. <em><span class="nocase">owidapi</span>: Access the Our World in Data Chart API</em>. <a href="https://doi.org/10.32614/CRAN.package.owidapi">https://doi.org/10.32614/CRAN.package.owidapi</a>.
</div>
<div id="ref-GGally" class="csl-entry" role="listitem">
Schloerke, Barret, Di Cook, Joseph Larmarange, Francois Briatte, Moritz Marbach, Edwin Thoen, Amos Elberg, and Jason Crowley. 2024. <em><span class="nocase">GGally: Extension to ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=GGally">https://CRAN.R-project.org/package=GGally</a>.
</div>
<div id="ref-Schloss" class="csl-entry" role="listitem">
Schloss, Karen B., Connor C. Gramazio, Allison T. Silverman, Madeline L. Parker, and Audrey S. Wang. 2019. <span>“Mapping Color to Meaning in Colormap Data Visualizations.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 25 (1): 810–19. <a href="https://doi.org/10.1109/TVCG.2018.2865147">https://doi.org/10.1109/TVCG.2018.2865147</a>.
</div>
<div id="ref-funspotr" class="csl-entry" role="listitem">
Shalloway, Bryan. 2023. <em><span class="nocase">funspotr: Spot R Functions &amp; Packages</span></em>. <a href="https://CRAN.R-project.org/package=funspotr">https://CRAN.R-project.org/package=funspotr</a>.
</div>
<div id="ref-plotly" class="csl-entry" role="listitem">
Sievert, Carson. 2020. <em>Interactive Web-Based Data Visualization with r, Plotly, and Shiny</em>. Chapman; Hall/CRC. <a href="https://plotly-r.com">https://plotly-r.com</a>.
</div>
<div id="ref-ggrepel" class="csl-entry" role="listitem">
Slowikowski, Kamil. 2024. <em><span class="nocase">ggrepel: Automatically Position Non-Overlapping Text Labels with ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggrepel">https://CRAN.R-project.org/package=ggrepel</a>.
</div>
<div id="ref-visdat" class="csl-entry" role="listitem">
Tierney, Nicholas. 2017. <span>“<span class="nocase">visdat: Visualising Whole Data Frames</span>.”</span> <em>JOSS</em> 2 (16): 355. <a href="https://doi.org/10.21105/joss.00355">https://doi.org/10.21105/joss.00355</a>.
</div>
<div id="ref-naniar" class="csl-entry" role="listitem">
Tierney, Nicholas, and Dianne Cook. 2023. <span>“Expanding Tidy Data Principles to Facilitate Missing Data Exploration, Visualization and Assessment of Imputations.”</span> <em>Journal of Statistical Software</em> 105 (7): 1–31. <a href="https://doi.org/10.18637/jss.v105.i07">https://doi.org/10.18637/jss.v105.i07</a>.
</div>
<div id="ref-Tol2021" class="csl-entry" role="listitem">
Tol, Paul. 2021. <span>“<span class="nocase">Paul Tol’s Notes: Colour schemes and templates</span>.”</span> <a href="https://sronpersonalpages.nl/~pault/" class="uri">https://sronpersonalpages.nl/~pault/</a>.
</div>
<div id="ref-UScensuspop" class="csl-entry" role="listitem">
United States Census Bureau. 2021a. <span>“Historical Population Change Data (1910-2020).”</span> <a href="https://www.census.gov/data/tables/time-series/dec/popchange-data-text.html" class="uri">https://www.census.gov/data/tables/time-series/dec/popchange-data-text.html</a>.
</div>
<div id="ref-UScensus" class="csl-entry" role="listitem">
———. 2021b. <span>“State Area Measurements and Internal Point Coordinates.”</span> <a href="https://www.census.gov/geographies/reference-files/2010/geo/state-area.html" class="uri">https://www.census.gov/geographies/reference-files/2010/geo/state-area.html</a>.
</div>
<div id="ref-bees_data" class="csl-entry" role="listitem">
United States Department of Agriculture: Economics, Statistics and Market Information System. 2022. <span>“Honey Bee Colonies.”</span> <span>USDA Economics, Statistics and Market Information System</span>. <a href="https://usda.library.cornell.edu/concern/publications/rn301137d">https://usda.library.cornell.edu/concern/publications/rn301137d</a>.
</div>
<div id="ref-crsuggest" class="csl-entry" role="listitem">
Walker, Kyle. 2022. <em><span class="nocase">crsuggest: Obtain Suggested Coordinate Reference System Information for Spatial Data</span></em>. <a href="https://CRAN.R-project.org/package=crsuggest">https://CRAN.R-project.org/package=crsuggest</a>.
</div>
<div id="ref-Wanzer2021" class="csl-entry" role="listitem">
Wanzer, Dana Linnell, Tarek Azzam, Natalie D. Jones, and Darrel Skousen. 2021. <span>“The Role of Titles in Enhancing Data Visualization.”</span> <em>Evaluation and Program Planning</em> 84: 101896. <a href="https://doi.org/10.1016/j.evalprogplan.2020.101896">https://doi.org/10.1016/j.evalprogplan.2020.101896</a>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <em><span class="nocase">ggplot2</span>: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-forcats" class="csl-entry" role="listitem">
———. 2023a. <em><span class="nocase">forcats</span>: Tools for Working with Categorical Variables (Factors)</em>. <a href="https://doi.org/10.32614/CRAN.package.forcats">https://doi.org/10.32614/CRAN.package.forcats</a>.
</div>
<div id="ref-stringr" class="csl-entry" role="listitem">
———. 2023b. <em><span class="nocase">stringr: Simple, Consistent Wrappers for Common String Operations</span></em>. <a href="https://CRAN.R-project.org/package=stringr">https://CRAN.R-project.org/package=stringr</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-readxl" class="csl-entry" role="listitem">
Wickham, Hadley, and Jennifer Bryan. 2023. <em><span class="nocase">readxl: Read Excel Files</span></em>. <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a>.
</div>
<div id="ref-r4ds" class="csl-entry" role="listitem">
Wickham, Hadley, Mine Çetinkaya-Rundel, and Garrett Grolemund. 2023. <em><span>R</span> for Data Science</em>. Second Edition. O-Reilly. <a href="https://r4ds.hadley.nz">https://r4ds.hadley.nz</a>.
</div>
<div id="ref-dplyr" class="csl-entry" role="listitem">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis Vaughan. 2023. <em><span class="nocase">dplyr</span>: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-purrr" class="csl-entry" role="listitem">
Wickham, Hadley, and Lionel Henry. 2023. <em><span class="nocase">purrr</span>: Functional Programming Tools</em>. <a href="https://CRAN.R-project.org/package=purrr">https://CRAN.R-project.org/package=purrr</a>.
</div>
<div id="ref-readr" class="csl-entry" role="listitem">
Wickham, Hadley, Jim Hester, and Jennifer Bryan. 2024. <em><span class="nocase">readr</span>: Read Rectangular Text Data</em>. <a href="https://CRAN.R-project.org/package=readr">https://CRAN.R-project.org/package=readr</a>.
</div>
<div id="ref-scales" class="csl-entry" role="listitem">
Wickham, Hadley, Thomas Lin Pedersen, and Dana Seidel. 2023. <em><span class="nocase">scales</span>: Scale Functions for Visualization</em>. <a href="https://CRAN.R-project.org/package=scales">https://CRAN.R-project.org/package=scales</a>.
</div>
<div id="ref-tidyr" class="csl-entry" role="listitem">
Wickham, Hadley, Davis Vaughan, and Maximilian Girlich. 2024. <em><span class="nocase">tidyr</span>: Tidy Messy Data</em>. <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
<div id="ref-ggtextures" class="csl-entry" role="listitem">
Wilke, Claus. 2022. <em><span class="nocase">ggtextures: Drawing Textured Rectangles and Bars with grid and ggplot2</span></em>. <a href="https://github.com/clauswilke/ggtextures">https://github.com/clauswilke/ggtextures</a>.
</div>
<div id="ref-cowplot" class="csl-entry" role="listitem">
Wilke, Claus O. 2024. <em><span class="nocase">cowplot</span>: Streamlined Plot Theme and Plot Annotations for <span class="nocase">’ggplot2’</span></em>. <a href="https://wilkelab.org/cowplot/">https://wilkelab.org/cowplot/</a>.
</div>
<div id="ref-ggtext" class="csl-entry" role="listitem">
Wilke, Claus O., and Brenton M. Wiernik. 2022. <em><span class="nocase">ggtext</span>: Improved Text Rendering Support for <span class="nocase">’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggtext">https://CRAN.R-project.org/package=ggtext</a>.
</div>
<div id="ref-nobel_data" class="csl-entry" role="listitem">
www.nobelprize.org. 2024. <span>“<span>Nobel Prize API Version 2.1</span>.”</span> <a href="https://api.nobelprize.org/2.1/laureates">https://api.nobelprize.org/2.1/laureates</a>.
</div>
<div id="ref-owidR" class="csl-entry" role="listitem">
York, Piers. 2023. <em><span class="nocase">owidR</span>: Import Data from Our World in Data</em>. <a href="https://github.com/piersyork/owidR">https://github.com/piersyork/owidR</a>.
</div>
<div id="ref-ggimage" class="csl-entry" role="listitem">
Yu, Guangchuang. 2023. <em><span class="nocase">ggimage: Use Image in ’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=ggimage">https://CRAN.R-project.org/package=ggimage</a>.
</div>
<div id="ref-gghighlight" class="csl-entry" role="listitem">
Yutani, Hiroaki. 2023. <em><span class="nocase">gghighlight</span>: Highlight Lines and Points in <span class="nocase">’ggplot2’</span></em>. <a href="https://CRAN.R-project.org/package=gghighlight">https://CRAN.R-project.org/package=gghighlight</a>.
</div>
<div id="ref-lemurs_data" class="csl-entry" role="listitem">
Zehr, Sarah M., Richard G. Roach, David Haring, Julie Taylor, Freda H. Cameron, and Anne D. Yoder. 2014. <span>“<span class="nocase">Life history profiles for 27 strepsirrhine primate taxa generated using captive data from the Duke Lemur Center</span>.”</span> <em>Scientific Data</em> 1 (1). <a href="https://doi.org/10.1038/sdata.2014.19">https://doi.org/10.1038/sdata.2014.19</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/nrennie\.rbind\.io\/art-of-viz\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./time-zones.html" class="pagination-link" aria-label="시간대: **`sf`**를 사용한 공간 데이터 및 매핑">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">시간대: <strong><code>sf</code></strong>를 사용한 공간 데이터 및 매핑</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./other-tricks.html" class="pagination-link" aria-label="기타 팁과 요령">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">기타 팁과 요령</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>